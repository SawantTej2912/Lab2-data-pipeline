[0m13:50:10.084108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036f3e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e37c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e37ed0>]}


============================== 13:50:10.086575 | 5fdd395e-fbb5-4eca-abc6-0fc3df609bac ==============================
[0m13:50:10.086575 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:50:10.086808 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/spartan/.dbt', 'cache_selected_only': 'False', 'empty': 'None', 'version_check': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'quiet': 'False', 'target_path': 'None', 'log_format': 'default', 'warn_error': 'None', 'no_print': 'None', 'introspect': 'True', 'debug': 'False', 'invocation_command': 'dbt debug', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': '/Users/spartan/lab2_project/crypto_analytics_dbt/logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'fail_fast': 'False'}
[0m13:50:10.094856 [info ] [MainThread]: dbt version: 1.11.0-b3
[0m13:50:10.095055 [info ] [MainThread]: python version: 3.13.5
[0m13:50:10.095164 [info ] [MainThread]: python path: /Users/spartan/Desktop/Tej_files/anaconda3/bin/python3.13
[0m13:50:10.095256 [info ] [MainThread]: os info: macOS-15.7.1-arm64-arm-64bit-Mach-O
[0m13:50:10.960802 [info ] [MainThread]: Using profiles dir at /Users/spartan/.dbt
[0m13:50:10.961016 [info ] [MainThread]: Using profiles.yml file at /Users/spartan/.dbt/profiles.yml
[0m13:50:10.961124 [info ] [MainThread]: Using dbt_project.yml file at /Users/spartan/lab2_project/crypto_analytics_dbt/dbt_project.yml
[0m13:50:10.961377 [info ] [MainThread]: adapter type: snowflake
[0m13:50:10.961472 [info ] [MainThread]: adapter version: 1.10.2
[0m13:50:10.995279 [info ] [MainThread]: Configuration:
[0m13:50:10.995505 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:50:10.995621 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:50:10.995710 [info ] [MainThread]: Required dependencies:
[0m13:50:10.995855 [debug] [MainThread]: Executing "git --help"
[0m13:50:11.018959 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:50:11.019471 [debug] [MainThread]: STDERR: "b''"
[0m13:50:11.019596 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:50:11.019716 [info ] [MainThread]: Connection:
[0m13:50:11.019831 [info ] [MainThread]:   account: LVB17920
[0m13:50:11.019922 [info ] [MainThread]:   user: PARROT
[0m13:50:11.020000 [info ] [MainThread]:   database: USER_DB_PARROT
[0m13:50:11.020079 [info ] [MainThread]:   warehouse: PARROT_QUERY_WH
[0m13:50:11.020154 [info ] [MainThread]:   role: TRAINING_ROLE
[0m13:50:11.020235 [info ] [MainThread]:   schema: PARROT_FEAT
[0m13:50:11.020318 [info ] [MainThread]:   authenticator: None
[0m13:50:11.020393 [info ] [MainThread]:   oauth_client_id: None
[0m13:50:11.020473 [info ] [MainThread]:   query_tag: None
[0m13:50:11.020552 [info ] [MainThread]:   client_session_keep_alive: False
[0m13:50:11.020626 [info ] [MainThread]:   host: None
[0m13:50:11.020702 [info ] [MainThread]:   port: None
[0m13:50:11.020774 [info ] [MainThread]:   proxy_host: None
[0m13:50:11.020850 [info ] [MainThread]:   proxy_port: None
[0m13:50:11.020922 [info ] [MainThread]:   protocol: None
[0m13:50:11.020996 [info ] [MainThread]:   connect_retries: 1
[0m13:50:11.021067 [info ] [MainThread]:   connect_timeout: None
[0m13:50:11.021138 [info ] [MainThread]:   retry_on_database_errors: False
[0m13:50:11.021213 [info ] [MainThread]:   retry_all: False
[0m13:50:11.021283 [info ] [MainThread]:   insecure_mode: False
[0m13:50:11.021357 [info ] [MainThread]:   reuse_connections: True
[0m13:50:11.021428 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m13:50:11.021693 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:50:11.077264 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m13:50:11.137140 [debug] [MainThread]: Using snowflake connection "debug"
[0m13:50:11.137290 [debug] [MainThread]: On debug: select 1 as id
[0m13:50:11.137376 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:11.854664 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.717 seconds
[0m13:50:11.855992 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:50:11.856381 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:50:11.865861 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.8129877, "process_in_blocks": "0", "process_kernel_time": 1.488037, "process_mem_max_rss": "219824128", "process_out_blocks": "0", "process_user_time": 2.048874}
[0m13:50:11.866514 [debug] [MainThread]: Command `dbt debug` succeeded at 13:50:11.866392 after 1.81 seconds
[0m13:50:11.867048 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:50:11.867383 [debug] [MainThread]: On debug: Close
[0m13:50:11.969750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153bfe3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153dbe330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150e93460>]}
[0m13:50:11.970760 [debug] [MainThread]: Flushing usage events
[0m13:50:12.326568 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:53:46.820747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059dfe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107133c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107133ed0>]}


============================== 13:53:46.823487 | 63c8b1ea-2f1e-4d29-8b76-25d0d34d2f13 ==============================
[0m13:53:46.823487 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:53:46.823733 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'fail_fast': 'False', 'use_colors': 'True', 'debug': 'False', 'warn_error': 'None', 'quiet': 'False', 'target_path': 'None', 'partial_parse': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'log_path': '/Users/spartan/lab2_project/crypto_analytics_dbt/logs', 'cache_selected_only': 'False', 'profiles_dir': '/Users/spartan/.dbt', 'invocation_command': 'dbt run --select stg_crypto_prices'}
[0m13:53:47.637889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63c8b1ea-2f1e-4d29-8b76-25d0d34d2f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f448a0>]}
[0m13:53:47.657403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63c8b1ea-2f1e-4d29-8b76-25d0d34d2f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143da05a0>]}
[0m13:53:47.657859 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:53:47.712876 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m13:53:47.713207 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:53:47.713343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '63c8b1ea-2f1e-4d29-8b76-25d0d34d2f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143d80b50>]}
[0m13:53:48.181508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63c8b1ea-2f1e-4d29-8b76-25d0d34d2f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1443619a0>]}
[0m13:53:48.211083 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/manifest.json
[0m13:53:48.212071 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/semantic_manifest.json
[0m13:53:48.222190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63c8b1ea-2f1e-4d29-8b76-25d0d34d2f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1445a98d0>]}
[0m13:53:48.222378 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 492 macros
[0m13:53:48.222504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63c8b1ea-2f1e-4d29-8b76-25d0d34d2f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1443af6c0>]}
[0m13:53:48.223043 [info ] [MainThread]: 
[0m13:53:48.223167 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:53:48.223259 [info ] [MainThread]: 
[0m13:53:48.223431 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:53:48.223747 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m13:53:48.288380 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m13:53:48.288557 [debug] [ThreadPool]: On list_USER_DB_PARROT: show terse schemas in database USER_DB_PARROT
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
[0m13:53:48.288660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:50.881455 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 2.593 seconds
[0m13:53:50.889042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now list_USER_DB_PARROT_PARROT_FEAT)
[0m13:53:50.901827 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT"
[0m13:53:50.902228 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT: show objects in USER_DB_PARROT.PARROT_FEAT
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT"} */;
[0m13:53:50.993386 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.091 seconds
[0m13:53:50.996729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63c8b1ea-2f1e-4d29-8b76-25d0d34d2f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144463f50>]}
[0m13:53:51.001055 [debug] [Thread-1 (]: Began running node model.crypto_analytics_dbt.stg_crypto_prices
[0m13:53:51.001687 [info ] [Thread-1 (]: 1 of 1 START sql view model PARROT_FEAT.stg_crypto_prices ...................... [RUN]
[0m13:53:51.002120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT, now model.crypto_analytics_dbt.stg_crypto_prices)
[0m13:53:51.002440 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics_dbt.stg_crypto_prices
[0m13:53:51.009948 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics_dbt.stg_crypto_prices"
[0m13:53:51.011101 [debug] [Thread-1 (]: Began executing node model.crypto_analytics_dbt.stg_crypto_prices
[0m13:53:51.046101 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics_dbt.stg_crypto_prices"
[0m13:53:51.047001 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_analytics_dbt.stg_crypto_prices"
[0m13:53:51.047187 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.stg_crypto_prices: create or replace   view USER_DB_PARROT.PARROT_FEAT.stg_crypto_prices
  
  
  
  
  as (
    

select
  upper(symbol)                                      as symbol,
  cast(price_date as date)                           as price_date,
  cast(open as number(38,8))                         as open,
  cast(high as number(38,8))                         as high,
  cast(low as number(38,8))                          as low,
  cast(close as number(38,8))                        as close,
  cast(adj_close as number(38,8))                    as adj_close,
  cast(volume as number(38,8))                       as volume
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.stg_crypto_prices"} */;
[0m13:53:51.390232 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.343 seconds
[0m13:53:51.401301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c8b1ea-2f1e-4d29-8b76-25d0d34d2f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d34b750>]}
[0m13:53:51.401623 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PARROT_FEAT.stg_crypto_prices ................. [[32mSUCCESS 1[0m in 0.40s]
[0m13:53:51.401861 [debug] [Thread-1 (]: Finished running node model.crypto_analytics_dbt.stg_crypto_prices
[0m13:53:51.402478 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:53:51.402651 [debug] [MainThread]: Connection 'model.crypto_analytics_dbt.stg_crypto_prices' was left open.
[0m13:53:51.402784 [debug] [MainThread]: On model.crypto_analytics_dbt.stg_crypto_prices: Close
[0m13:53:51.534913 [info ] [MainThread]: 
[0m13:53:51.535650 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.31 seconds (3.31s).
[0m13:53:51.536464 [debug] [MainThread]: Command end result
[0m13:53:51.554844 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/manifest.json
[0m13:53:51.556455 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/semantic_manifest.json
[0m13:53:51.560201 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/spartan/lab2_project/crypto_analytics_dbt/target/run_results.json
[0m13:53:51.560385 [info ] [MainThread]: 
[0m13:53:51.560583 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:53:51.560721 [info ] [MainThread]: 
[0m13:53:51.560894 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:53:51.565518 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.775009, "process_in_blocks": "0", "process_kernel_time": 1.143917, "process_mem_max_rss": "243892224", "process_out_blocks": "0", "process_user_time": 2.967803}
[0m13:53:51.565780 [debug] [MainThread]: Command `dbt run` succeeded at 13:53:51.565724 after 4.78 seconds
[0m13:53:51.566000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d3f8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d4a3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1450cc750>]}
[0m13:53:51.566189 [debug] [MainThread]: Flushing usage events
[0m13:53:51.975040 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:58:53.694161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045afe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106137c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106137ed0>]}


============================== 13:58:53.696709 | bae17454-14f6-4ede-ad79-12bc68f4a1a6 ==============================
[0m13:58:53.696709 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:58:53.696945 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'partial_parse': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'debug': 'False', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'profiles_dir': '/Users/spartan/.dbt', 'static_parser': 'True', 'invocation_command': 'dbt run --select int_crypto_features', 'printer_width': '80', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_path': '/Users/spartan/lab2_project/crypto_analytics_dbt/logs', 'fail_fast': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'empty': 'False', 'write_json': 'True', 'target_path': 'None'}
[0m13:58:54.494436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bae17454-14f6-4ede-ad79-12bc68f4a1a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c488a0>]}
[0m13:58:54.513882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bae17454-14f6-4ede-ad79-12bc68f4a1a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c4a05a0>]}
[0m13:58:54.514359 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:58:54.569599 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m13:58:54.634166 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 3 files added, 0 files changed.
[0m13:58:54.634395 [debug] [MainThread]: Partial parsing: added file: crypto_analytics_dbt://models/int_crypto_features.sql
[0m13:58:54.634499 [debug] [MainThread]: Partial parsing: added file: crypto_analytics_dbt://models/stg_crypto_prices.sql
[0m13:58:54.634604 [debug] [MainThread]: Partial parsing: added file: crypto_analytics_dbt://models/sources.yml
[0m13:58:54.634709 [debug] [MainThread]: Partial parsing: deleted file: crypto_analytics_dbt://models/example/stg_crypto_prices.sql
[0m13:58:54.764107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bae17454-14f6-4ede-ad79-12bc68f4a1a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cd74e50>]}
[0m13:58:54.790869 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/manifest.json
[0m13:58:54.792183 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/semantic_manifest.json
[0m13:58:54.801771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bae17454-14f6-4ede-ad79-12bc68f4a1a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ca43b60>]}
[0m13:58:54.801948 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 492 macros
[0m13:58:54.802068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bae17454-14f6-4ede-ad79-12bc68f4a1a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cefdc50>]}
[0m13:58:54.802634 [info ] [MainThread]: 
[0m13:58:54.802758 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:58:54.802849 [info ] [MainThread]: 
[0m13:58:54.803024 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:58:54.803332 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m13:58:54.870891 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m13:58:54.871047 [debug] [ThreadPool]: On list_USER_DB_PARROT: show terse schemas in database USER_DB_PARROT
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
[0m13:58:54.871139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:57.447160 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 2.576 seconds
[0m13:58:57.450346 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now create_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT)
[0m13:58:57.451124 [debug] [ThreadPool]: Creating schema "database: "USER_DB_PARROT"
schema: "PARROT_FEAT_PARROT_FEAT"
"
[0m13:58:57.456268 [debug] [ThreadPool]: Using snowflake connection "create_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m13:58:57.456663 [debug] [ThreadPool]: On create_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: create schema if not exists USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "create_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
[0m13:58:57.584462 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.127 seconds
[0m13:58:57.590339 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now list_USER_DB_PARROT_PARROT_FEAT)
[0m13:58:57.591091 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT'
[0m13:58:57.602488 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT"
[0m13:58:57.603319 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m13:58:57.603464 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT: show objects in USER_DB_PARROT.PARROT_FEAT
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT"} */;
[0m13:58:57.603566 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */;
[0m13:58:57.603845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:57.732856 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.129 seconds
[0m13:58:58.061154 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.457 seconds
[0m13:58:58.063146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bae17454-14f6-4ede-ad79-12bc68f4a1a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14de36dd0>]}
[0m13:58:58.066917 [debug] [Thread-1 (]: Began running node model.crypto_analytics_dbt.int_crypto_features
[0m13:58:58.067443 [info ] [Thread-1 (]: 1 of 1 START sql table model PARROT_FEAT_PARROT_FEAT.int_crypto_features ....... [RUN]
[0m13:58:58.067961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT, now model.crypto_analytics_dbt.int_crypto_features)
[0m13:58:58.068274 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics_dbt.int_crypto_features
[0m13:58:58.074636 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics_dbt.int_crypto_features"
[0m13:58:58.075437 [debug] [Thread-1 (]: Began executing node model.crypto_analytics_dbt.int_crypto_features
[0m13:58:58.127941 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics_dbt.int_crypto_features"
[0m13:58:58.128765 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_analytics_dbt.int_crypto_features"
[0m13:58:58.129040 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.int_crypto_features: create or replace transient table USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
    
    
    
    as (

with base as (
  select *
  from USER_DB_PARROT.PARROT_FEAT.stg_crypto_prices
)
select
  symbol,
  price_date,
  close,
  avg(close) over (partition by symbol order by price_date rows between 4 preceding and current row)  as sma_5,
  avg(close) over (partition by symbol order by price_date rows between 19 preceding and current row) as sma_20,
  avg(close) over (partition by symbol order by price_date rows between 49 preceding and current row) as sma_50,
  (close / nullif(lag(close,5) over (partition by symbol order by price_date),0) - 1) * 100 as momentum_5d_pct
from base
    )

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.int_crypto_features"} */;
[0m13:58:58.903825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.774 seconds
[0m13:58:58.929449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bae17454-14f6-4ede-ad79-12bc68f4a1a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dbfe750>]}
[0m13:58:58.930038 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PARROT_FEAT_PARROT_FEAT.int_crypto_features .. [[32mSUCCESS 1[0m in 0.86s]
[0m13:58:58.930493 [debug] [Thread-1 (]: Finished running node model.crypto_analytics_dbt.int_crypto_features
[0m13:58:58.931486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:58.931749 [debug] [MainThread]: Connection 'model.crypto_analytics_dbt.int_crypto_features' was left open.
[0m13:58:58.931954 [debug] [MainThread]: On model.crypto_analytics_dbt.int_crypto_features: Close
[0m13:58:59.023492 [debug] [MainThread]: Connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT' was left open.
[0m13:58:59.024151 [debug] [MainThread]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m13:58:59.133522 [info ] [MainThread]: 
[0m13:58:59.134436 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.33 seconds (4.33s).
[0m13:58:59.135342 [debug] [MainThread]: Command end result
[0m13:58:59.167541 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/manifest.json
[0m13:58:59.168748 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/semantic_manifest.json
[0m13:58:59.171951 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/spartan/lab2_project/crypto_analytics_dbt/target/run_results.json
[0m13:58:59.172126 [info ] [MainThread]: 
[0m13:58:59.172333 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:58:59.172475 [info ] [MainThread]: 
[0m13:58:59.172639 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:58:59.177002 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.5117755, "process_in_blocks": "0", "process_kernel_time": 1.283502, "process_mem_max_rss": "229752832", "process_out_blocks": "0", "process_user_time": 2.688336}
[0m13:58:59.177228 [debug] [MainThread]: Command `dbt run` succeeded at 13:58:59.177181 after 5.51 seconds
[0m13:58:59.177412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14db32a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14def0230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14def02d0>]}
[0m13:58:59.177580 [debug] [MainThread]: Flushing usage events
[0m13:58:59.503192 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:04:44.076247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eafe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c5bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c5bed0>]}


============================== 14:04:44.078781 | e277f7ed-f18d-4b31-b26e-03b3f7559ac7 ==============================
[0m14:04:44.078781 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m14:04:44.079037 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_format': 'default', 'warn_error': 'None', 'write_json': 'True', 'printer_width': '80', 'profiles_dir': '/Users/spartan/.dbt', 'use_experimental_parser': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'debug': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'partial_parse': 'True', 'no_print': 'None', 'static_parser': 'True', 'invocation_command': 'dbt run --select int_crypto_features --full-refresh', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_path': '/Users/spartan/lab2_project/crypto_analytics_dbt/logs'}
[0m14:04:44.893007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e277f7ed-f18d-4b31-b26e-03b3f7559ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066488a0>]}
[0m14:04:44.912559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e277f7ed-f18d-4b31-b26e-03b3f7559ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d4a05a0>]}
[0m14:04:44.913033 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m14:04:44.970850 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m14:04:45.036213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:04:45.036465 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics_dbt://models/int_crypto_features.sql
[0m14:04:45.132958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e277f7ed-f18d-4b31-b26e-03b3f7559ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d483950>]}
[0m14:04:45.160947 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/manifest.json
[0m14:04:45.161930 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/semantic_manifest.json
[0m14:04:45.173106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e277f7ed-f18d-4b31-b26e-03b3f7559ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d3fbd40>]}
[0m14:04:45.173295 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 492 macros
[0m14:04:45.173418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e277f7ed-f18d-4b31-b26e-03b3f7559ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dcc1c50>]}
[0m14:04:45.173969 [info ] [MainThread]: 
[0m14:04:45.174095 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:04:45.174188 [info ] [MainThread]: 
[0m14:04:45.174360 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:04:45.174685 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m14:04:45.239330 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m14:04:45.239504 [debug] [ThreadPool]: On list_USER_DB_PARROT: show terse schemas in database USER_DB_PARROT
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
[0m14:04:45.239597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:47.983317 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 2.744 seconds
[0m14:04:47.991514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now list_USER_DB_PARROT_PARROT_FEAT)
[0m14:04:48.005516 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT"
[0m14:04:48.006000 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT: show objects in USER_DB_PARROT.PARROT_FEAT
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT"} */;
[0m14:04:48.251394 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.245 seconds
[0m14:04:48.254548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e277f7ed-f18d-4b31-b26e-03b3f7559ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e6f1e60>]}
[0m14:04:48.257974 [debug] [Thread-1 (]: Began running node model.crypto_analytics_dbt.int_crypto_features
[0m14:04:48.258749 [info ] [Thread-1 (]: 1 of 1 START sql table model PARROT_FEAT.int_crypto_features ................... [RUN]
[0m14:04:48.259252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT, now model.crypto_analytics_dbt.int_crypto_features)
[0m14:04:48.259655 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics_dbt.int_crypto_features
[0m14:04:48.266860 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics_dbt.int_crypto_features"
[0m14:04:48.267748 [debug] [Thread-1 (]: Began executing node model.crypto_analytics_dbt.int_crypto_features
[0m14:04:48.286718 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics_dbt.int_crypto_features"
[0m14:04:48.287731 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_analytics_dbt.int_crypto_features"
[0m14:04:48.287998 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.int_crypto_features: create or replace transient table USER_DB_PARROT.PARROT_FEAT.int_crypto_features
    
    
    
    as (

with base as (
  select *
  from USER_DB_PARROT.PARROT_FEAT.stg_crypto_prices
)
select
  symbol,
  price_date,
  close,
  avg(close) over (partition by symbol order by price_date rows between 4 preceding and current row)  as sma_5,
  avg(close) over (partition by symbol order by price_date rows between 19 preceding and current row) as sma_20,
  avg(close) over (partition by symbol order by price_date rows between 49 preceding and current row) as sma_50,
  (close / nullif(lag(close,5) over (partition by symbol order by price_date),0) - 1) * 100 as momentum_5d_pct
from base
    )

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.int_crypto_features"} */;
[0m14:04:49.341024 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.052 seconds
[0m14:04:49.364273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e277f7ed-f18d-4b31-b26e-03b3f7559ac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153b80290>]}
[0m14:04:49.364898 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PARROT_FEAT.int_crypto_features .............. [[32mSUCCESS 1[0m in 1.10s]
[0m14:04:49.365315 [debug] [Thread-1 (]: Finished running node model.crypto_analytics_dbt.int_crypto_features
[0m14:04:49.366473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:49.366760 [debug] [MainThread]: Connection 'model.crypto_analytics_dbt.int_crypto_features' was left open.
[0m14:04:49.366975 [debug] [MainThread]: On model.crypto_analytics_dbt.int_crypto_features: Close
[0m14:04:49.509830 [info ] [MainThread]: 
[0m14:04:49.510532 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.34 seconds (4.34s).
[0m14:04:49.511456 [debug] [MainThread]: Command end result
[0m14:04:49.533752 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/manifest.json
[0m14:04:49.535520 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/semantic_manifest.json
[0m14:04:49.539856 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/spartan/lab2_project/crypto_analytics_dbt/target/run_results.json
[0m14:04:49.540070 [info ] [MainThread]: 
[0m14:04:49.540335 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:49.540499 [info ] [MainThread]: 
[0m14:04:49.540692 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:04:49.546420 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.499229, "process_in_blocks": "0", "process_kernel_time": 1.377024, "process_mem_max_rss": "237142016", "process_out_blocks": "0", "process_user_time": 2.491666}
[0m14:04:49.546762 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:49.546696 after 5.50 seconds
[0m14:04:49.546997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153bf50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153c29a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153c2b390>]}
[0m14:04:49.547291 [debug] [MainThread]: Flushing usage events
[0m14:04:49.888366 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:12:39.201794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c33e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10938bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10938bed0>]}


============================== 14:12:39.204432 | 4639b273-4b90-468b-86a2-280c8f1a3d1e ==============================
[0m14:12:39.204432 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m14:12:39.204704 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'invocation_command': 'dbt run --select mart_crypto_summary', 'static_parser': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'debug': 'False', 'partial_parse': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'quiet': 'False', 'printer_width': '80', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'use_experimental_parser': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/spartan/lab2_project/crypto_analytics_dbt/logs', 'empty': 'False', 'profiles_dir': '/Users/spartan/.dbt'}
[0m14:12:39.964744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4639b273-4b90-468b-86a2-280c8f1a3d1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081a08a0>]}
[0m14:12:39.984378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4639b273-4b90-468b-86a2-280c8f1a3d1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1343a05a0>]}
[0m14:12:39.984900 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m14:12:40.040967 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m14:12:40.104837 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:12:40.105058 [debug] [MainThread]: Partial parsing: added file: crypto_analytics_dbt://models/mart_crypto_summary.sql
[0m14:12:40.199395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4639b273-4b90-468b-86a2-280c8f1a3d1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134383c50>]}
[0m14:12:40.227133 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/manifest.json
[0m14:12:40.228004 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/semantic_manifest.json
[0m14:12:40.237516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4639b273-4b90-468b-86a2-280c8f1a3d1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1342f7d40>]}
[0m14:12:40.237701 [info ] [MainThread]: Found 5 models, 4 data tests, 1 source, 492 macros
[0m14:12:40.237829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4639b273-4b90-468b-86a2-280c8f1a3d1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134cc5c50>]}
[0m14:12:40.238386 [info ] [MainThread]: 
[0m14:12:40.238510 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:12:40.238604 [info ] [MainThread]: 
[0m14:12:40.238772 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:12:40.239091 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m14:12:40.304201 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m14:12:40.304366 [debug] [ThreadPool]: On list_USER_DB_PARROT: show terse schemas in database USER_DB_PARROT
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
[0m14:12:40.304462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:42.923676 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 2.619 seconds
[0m14:12:42.926410 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now create_USER_DB_PARROT_PARROT_FEAT_PARROT_MART)
[0m14:12:42.926936 [debug] [ThreadPool]: Creating schema "database: "USER_DB_PARROT"
schema: "PARROT_FEAT_PARROT_MART"
"
[0m14:12:42.931291 [debug] [ThreadPool]: Using snowflake connection "create_USER_DB_PARROT_PARROT_FEAT_PARROT_MART"
[0m14:12:42.931587 [debug] [ThreadPool]: On create_USER_DB_PARROT_PARROT_FEAT_PARROT_MART: create schema if not exists USER_DB_PARROT.PARROT_FEAT_PARROT_MART
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "create_USER_DB_PARROT_PARROT_FEAT_PARROT_MART"} */
[0m14:12:43.097184 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.165 seconds
[0m14:12:43.105524 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_USER_DB_PARROT_PARROT_FEAT_PARROT_MART, now list_USER_DB_PARROT_PARROT_FEAT)
[0m14:12:43.112748 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_MART'
[0m14:12:43.122294 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_MART"
[0m14:12:43.122881 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT"
[0m14:12:43.123180 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_MART: show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_MART
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_MART"} */;
[0m14:12:43.123436 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT: show objects in USER_DB_PARROT.PARROT_FEAT
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT"} */;
[0m14:12:43.123634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:43.266140 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.142 seconds
[0m14:12:43.510414 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.387 seconds
[0m14:12:43.513677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4639b273-4b90-468b-86a2-280c8f1a3d1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137eb3d40>]}
[0m14:12:43.517994 [debug] [Thread-1 (]: Began running node model.crypto_analytics_dbt.mart_crypto_summary
[0m14:12:43.518602 [info ] [Thread-1 (]: 1 of 1 START sql table model PARROT_FEAT_PARROT_MART.mart_crypto_summary ....... [RUN]
[0m14:12:43.519050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT, now model.crypto_analytics_dbt.mart_crypto_summary)
[0m14:12:43.519417 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics_dbt.mart_crypto_summary
[0m14:12:43.526805 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics_dbt.mart_crypto_summary"
[0m14:12:43.527728 [debug] [Thread-1 (]: Began executing node model.crypto_analytics_dbt.mart_crypto_summary
[0m14:12:43.550218 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics_dbt.mart_crypto_summary"
[0m14:12:43.551145 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_analytics_dbt.mart_crypto_summary"
[0m14:12:43.551400 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.mart_crypto_summary: create or replace transient table USER_DB_PARROT.PARROT_FEAT_PARROT_MART.mart_crypto_summary
    
    
    
    as (

select
  symbol,
  price_date,
  close,
  sma_5,
  sma_20,
  sma_50,
  momentum_5d_pct,
  case when sma_5 > sma_20 then 1 else 0 end as bull_signal_cross
from USER_DB_PARROT.PARROT_FEAT.int_crypto_features
order by price_date, symbol
    )

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.mart_crypto_summary"} */;
[0m14:12:44.314062 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.762 seconds
[0m14:12:44.339113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4639b273-4b90-468b-86a2-280c8f1a3d1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137f85fd0>]}
[0m14:12:44.339830 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PARROT_FEAT_PARROT_MART.mart_crypto_summary .. [[32mSUCCESS 1[0m in 0.82s]
[0m14:12:44.340264 [debug] [Thread-1 (]: Finished running node model.crypto_analytics_dbt.mart_crypto_summary
[0m14:12:44.341394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:44.341641 [debug] [MainThread]: Connection 'model.crypto_analytics_dbt.mart_crypto_summary' was left open.
[0m14:12:44.341848 [debug] [MainThread]: On model.crypto_analytics_dbt.mart_crypto_summary: Close
[0m14:12:44.460089 [debug] [MainThread]: Connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_MART' was left open.
[0m14:12:44.460847 [debug] [MainThread]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_MART: Close
[0m14:12:44.572116 [info ] [MainThread]: 
[0m14:12:44.572752 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.33 seconds (4.33s).
[0m14:12:44.573529 [debug] [MainThread]: Command end result
[0m14:12:44.596198 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/manifest.json
[0m14:12:44.597988 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/semantic_manifest.json
[0m14:12:44.602485 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/spartan/lab2_project/crypto_analytics_dbt/target/run_results.json
[0m14:12:44.602723 [info ] [MainThread]: 
[0m14:12:44.602994 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:12:44.603172 [info ] [MainThread]: 
[0m14:12:44.603359 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:12:44.609110 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.4405937, "process_in_blocks": "0", "process_kernel_time": 1.241539, "process_mem_max_rss": "245415936", "process_out_blocks": "0", "process_user_time": 2.723591}
[0m14:12:44.609530 [debug] [MainThread]: Command `dbt run` succeeded at 14:12:44.609476 after 5.44 seconds
[0m14:12:44.609917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137ff8d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140025270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1400276b0>]}
[0m14:12:44.610200 [debug] [MainThread]: Flushing usage events
[0m14:12:44.935242 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:16:30.449962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107037e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e5bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e5bed0>]}


============================== 14:16:30.452507 | 9d259b85-1bd2-4965-a3aa-f371fe97aaa7 ==============================
[0m14:16:30.452507 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m14:16:30.452773 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'static_parser': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'printer_width': '80', 'log_path': '/Users/spartan/lab2_project/crypto_analytics_dbt/logs', 'log_format': 'default', 'write_json': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'no_print': 'None', 'target_path': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/spartan/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --select mart_crypto_summary --full-refresh', 'log_cache_events': 'False', 'use_colors': 'True', 'empty': 'False'}
[0m14:16:31.271622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d259b85-1bd2-4965-a3aa-f371fe97aaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078448a0>]}
[0m14:16:31.291157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d259b85-1bd2-4965-a3aa-f371fe97aaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f3a05a0>]}
[0m14:16:31.291706 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m14:16:31.347655 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m14:16:31.411912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:16:31.412165 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics_dbt://models/mart_crypto_summary.sql
[0m14:16:31.507610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d259b85-1bd2-4965-a3aa-f371fe97aaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f383350>]}
[0m14:16:31.536162 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/manifest.json
[0m14:16:31.537121 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/semantic_manifest.json
[0m14:16:31.547271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d259b85-1bd2-4965-a3aa-f371fe97aaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f2f7d40>]}
[0m14:16:31.547436 [info ] [MainThread]: Found 5 models, 4 data tests, 1 source, 492 macros
[0m14:16:31.547557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d259b85-1bd2-4965-a3aa-f371fe97aaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fa41a90>]}
[0m14:16:31.548132 [info ] [MainThread]: 
[0m14:16:31.548254 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:16:31.548342 [info ] [MainThread]: 
[0m14:16:31.548508 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:16:31.548817 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m14:16:31.612750 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m14:16:31.612925 [debug] [ThreadPool]: On list_USER_DB_PARROT: show terse schemas in database USER_DB_PARROT
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
[0m14:16:31.613019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:34.254932 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 2.642 seconds
[0m14:16:34.264885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now list_USER_DB_PARROT_PARROT_FEAT)
[0m14:16:34.278948 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT"
[0m14:16:34.279385 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT: show objects in USER_DB_PARROT.PARROT_FEAT
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT"} */;
[0m14:16:34.405200 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.125 seconds
[0m14:16:34.408866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d259b85-1bd2-4965-a3aa-f371fe97aaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d4f5e60>]}
[0m14:16:34.413316 [debug] [Thread-1 (]: Began running node model.crypto_analytics_dbt.mart_crypto_summary
[0m14:16:34.414125 [info ] [Thread-1 (]: 1 of 1 START sql table model PARROT_FEAT.mart_crypto_summary ................... [RUN]
[0m14:16:34.414661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT, now model.crypto_analytics_dbt.mart_crypto_summary)
[0m14:16:34.415019 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics_dbt.mart_crypto_summary
[0m14:16:34.422893 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics_dbt.mart_crypto_summary"
[0m14:16:34.423916 [debug] [Thread-1 (]: Began executing node model.crypto_analytics_dbt.mart_crypto_summary
[0m14:16:34.445231 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics_dbt.mart_crypto_summary"
[0m14:16:34.445869 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_analytics_dbt.mart_crypto_summary"
[0m14:16:34.446067 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.mart_crypto_summary: create or replace transient table USER_DB_PARROT.PARROT_FEAT.mart_crypto_summary
    
    
    
    as (

select
  symbol,
  price_date,
  close,
  sma_5,
  sma_20,
  sma_50,
  momentum_5d_pct,
  case when sma_5 > sma_20 then 1 else 0 end as bull_signal_cross
from USER_DB_PARROT.PARROT_FEAT.int_crypto_features
order by price_date, symbol
    )

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.mart_crypto_summary"} */;
[0m14:16:35.499964 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.053 seconds
[0m14:16:35.524161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d259b85-1bd2-4965-a3aa-f371fe97aaa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15da80050>]}
[0m14:16:35.524802 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PARROT_FEAT.mart_crypto_summary .............. [[32mSUCCESS 1[0m in 1.11s]
[0m14:16:35.525211 [debug] [Thread-1 (]: Finished running node model.crypto_analytics_dbt.mart_crypto_summary
[0m14:16:35.526351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:35.526644 [debug] [MainThread]: Connection 'model.crypto_analytics_dbt.mart_crypto_summary' was left open.
[0m14:16:35.526855 [debug] [MainThread]: On model.crypto_analytics_dbt.mart_crypto_summary: Close
[0m14:16:35.647283 [info ] [MainThread]: 
[0m14:16:35.647831 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.10 seconds (4.10s).
[0m14:16:35.648582 [debug] [MainThread]: Command end result
[0m14:16:35.671374 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/manifest.json
[0m14:16:35.673013 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/semantic_manifest.json
[0m14:16:35.677140 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/spartan/lab2_project/crypto_analytics_dbt/target/run_results.json
[0m14:16:35.677334 [info ] [MainThread]: 
[0m14:16:35.677577 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:16:35.677732 [info ] [MainThread]: 
[0m14:16:35.677931 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:16:35.683549 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.26018, "process_in_blocks": "0", "process_kernel_time": 1.239284, "process_mem_max_rss": "222347264", "process_out_blocks": "0", "process_user_time": 2.657821}
[0m14:16:35.683856 [debug] [MainThread]: Command `dbt run` succeeded at 14:16:35.683794 after 5.26 seconds
[0m14:16:35.684102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15daf8f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15da0c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15da0e210>]}
[0m14:16:35.684343 [debug] [MainThread]: Flushing usage events
[0m14:16:36.020782 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:29:21.429051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d4be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10949fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10949fed0>]}


============================== 14:29:21.431866 | 926e5b52-4c30-4ae5-9905-5bca07045c82 ==============================
[0m14:29:21.431866 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m14:29:21.432146 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'introspect': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/spartan/.dbt', 'invocation_command': 'dbt test', 'no_print': 'None', 'debug': 'False', 'target_path': 'None', 'empty': 'None', 'partial_parse': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/spartan/lab2_project/crypto_analytics_dbt/logs', 'indirect_selection': 'eager', 'use_colors': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'version_check': 'True'}
[0m14:29:22.507342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '926e5b52-4c30-4ae5-9905-5bca07045c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b08a0>]}
[0m14:29:22.527980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '926e5b52-4c30-4ae5-9905-5bca07045c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1314a05a0>]}
[0m14:29:22.528534 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m14:29:22.587171 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m14:29:22.651499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:29:22.651758 [debug] [MainThread]: Partial parsing: added file: crypto_analytics_dbt://models/schema.yml
[0m14:29:22.743896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '926e5b52-4c30-4ae5-9905-5bca07045c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136bd8650>]}
[0m14:29:22.772784 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/manifest.json
[0m14:29:22.773808 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/semantic_manifest.json
[0m14:29:22.788142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '926e5b52-4c30-4ae5-9905-5bca07045c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136f4a210>]}
[0m14:29:22.788325 [info ] [MainThread]: Found 5 models, 10 data tests, 1 source, 492 macros
[0m14:29:22.788450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '926e5b52-4c30-4ae5-9905-5bca07045c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136f46890>]}
[0m14:29:22.789233 [info ] [MainThread]: 
[0m14:29:22.789360 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:29:22.789449 [info ] [MainThread]: 
[0m14:29:22.789623 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:29:22.791199 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_FEAT'
[0m14:29:22.857722 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT"
[0m14:29:22.857881 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT: show objects in USER_DB_PARROT.PARROT_FEAT
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT"} */;
[0m14:29:22.857972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:25.480854 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.623 seconds
[0m14:29:25.485427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '926e5b52-4c30-4ae5-9905-5bca07045c82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130cfc120>]}
[0m14:29:25.489477 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m14:29:25.489969 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m14:29:25.490433 [info ] [Thread-2 (]: 2 of 10 START test not_null_int_crypto_features_symbol ......................... [RUN]
[0m14:29:25.490793 [info ] [Thread-1 (]: 1 of 10 START test not_null_int_crypto_features_price_date ..................... [RUN]
[0m14:29:25.491342 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2'
[0m14:29:25.491707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT, now test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6)
[0m14:29:25.492019 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m14:29:25.492303 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m14:29:25.509272 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m14:29:25.510190 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m14:29:25.510887 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m14:29:25.511143 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m14:29:25.523543 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m14:29:25.524652 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m14:29:25.525393 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m14:29:25.525732 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m14:29:25.525902 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT.int_crypto_features
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"} */
[0m14:29:25.526119 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT.int_crypto_features
where price_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"} */
[0m14:29:25.526346 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:29:25.701017 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.174 seconds
[0m14:29:25.707902 [info ] [Thread-1 (]: 1 of 10 PASS not_null_int_crypto_features_price_date ........................... [[32mPASS[0m in 0.22s]
[0m14:29:25.708356 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m14:29:25.708621 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m14:29:25.708920 [info ] [Thread-1 (]: 3 of 10 START test not_null_mart_crypto_summary_price_date ..................... [RUN]
[0m14:29:25.709263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6, now test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b)
[0m14:29:25.709501 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m14:29:25.711916 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m14:29:25.712383 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m14:29:25.713647 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m14:29:25.714756 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m14:29:25.715019 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT.mart_crypto_summary
where price_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"} */
[0m14:29:26.021312 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.306 seconds
[0m14:29:26.025231 [info ] [Thread-1 (]: 3 of 10 PASS not_null_mart_crypto_summary_price_date ........................... [[32mPASS[0m in 0.32s]
[0m14:29:26.026118 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m14:29:26.026662 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m14:29:26.027179 [info ] [Thread-1 (]: 4 of 10 START test not_null_mart_crypto_summary_symbol ......................... [RUN]
[0m14:29:26.027819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b, now test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce)
[0m14:29:26.028189 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m14:29:26.033359 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m14:29:26.034724 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m14:29:26.037318 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m14:29:26.038656 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m14:29:26.038959 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT.mart_crypto_summary
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"} */
[0m14:29:26.119764 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.593 seconds
[0m14:29:26.123834 [info ] [Thread-2 (]: 2 of 10 PASS not_null_int_crypto_features_symbol ............................... [[32mPASS[0m in 0.63s]
[0m14:29:26.124589 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m14:29:26.124992 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:29:26.125388 [info ] [Thread-2 (]: 5 of 10 START test not_null_my_first_dbt_model_id .............................. [RUN]
[0m14:29:26.125877 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2, now test.crypto_analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710)
[0m14:29:26.126229 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:29:26.132004 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:29:26.132736 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:29:26.134636 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:29:26.135435 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:29:26.135695 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from USER_DB_PARROT.PARROT_FEAT.my_first_dbt_model
where id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
[0m14:29:26.197598 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.158 seconds
[0m14:29:26.200891 [info ] [Thread-1 (]: 4 of 10 PASS not_null_mart_crypto_summary_symbol ............................... [[32mPASS[0m in 0.17s]
[0m14:29:26.201720 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m14:29:26.202154 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m14:29:26.202584 [info ] [Thread-1 (]: 6 of 10 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m14:29:26.203072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce, now test.crypto_analytics_dbt.not_null_my_second_dbt_model_id.151b76d778)
[0m14:29:26.203427 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m14:29:26.209255 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m14:29:26.210409 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m14:29:26.212329 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m14:29:26.213256 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m14:29:26.213574 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from USER_DB_PARROT.PARROT_FEAT.my_second_dbt_model
where id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
[0m14:29:26.229296 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c09d45-0307-1ea2-000f-c0df00940b6a
[0m14:29:26.229619 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_PARROT.PARROT_FEAT.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m14:29:26.235155 [debug] [Thread-2 (]: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_PARROT.PARROT_FEAT.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/crypto_analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m14:29:26.235585 [error] [Thread-2 (]: 5 of 10 ERROR not_null_my_first_dbt_model_id ................................... [[31mERROR[0m in 0.11s]
[0m14:29:26.236026 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:29:26.236305 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m14:29:26.236668 [debug] [Thread-5 (]: Marking all children of 'test.crypto_analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_PARROT.PARROT_FEAT.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/crypto_analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql.
[0m14:29:26.236950 [info ] [Thread-2 (]: 7 of 10 START test not_null_stg_crypto_prices_price_date ....................... [RUN]
[0m14:29:26.237730 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710, now test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314)
[0m14:29:26.237958 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m14:29:26.244742 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m14:29:26.245413 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m14:29:26.246748 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m14:29:26.247358 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m14:29:26.247571 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT.stg_crypto_prices
where price_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"} */
[0m14:29:26.381010 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c09d45-0307-1efa-000f-c0df0093ec36
[0m14:29:26.382032 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_PARROT.PARROT_FEAT.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m14:29:26.388104 [debug] [Thread-1 (]: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_PARROT.PARROT_FEAT.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/crypto_analytics_dbt/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m14:29:26.388670 [error] [Thread-1 (]: 6 of 10 ERROR not_null_my_second_dbt_model_id .................................. [[31mERROR[0m in 0.19s]
[0m14:29:26.389234 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m14:29:26.389588 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m14:29:26.389989 [debug] [Thread-5 (]: Marking all children of 'test.crypto_analytics_dbt.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_PARROT.PARROT_FEAT.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/crypto_analytics_dbt/models/example/schema.yml/not_null_my_second_dbt_model_id.sql.
[0m14:29:26.390316 [info ] [Thread-1 (]: 8 of 10 START test not_null_stg_crypto_prices_symbol ........................... [RUN]
[0m14:29:26.390777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_my_second_dbt_model_id.151b76d778, now test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a)
[0m14:29:26.391074 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m14:29:26.394782 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m14:29:26.395354 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m14:29:26.396958 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m14:29:26.397661 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m14:29:26.397912 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT.stg_crypto_prices
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"} */
[0m14:29:26.690054 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.292 seconds
[0m14:29:26.693477 [info ] [Thread-1 (]: 8 of 10 PASS not_null_stg_crypto_prices_symbol ................................. [[32mPASS[0m in 0.30s]
[0m14:29:26.694439 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m14:29:26.694940 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m14:29:26.695929 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.448 seconds
[0m14:29:26.696319 [info ] [Thread-1 (]: 9 of 10 START test unique_my_first_dbt_model_id ................................ [RUN]
[0m14:29:26.698698 [info ] [Thread-2 (]: 7 of 10 PASS not_null_stg_crypto_prices_price_date ............................. [[32mPASS[0m in 0.46s]
[0m14:29:26.699207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a, now test.crypto_analytics_dbt.unique_my_first_dbt_model_id.16e066b321)
[0m14:29:26.699914 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m14:29:26.700333 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m14:29:26.700746 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m14:29:26.708100 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m14:29:26.708656 [info ] [Thread-2 (]: 10 of 10 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m14:29:26.709303 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314, now test.crypto_analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493)
[0m14:29:26.709653 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m14:29:26.713443 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:29:26.714042 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m14:29:26.714365 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m14:29:26.715988 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m14:29:26.717744 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:29:26.718567 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m14:29:26.718822 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.unique_my_first_dbt_model_id.16e066b321: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from USER_DB_PARROT.PARROT_FEAT.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
[0m14:29:26.719305 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:29:26.719758 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from USER_DB_PARROT.PARROT_FEAT.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
[0m14:29:26.792739 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c09d45-0307-1f0f-000f-c0df00941a16
[0m14:29:26.793332 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_PARROT.PARROT_FEAT.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m14:29:26.799729 [debug] [Thread-2 (]: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_PARROT.PARROT_FEAT.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/crypto_analytics_dbt/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m14:29:26.800464 [error] [Thread-2 (]: 10 of 10 ERROR unique_my_second_dbt_model_id ................................... [[31mERROR[0m in 0.09s]
[0m14:29:26.800956 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m14:29:26.801430 [debug] [Thread-5 (]: Marking all children of 'test.crypto_analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_PARROT.PARROT_FEAT.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/crypto_analytics_dbt/models/example/schema.yml/unique_my_second_dbt_model_id.sql.
[0m14:29:26.808677 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c09d45-0307-1dcb-000f-c0df0094370e
[0m14:29:26.809276 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'USER_DB_PARROT.PARROT_FEAT.MY_FIRST_DBT_MODEL' does not exist or not authorized.
[0m14:29:26.814352 [debug] [Thread-1 (]: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_PARROT.PARROT_FEAT.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/crypto_analytics_dbt/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m14:29:26.814692 [error] [Thread-1 (]: 9 of 10 ERROR unique_my_first_dbt_model_id ..................................... [[31mERROR[0m in 0.12s]
[0m14:29:26.815056 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m14:29:26.815360 [debug] [Thread-5 (]: Marking all children of 'test.crypto_analytics_dbt.unique_my_first_dbt_model_id.16e066b321' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_PARROT.PARROT_FEAT.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/crypto_analytics_dbt/models/example/schema.yml/unique_my_first_dbt_model_id.sql.
[0m14:29:26.816507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:29:26.816768 [debug] [MainThread]: Connection 'test.crypto_analytics_dbt.unique_my_first_dbt_model_id.16e066b321' was left open.
[0m14:29:26.816986 [debug] [MainThread]: On test.crypto_analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m14:29:26.917087 [debug] [MainThread]: Connection 'test.crypto_analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was left open.
[0m14:29:26.917876 [debug] [MainThread]: On test.crypto_analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m14:29:27.029360 [info ] [MainThread]: 
[0m14:29:27.029999 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 4.24 seconds (4.24s).
[0m14:29:27.032283 [debug] [MainThread]: Command end result
[0m14:29:27.056826 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/manifest.json
[0m14:29:27.058594 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/semantic_manifest.json
[0m14:29:27.063586 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/spartan/lab2_project/crypto_analytics_dbt/target/run_results.json
[0m14:29:27.063847 [info ] [MainThread]: 
[0m14:29:27.064090 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m14:29:27.064274 [info ] [MainThread]: 
[0m14:29:27.064492 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m14:29:27.064692 [error] [MainThread]:   Database Error in test not_null_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_PARROT.PARROT_FEAT.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/crypto_analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m14:29:27.064838 [info ] [MainThread]: 
[0m14:29:27.065117 [info ] [MainThread]:   compiled code at target/compiled/crypto_analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m14:29:27.065257 [info ] [MainThread]: 
[0m14:29:27.065415 [error] [MainThread]: [31mFailure in test not_null_my_second_dbt_model_id (models/example/schema.yml)[0m
[0m14:29:27.065576 [error] [MainThread]:   Database Error in test not_null_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_PARROT.PARROT_FEAT.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/crypto_analytics_dbt/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m14:29:27.065707 [info ] [MainThread]: 
[0m14:29:27.065854 [info ] [MainThread]:   compiled code at target/compiled/crypto_analytics_dbt/models/example/schema.yml/not_null_my_second_dbt_model_id.sql
[0m14:29:27.065982 [info ] [MainThread]: 
[0m14:29:27.066137 [error] [MainThread]: [31mFailure in test unique_my_second_dbt_model_id (models/example/schema.yml)[0m
[0m14:29:27.066381 [error] [MainThread]:   Database Error in test unique_my_second_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_PARROT.PARROT_FEAT.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/crypto_analytics_dbt/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m14:29:27.066634 [info ] [MainThread]: 
[0m14:29:27.066800 [info ] [MainThread]:   compiled code at target/compiled/crypto_analytics_dbt/models/example/schema.yml/unique_my_second_dbt_model_id.sql
[0m14:29:27.066928 [info ] [MainThread]: 
[0m14:29:27.067083 [error] [MainThread]: [31mFailure in test unique_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m14:29:27.067392 [error] [MainThread]:   Database Error in test unique_my_first_dbt_model_id (models/example/schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'USER_DB_PARROT.PARROT_FEAT.MY_FIRST_DBT_MODEL' does not exist or not authorized.
  compiled code at target/run/crypto_analytics_dbt/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m14:29:27.067609 [info ] [MainThread]: 
[0m14:29:27.067812 [info ] [MainThread]:   compiled code at target/compiled/crypto_analytics_dbt/models/example/schema.yml/unique_my_first_dbt_model_id.sql
[0m14:29:27.067975 [info ] [MainThread]: 
[0m14:29:27.068174 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=4 SKIP=0 NO-OP=0 TOTAL=10
[0m14:29:27.074039 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 5.674525, "process_in_blocks": "0", "process_kernel_time": 0.923919, "process_mem_max_rss": "238518272", "process_out_blocks": "0", "process_user_time": 2.780557}
[0m14:29:27.074611 [debug] [MainThread]: Command `dbt test` failed at 14:29:27.074426 after 5.68 seconds
[0m14:29:27.074886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e29e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1408e1180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1408e0ec0>]}
[0m14:29:27.075087 [debug] [MainThread]: Flushing usage events
[0m14:29:27.423101 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:33:11.298059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea3e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a5bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a5bed0>]}


============================== 14:33:11.300743 | 6148ebb3-3e1a-4ef3-8003-5eb2beb5af29 ==============================
[0m14:33:11.300743 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m14:33:11.301004 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'version_check': 'True', 'log_path': '/Users/spartan/lab2_project/crypto_analytics_dbt/logs', 'use_colors': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/Users/spartan/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'quiet': 'False', 'target_path': 'None', 'debug': 'False', 'invocation_command': 'dbt test', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'no_print': 'None', 'warn_error': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'introspect': 'True', 'printer_width': '80'}
[0m14:33:12.123803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6148ebb3-3e1a-4ef3-8003-5eb2beb5af29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104448a0>]}
[0m14:33:12.173563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6148ebb3-3e1a-4ef3-8003-5eb2beb5af29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d1a05a0>]}
[0m14:33:12.174174 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m14:33:12.231670 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m14:33:12.298107 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m14:33:12.298430 [debug] [MainThread]: Partial parsing: deleted file: crypto_analytics_dbt://models/example/my_first_dbt_model.sql
[0m14:33:12.298531 [debug] [MainThread]: Partial parsing: deleted file: crypto_analytics_dbt://models/example/my_second_dbt_model.sql
[0m14:33:12.332538 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_analytics_dbt.example
[0m14:33:12.337377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6148ebb3-3e1a-4ef3-8003-5eb2beb5af29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d46c450>]}
[0m14:33:12.369496 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/manifest.json
[0m14:33:12.370546 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/semantic_manifest.json
[0m14:33:12.386066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6148ebb3-3e1a-4ef3-8003-5eb2beb5af29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d937980>]}
[0m14:33:12.386314 [info ] [MainThread]: Found 3 models, 6 data tests, 1 source, 492 macros
[0m14:33:12.386452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6148ebb3-3e1a-4ef3-8003-5eb2beb5af29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d9d2270>]}
[0m14:33:12.387261 [info ] [MainThread]: 
[0m14:33:12.387403 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:33:12.387497 [info ] [MainThread]: 
[0m14:33:12.387676 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:33:12.389554 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_FEAT'
[0m14:33:12.457336 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT"
[0m14:33:12.457518 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT: show objects in USER_DB_PARROT.PARROT_FEAT
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT"} */;
[0m14:33:12.457618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:15.069032 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.611 seconds
[0m14:33:15.073897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6148ebb3-3e1a-4ef3-8003-5eb2beb5af29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16cafc120>]}
[0m14:33:15.078727 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m14:33:15.079192 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m14:33:15.079626 [info ] [Thread-1 (]: 1 of 6 START test not_null_int_crypto_features_price_date ...................... [RUN]
[0m14:33:15.080206 [info ] [Thread-2 (]: 2 of 6 START test not_null_int_crypto_features_symbol .......................... [RUN]
[0m14:33:15.080751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT, now test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6)
[0m14:33:15.081237 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2'
[0m14:33:15.081599 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m14:33:15.081890 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m14:33:15.101603 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m14:33:15.102024 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m14:33:15.102753 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m14:33:15.103026 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m14:33:15.116835 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m14:33:15.117062 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m14:33:15.117661 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m14:33:15.117999 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m14:33:15.118183 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT.int_crypto_features
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"} */
[0m14:33:15.118369 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT.int_crypto_features
where price_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"} */
[0m14:33:15.118530 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:33:15.255633 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.137 seconds
[0m14:33:15.265741 [info ] [Thread-1 (]: 1 of 6 PASS not_null_int_crypto_features_price_date ............................ [[32mPASS[0m in 0.18s]
[0m14:33:15.266381 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m14:33:15.266683 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m14:33:15.267022 [info ] [Thread-1 (]: 3 of 6 START test not_null_mart_crypto_summary_price_date ...................... [RUN]
[0m14:33:15.267418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6, now test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b)
[0m14:33:15.267697 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m14:33:15.270551 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m14:33:15.271024 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m14:33:15.273138 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m14:33:15.273892 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m14:33:15.274123 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT.mart_crypto_summary
where price_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"} */
[0m14:33:15.352918 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m14:33:15.356073 [info ] [Thread-1 (]: 3 of 6 PASS not_null_mart_crypto_summary_price_date ............................ [[32mPASS[0m in 0.09s]
[0m14:33:15.356778 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m14:33:15.357185 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m14:33:15.357613 [info ] [Thread-1 (]: 4 of 6 START test not_null_mart_crypto_summary_symbol .......................... [RUN]
[0m14:33:15.358100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b, now test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce)
[0m14:33:15.358445 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m14:33:15.362823 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m14:33:15.363680 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m14:33:15.366299 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m14:33:15.367066 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m14:33:15.367348 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT.mart_crypto_summary
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"} */
[0m14:33:15.492568 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.125 seconds
[0m14:33:15.496243 [info ] [Thread-1 (]: 4 of 6 PASS not_null_mart_crypto_summary_symbol ................................ [[32mPASS[0m in 0.14s]
[0m14:33:15.497063 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m14:33:15.497517 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m14:33:15.497949 [info ] [Thread-1 (]: 5 of 6 START test not_null_stg_crypto_prices_price_date ........................ [RUN]
[0m14:33:15.498535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce, now test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314)
[0m14:33:15.498950 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m14:33:15.503660 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m14:33:15.506215 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m14:33:15.509769 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m14:33:15.511567 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m14:33:15.511912 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT.stg_crypto_prices
where price_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"} */
[0m14:33:15.606847 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.094 seconds
[0m14:33:15.610603 [info ] [Thread-1 (]: 5 of 6 PASS not_null_stg_crypto_prices_price_date .............................. [[32mPASS[0m in 0.11s]
[0m14:33:15.611325 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m14:33:15.611748 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m14:33:15.612150 [info ] [Thread-1 (]: 6 of 6 START test not_null_stg_crypto_prices_symbol ............................ [RUN]
[0m14:33:15.612612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314, now test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a)
[0m14:33:15.612994 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m14:33:15.617802 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m14:33:15.618841 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m14:33:15.621233 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m14:33:15.623431 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m14:33:15.624069 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT.stg_crypto_prices
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"} */
[0m14:33:15.811525 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.187 seconds
[0m14:33:15.813403 [info ] [Thread-1 (]: 6 of 6 PASS not_null_stg_crypto_prices_symbol .................................. [[32mPASS[0m in 0.20s]
[0m14:33:15.813838 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m14:33:17.646548 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.528 seconds
[0m14:33:17.649924 [info ] [Thread-2 (]: 2 of 6 PASS not_null_int_crypto_features_symbol ................................ [[32mPASS[0m in 2.57s]
[0m14:33:17.650690 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m14:33:17.652369 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:33:17.652739 [debug] [MainThread]: Connection 'test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a' was left open.
[0m14:33:17.653045 [debug] [MainThread]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a: Close
[0m14:33:17.783588 [debug] [MainThread]: Connection 'test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2' was left open.
[0m14:33:17.784505 [debug] [MainThread]: On test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2: Close
[0m14:33:17.915318 [info ] [MainThread]: 
[0m14:33:17.916422 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 5.53 seconds (5.53s).
[0m14:33:17.918008 [debug] [MainThread]: Command end result
[0m14:33:17.941271 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/manifest.json
[0m14:33:17.943415 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/semantic_manifest.json
[0m14:33:17.948617 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/spartan/lab2_project/crypto_analytics_dbt/target/run_results.json
[0m14:33:17.948841 [info ] [MainThread]: 
[0m14:33:17.949097 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:33:17.949252 [info ] [MainThread]: 
[0m14:33:17.949430 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m14:33:17.954676 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.687391, "process_in_blocks": "0", "process_kernel_time": 1.12471, "process_mem_max_rss": "234586112", "process_out_blocks": "0", "process_user_time": 2.947561}
[0m14:33:17.955071 [debug] [MainThread]: Command `dbt test` succeeded at 14:33:17.954998 after 6.69 seconds
[0m14:33:17.955302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11179de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x170e7bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x170e7be30>]}
[0m14:33:17.955513 [debug] [MainThread]: Flushing usage events
[0m14:33:18.380976 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:35:55.360663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103aebe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10523fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10523fed0>]}


============================== 14:35:55.363689 | 1547e1bf-e9fc-4787-ba78-81198ca97e2f ==============================
[0m14:35:55.363689 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m14:35:55.363959 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'printer_width': '80', 'partial_parse': 'True', 'profiles_dir': '/Users/spartan/.dbt', 'use_colors': 'True', 'log_format': 'default', 'version_check': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_path': '/Users/spartan/lab2_project/crypto_analytics_dbt/logs', 'write_json': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'debug': 'False', 'invocation_command': 'dbt snapshot'}
[0m14:35:56.205764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1547e1bf-e9fc-4787-ba78-81198ca97e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040508a0>]}
[0m14:35:56.226285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1547e1bf-e9fc-4787-ba78-81198ca97e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1493a05a0>]}
[0m14:35:56.226852 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m14:35:56.284962 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m14:35:56.351401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:35:56.351694 [debug] [MainThread]: Partial parsing: added file: crypto_analytics_dbt://snapshots/crypto_prices_snapshot.sql
[0m14:35:56.457185 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_analytics_dbt.example
[0m14:35:56.461980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1547e1bf-e9fc-4787-ba78-81198ca97e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149380b50>]}
[0m14:35:56.496782 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/manifest.json
[0m14:35:56.498347 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/semantic_manifest.json
[0m14:35:56.509128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1547e1bf-e9fc-4787-ba78-81198ca97e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149842e40>]}
[0m14:35:56.509348 [info ] [MainThread]: Found 3 models, 6 data tests, 1 snapshot, 1 source, 492 macros
[0m14:35:56.509469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1547e1bf-e9fc-4787-ba78-81198ca97e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ba2fbd0>]}
[0m14:35:56.510174 [info ] [MainThread]: 
[0m14:35:56.510298 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:35:56.510387 [info ] [MainThread]: 
[0m14:35:56.510560 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:35:56.510893 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m14:35:56.575974 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m14:35:56.576153 [debug] [ThreadPool]: On list_USER_DB_PARROT: show terse schemas in database USER_DB_PARROT
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
[0m14:35:56.576258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:57.254401 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.678 seconds
[0m14:35:57.260762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now list_USER_DB_PARROT_PARROT_SNAP)
[0m14:35:57.261348 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_FEAT'
[0m14:35:57.272944 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m14:35:57.273756 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT"
[0m14:35:57.273904 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: show objects in USER_DB_PARROT.PARROT_SNAP
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */;
[0m14:35:57.274024 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT: show objects in USER_DB_PARROT.PARROT_FEAT
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT"} */;
[0m14:35:57.274275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:57.510306 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.236 seconds
[0m14:35:57.736482 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.462 seconds
[0m14:35:57.741127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1547e1bf-e9fc-4787-ba78-81198ca97e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1522dbe10>]}
[0m14:35:57.746043 [debug] [Thread-1 (]: Began running node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m14:35:57.746847 [info ] [Thread-1 (]: 1 of 1 START snapshot PARROT_SNAP.crypto_prices_snapshot ....................... [RUN]
[0m14:35:57.747582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_SNAP, now snapshot.crypto_analytics_dbt.crypto_prices_snapshot)
[0m14:35:57.748192 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m14:35:57.756480 [debug] [Thread-1 (]: Began executing node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m14:35:57.783312 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m14:35:57.783523 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: select * from (
        
    

    select *,
        md5(coalesce(cast(symbol || to_char(price_date) as varchar ), '')
         || '|' || coalesce(cast(INGESTED_AT as varchar ), '')
        ) as dbt_scd_id,
        INGESTED_AT as dbt_updated_at,
        INGESTED_AT as dbt_valid_from,
        
  
  coalesce(nullif(INGESTED_AT, INGESTED_AT), null)
  as dbt_valid_to
from (
        



select
    SYMBOL,
    PRICE_DATE,
    OPEN,
    HIGH,
    LOW,
    CLOSE,
    ADJ_CLOSE,
    VOLUME,
    INGESTED_AT
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
[0m14:35:57.961040 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.177 seconds
[0m14:35:57.965716 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m14:35:57.965859 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
[0m14:35:58.167580 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.201 seconds
[0m14:35:58.168746 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m14:35:58.170915 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m14:35:58.171378 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: create or replace transient table USER_DB_PARROT.PARROT_SNAP.crypto_prices_snapshot
    
    
    
    as (
    

    select *,
        md5(coalesce(cast(symbol || to_char(price_date) as varchar ), '')
         || '|' || coalesce(cast(INGESTED_AT as varchar ), '')
        ) as dbt_scd_id,
        INGESTED_AT as dbt_updated_at,
        INGESTED_AT as dbt_valid_from,
        
  
  coalesce(nullif(INGESTED_AT, INGESTED_AT), null)
  as dbt_valid_to
from (
        



select
    SYMBOL,
    PRICE_DATE,
    OPEN,
    HIGH,
    LOW,
    CLOSE,
    ADJ_CLOSE,
    VOLUME,
    INGESTED_AT
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES

    ) sbq



    )

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */;
[0m14:35:59.298938 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.127 seconds
[0m14:35:59.324647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1547e1bf-e9fc-4787-ba78-81198ca97e2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1522ca810>]}
[0m14:35:59.325480 [info ] [Thread-1 (]: 1 of 1 OK snapshotted PARROT_SNAP.crypto_prices_snapshot ....................... [[32mSUCCESS 1[0m in 1.58s]
[0m14:35:59.325926 [debug] [Thread-1 (]: Finished running node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m14:35:59.327080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:59.327285 [debug] [MainThread]: Connection 'snapshot.crypto_analytics_dbt.crypto_prices_snapshot' was left open.
[0m14:35:59.327462 [debug] [MainThread]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: Close
[0m14:35:59.428414 [debug] [MainThread]: Connection 'list_USER_DB_PARROT_PARROT_FEAT' was left open.
[0m14:35:59.428871 [debug] [MainThread]: On list_USER_DB_PARROT_PARROT_FEAT: Close
[0m14:35:59.604548 [info ] [MainThread]: 
[0m14:35:59.605552 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.09 seconds (3.09s).
[0m14:35:59.606679 [debug] [MainThread]: Command end result
[0m14:35:59.627823 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/manifest.json
[0m14:35:59.629379 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/spartan/lab2_project/crypto_analytics_dbt/target/semantic_manifest.json
[0m14:35:59.633720 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/spartan/lab2_project/crypto_analytics_dbt/target/run_results.json
[0m14:35:59.633939 [info ] [MainThread]: 
[0m14:35:59.634184 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:35:59.634348 [info ] [MainThread]: 
[0m14:35:59.634533 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:35:59.639852 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 4.310544, "process_in_blocks": "0", "process_kernel_time": 2.389103, "process_mem_max_rss": "242728960", "process_out_blocks": "0", "process_user_time": 1.637057}
[0m14:35:59.640287 [debug] [MainThread]: Command `dbt snapshot` succeeded at 14:35:59.640202 after 4.31 seconds
[0m14:35:59.640547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1523eaba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152480eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152480a50>]}
[0m14:35:59.640758 [debug] [MainThread]: Flushing usage events
[0m14:35:59.990222 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:56:44.476999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadadfbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad174bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacb11fa0>]}
[0m01:56:44.476845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d8f17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bad33b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1c2c30>]}
[0m01:56:44.476848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89057aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff887cd820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff887ce360>]}
[0m01:56:44.476965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa59cef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa334ae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa32b2180>]}
[0m01:56:44.477349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bc44470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b637b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8df88c80>]}


============================== 01:56:44.486481 | 4d72575a-5d35-4f36-9085-27899a98cf0d ==============================
[0m01:56:44.486481 [info ] [MainThread]: Running with dbt=1.8.7


============================== 01:56:44.486284 | 25a1a4de-8619-4efc-9c49-49ceb931d0ac ==============================
[0m01:56:44.486284 [info ] [MainThread]: Running with dbt=1.8.7


============================== 01:56:44.486914 | 914b4236-2f92-45f5-a575-911ff194812a ==============================
[0m01:56:44.486914 [info ] [MainThread]: Running with dbt=1.8.7


============================== 01:56:44.487903 | dc45273c-0287-4a67-915d-8d702e9229ed ==============================
[0m01:56:44.487903 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:56:44.488053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}


============================== 01:56:44.487858 | 7a741385-d03e-42c7-ad22-f62db1b8cfee ==============================
[0m01:56:44.487858 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:56:44.488952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:56:44.489719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:56:44.489801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m01:56:44.491045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m01:56:44.495100 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  /home/airflow/.dbt/profiles.yml
  
[0m01:56:44.495273 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  /home/airflow/.dbt/profiles.yml
  
[0m01:56:44.495341 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  /home/airflow/.dbt/profiles.yml
  
[0m01:56:44.495909 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  /home/airflow/.dbt/profiles.yml
  
[0m01:56:44.495972 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  /home/airflow/.dbt/profiles.yml
  
[0m01:56:44.496762 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.09233375, "process_user_time": 2.404783, "process_kernel_time": 0.166261, "process_mem_max_rss": "169972", "process_in_blocks": "504", "process_out_blocks": "1323", "command_success": false}
[0m01:56:44.497069 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.09795083, "process_user_time": 2.403105, "process_kernel_time": 0.163802, "process_mem_max_rss": "169968", "process_in_blocks": "1064", "process_out_blocks": "1339", "command_success": false}
[0m01:56:44.497523 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.09860425, "process_user_time": 2.401542, "process_kernel_time": 0.164242, "process_mem_max_rss": "169968", "process_in_blocks": "384", "process_out_blocks": "1331", "command_success": false}
[0m01:56:44.497748 [debug] [MainThread]: Command `dbt run` failed at 01:56:44.497539 after 0.09 seconds
[0m01:56:44.497030 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.09610396, "process_user_time": 2.437236, "process_kernel_time": 0.137125, "process_mem_max_rss": "169968", "process_in_blocks": "576", "process_out_blocks": "1315", "command_success": false}
[0m01:56:44.497770 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.088927, "process_user_time": 2.386817, "process_kernel_time": 0.189382, "process_mem_max_rss": "169968", "process_in_blocks": "312", "process_out_blocks": "1315", "command_success": false}
[0m01:56:44.498352 [debug] [MainThread]: Command `dbt run` failed at 01:56:44.498092 after 0.10 seconds
[0m01:56:44.498554 [debug] [MainThread]: Command `dbt run` failed at 01:56:44.498403 after 0.10 seconds
[0m01:56:44.498447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9be27920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cebdf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bd92540>]}
[0m01:56:44.498939 [debug] [MainThread]: Command `dbt run` failed at 01:56:44.498711 after 0.10 seconds
[0m01:56:44.499195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb13c7080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacb10a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacb10c50>]}
[0m01:56:44.499849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa478a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa35457c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa59cef90>]}
[0m01:56:44.499123 [debug] [MainThread]: Command `dbt run` failed at 01:56:44.498836 after 0.09 seconds
[0m01:56:44.499548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88401040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8931b5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ad64b0>]}
[0m01:56:44.499598 [debug] [MainThread]: Flushing usage events
[0m01:56:44.500331 [debug] [MainThread]: Flushing usage events
[0m01:56:44.500577 [debug] [MainThread]: Flushing usage events
[0m01:56:44.500779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bc44470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c1c9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b75fa70>]}
[0m01:56:44.501008 [debug] [MainThread]: Flushing usage events
[0m01:56:44.501752 [debug] [MainThread]: Flushing usage events
[0m01:57:11.218419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d447d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa54deea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d446e0>]}


============================== 01:57:11.224434 | d3cf4ff6-a636-46ce-93b1-8f75879c9d3f ==============================
[0m01:57:11.224434 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:57:11.224910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:57:11.226779 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  /home/airflow/.dbt/profiles.yml
  
[0m01:57:11.227895 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.045430124, "process_user_time": 1.505609, "process_kernel_time": 0.109189, "process_mem_max_rss": "169976", "process_out_blocks": "3", "command_success": false, "process_in_blocks": "0"}
[0m01:57:11.229024 [debug] [MainThread]: Command `dbt run` failed at 01:57:11.228942 after 0.05 seconds
[0m01:57:11.229617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa56aa9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa58839b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9a07050>]}
[0m01:57:11.230223 [debug] [MainThread]: Flushing usage events
[0m01:58:19.626216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91024e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91834260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91bb3cb0>]}


============================== 01:58:19.632643 | beb57143-6baa-4103-aee4-00d9cf79a488 ==============================
[0m01:58:19.632643 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:58:19.633443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:58:19.635311 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  /home/airflow/.dbt/profiles.yml
  
[0m01:58:19.636179 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.044779126, "process_user_time": 1.482492, "process_kernel_time": 0.117038, "process_mem_max_rss": "164128", "process_out_blocks": "3", "command_success": false, "process_in_blocks": "0"}
[0m01:58:19.636689 [debug] [MainThread]: Command `dbt run` failed at 01:58:19.636571 after 0.05 seconds
[0m01:58:19.637056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff920d6480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff913eef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91bb3dd0>]}
[0m01:58:19.637396 [debug] [MainThread]: Flushing usage events
[0m02:01:49.505285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9fbaf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9811e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa913cbf0>]}
[0m02:01:49.505342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0bc1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f024bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3168e60>]}


============================== 02:01:49.514562 | a7c738dd-9c6b-46db-ad16-123a37cfdfa8 ==============================
[0m02:01:49.514562 [info ] [MainThread]: Running with dbt=1.8.7


============================== 02:01:49.514692 | 463105e5-d89a-4a50-8058-5c00f7b5acf4 ==============================
[0m02:01:49.514692 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:01:49.515906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:01:49.516233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:01:49.509819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4371f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa38fb680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa35a05f0>]}
[0m02:01:49.509823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8907fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff899dde20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ee4830>]}


============================== 02:01:49.518708 | 5d3d4f36-b5bf-41f3-b5b8-8072557df687 ==============================
[0m02:01:49.518708 [info ] [MainThread]: Running with dbt=1.8.7


============================== 02:01:49.518835 | 719341ec-d0ba-4340-9ef5-7b88c733fd4f ==============================
[0m02:01:49.518835 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:01:49.519875 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  /home/airflow/.dbt/profiles.yml
  
[0m02:01:49.520399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:01:49.520182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:01:49.520429 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  /home/airflow/.dbt/profiles.yml
  
[0m02:01:49.521660 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.078875124, "process_user_time": 2.576334, "process_kernel_time": 0.240337, "process_mem_max_rss": "164132", "process_out_blocks": "3", "command_success": false, "process_in_blocks": "0"}
[0m02:01:49.522171 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.077195875, "process_user_time": 2.637368, "process_kernel_time": 0.183206, "process_mem_max_rss": "164140", "process_out_blocks": "3", "command_success": false, "process_in_blocks": "0"}
[0m02:01:49.522557 [debug] [MainThread]: Command `dbt run` failed at 02:01:49.522431 after 0.08 seconds
[0m02:01:49.522986 [debug] [MainThread]: Command `dbt run` failed at 02:01:49.522799 after 0.08 seconds
[0m02:01:49.523434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa96f8e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad507050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9178a40>]}
[0m02:01:49.523684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa32e7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef93c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0bc1940>]}
[0m02:01:49.524229 [debug] [MainThread]: Flushing usage events
[0m02:01:49.524589 [debug] [MainThread]: Flushing usage events
[0m02:01:49.524377 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  /home/airflow/.dbt/profiles.yml
  
[0m02:01:49.524745 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  /home/airflow/.dbt/profiles.yml
  
[0m02:01:49.526468 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.07665825, "process_user_time": 2.609497, "process_kernel_time": 0.21199, "process_mem_max_rss": "164132", "process_out_blocks": "3", "command_success": false, "process_in_blocks": "0"}
[0m02:01:49.526652 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.076692045, "process_user_time": 2.601933, "process_kernel_time": 0.221698, "process_mem_max_rss": "164140", "process_out_blocks": "3", "command_success": false, "process_in_blocks": "0"}
[0m02:01:49.527623 [debug] [MainThread]: Command `dbt run` failed at 02:01:49.527446 after 0.08 seconds
[0m02:01:49.527716 [debug] [MainThread]: Command `dbt run` failed at 02:01:49.527590 after 0.08 seconds
[0m02:01:49.528243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891b7320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ee4c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d88560>]}
[0m02:01:49.528479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2c14320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4808380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2bf9070>]}
[0m02:01:49.528901 [debug] [MainThread]: Flushing usage events
[0m02:01:49.529261 [debug] [MainThread]: Flushing usage events
[0m02:01:49.529444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5b0f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5b0d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa597cbf0>]}


============================== 02:01:49.538924 | c9dca2f3-3819-4828-9eb9-6ed9acb2424c ==============================
[0m02:01:49.538924 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:01:49.539806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:01:49.542990 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  /home/airflow/.dbt/profiles.yml
  
[0m02:01:49.544237 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.07670579, "process_user_time": 2.647687, "process_kernel_time": 0.19388, "process_mem_max_rss": "164140", "process_out_blocks": "3", "command_success": false, "process_in_blocks": "0"}
[0m02:01:49.544919 [debug] [MainThread]: Command `dbt run` failed at 02:01:49.544825 after 0.08 seconds
[0m02:01:49.545686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5c951f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa64db3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa59e8a40>]}
[0m02:01:49.546575 [debug] [MainThread]: Flushing usage events
[0m02:02:14.711900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff987688f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95f715b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b18170>]}


============================== 02:02:14.717831 | 60abca60-c87d-4b8e-8421-61743479bb68 ==============================
[0m02:02:14.717831 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:02:14.718861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:02:14.720813 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  /home/airflow/.dbt/profiles.yml
  
[0m02:02:14.721714 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.044182707, "process_user_time": 1.56246, "process_kernel_time": 0.120266, "process_mem_max_rss": "164124", "process_out_blocks": "3", "command_success": false, "process_in_blocks": "0"}
[0m02:02:14.722203 [debug] [MainThread]: Command `dbt run` failed at 02:02:14.722095 after 0.04 seconds
[0m02:02:14.722579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95dda420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95ae4fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95ae7a70>]}
[0m02:02:14.722917 [debug] [MainThread]: Flushing usage events
[0m02:03:22.392097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b505100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e188d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c9c2180>]}


============================== 02:03:22.398879 | 14cac8fe-0c87-453b-b0e0-94ca56156923 ==============================
[0m02:03:22.398879 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:03:22.399797 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:03:22.401941 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  /home/airflow/.dbt/profiles.yml
  
[0m02:03:22.402921 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.045481376, "process_user_time": 1.580283, "process_kernel_time": 0.120945, "process_mem_max_rss": "164120", "process_out_blocks": "3", "command_success": false, "process_in_blocks": "0"}
[0m02:03:22.403423 [debug] [MainThread]: Command `dbt run` failed at 02:03:22.403344 after 0.05 seconds
[0m02:03:22.403771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f875160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b54cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b54e540>]}
[0m02:03:22.404116 [debug] [MainThread]: Flushing usage events
[0m02:09:30.473451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6dfeba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6eb51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb65d29c0>]}


============================== 02:09:30.479346 | 3ce2b4ae-e4ad-4d7f-a168-fcdf19321af2 ==============================
[0m02:09:30.479346 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:09:30.480129 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:09:31.124625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ce2b4ae-e4ad-4d7f-a168-fcdf19321af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff967b3b90>]}
[0m02:09:31.159936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ce2b4ae-e4ad-4d7f-a168-fcdf19321af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6234560>]}
[0m02:09:31.160941 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:09:31.231724 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:09:31.318484 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m02:09:31.319197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3ce2b4ae-e4ad-4d7f-a168-fcdf19321af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6dff3e0>]}
[0m02:09:32.087811 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:09:32.088810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3ce2b4ae-e4ad-4d7f-a168-fcdf19321af2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6a168a0>]}
[0m02:09:32.340017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ce2b4ae-e4ad-4d7f-a168-fcdf19321af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f2cf860>]}
[0m02:09:32.432210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ce2b4ae-e4ad-4d7f-a168-fcdf19321af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94cfbb30>]}
[0m02:09:32.432820 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m02:09:32.433492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ce2b4ae-e4ad-4d7f-a168-fcdf19321af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c06690>]}
[0m02:09:32.435018 [info ] [MainThread]: 
[0m02:09:32.435670 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:09:32.439422 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m02:09:32.450214 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m02:09:32.450590 [debug] [ThreadPool]: On list_USER_DB_PARROT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
show terse schemas in database USER_DB_PARROT
    limit 10000
[0m02:09:32.450892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:09:33.152255 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.701 seconds
[0m02:09:33.155454 [debug] [ThreadPool]: On list_USER_DB_PARROT: Close
[0m02:09:33.364288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now create_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT)
[0m02:09:33.364973 [debug] [ThreadPool]: Creating schema "database: "USER_DB_PARROT"
schema: "PARROT_FEAT_PARROT_FEAT"
"
[0m02:09:33.369592 [debug] [ThreadPool]: Using snowflake connection "create_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m02:09:33.369981 [debug] [ThreadPool]: On create_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "create_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
create schema if not exists USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT
[0m02:09:33.370294 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:09:34.001879 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.631 seconds
[0m02:09:34.004250 [debug] [ThreadPool]: On create_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m02:09:34.258953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now list_USER_DB_PARROT_PARROT_SNAP)
[0m02:09:34.263420 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT'
[0m02:09:34.272375 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m02:09:34.274998 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m02:09:34.275687 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m02:09:34.276189 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m02:09:34.276650 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:09:34.277054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:09:34.923044 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.646 seconds
[0m02:09:34.926119 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m02:09:35.050863 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.774 seconds
[0m02:09:35.053897 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m02:09:35.270086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ce2b4ae-e4ad-4d7f-a168-fcdf19321af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f365cd0>]}
[0m02:09:35.271775 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m02:09:35.273169 [info ] [MainThread]: 
[0m02:09:35.286498 [debug] [Thread-1 (]: Began running node model.crypto_analytics_dbt.stg_crypto_prices
[0m02:09:35.287347 [info ] [Thread-1 (]: 1 of 3 START sql view model PARROT_FEAT_PARROT_FEAT.stg_crypto_prices .......... [RUN]
[0m02:09:35.288275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_SNAP, now model.crypto_analytics_dbt.stg_crypto_prices)
[0m02:09:35.288695 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics_dbt.stg_crypto_prices
[0m02:09:35.295224 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics_dbt.stg_crypto_prices"
[0m02:09:35.296897 [debug] [Thread-1 (]: Began executing node model.crypto_analytics_dbt.stg_crypto_prices
[0m02:09:35.318547 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics_dbt.stg_crypto_prices"
[0m02:09:35.320634 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_analytics_dbt.stg_crypto_prices"
[0m02:09:35.321001 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.stg_crypto_prices"} */
create or replace   view USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
  
   as (
    

select
  upper(symbol)                                      as symbol,
  cast(price_date as date)                           as price_date,
  cast(open as number(38,8))                         as open,
  cast(high as number(38,8))                         as high,
  cast(low as number(38,8))                          as low,
  cast(close as number(38,8))                        as close,
  cast(adj_close as number(38,8))                    as adj_close,
  cast(volume as number(38,8))                       as volume
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES
  );
[0m02:09:35.321316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:35.987032 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.665 seconds
[0m02:09:36.011881 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.stg_crypto_prices: Close
[0m02:09:36.283791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ce2b4ae-e4ad-4d7f-a168-fcdf19321af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9501e240>]}
[0m02:09:36.285295 [info ] [Thread-1 (]: 1 of 3 OK created sql view model PARROT_FEAT_PARROT_FEAT.stg_crypto_prices ..... [[32mSUCCESS 1[0m in 0.99s]
[0m02:09:36.286872 [debug] [Thread-1 (]: Finished running node model.crypto_analytics_dbt.stg_crypto_prices
[0m02:09:36.288404 [debug] [Thread-2 (]: Began running node model.crypto_analytics_dbt.int_crypto_features
[0m02:09:36.289403 [info ] [Thread-2 (]: 2 of 3 START sql table model PARROT_FEAT_PARROT_FEAT.int_crypto_features ....... [RUN]
[0m02:09:36.290504 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now model.crypto_analytics_dbt.int_crypto_features)
[0m02:09:36.291161 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics_dbt.int_crypto_features
[0m02:09:36.296489 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics_dbt.int_crypto_features"
[0m02:09:36.298745 [debug] [Thread-2 (]: Began executing node model.crypto_analytics_dbt.int_crypto_features
[0m02:09:36.314923 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics_dbt.int_crypto_features"
[0m02:09:36.316545 [debug] [Thread-2 (]: Using snowflake connection "model.crypto_analytics_dbt.int_crypto_features"
[0m02:09:36.316887 [debug] [Thread-2 (]: On model.crypto_analytics_dbt.int_crypto_features: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.int_crypto_features"} */
create or replace transient table USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
         as
        (

with base as (
  select *
  from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
)
select
  symbol,
  price_date,
  close,
  avg(close) over (partition by symbol order by price_date rows between 4 preceding and current row)  as sma_5,
  avg(close) over (partition by symbol order by price_date rows between 19 preceding and current row) as sma_20,
  avg(close) over (partition by symbol order by price_date rows between 49 preceding and current row) as sma_50,
  (close / nullif(lag(close,5) over (partition by symbol order by price_date),0) - 1) * 100 as momentum_5d_pct
from base
        );
[0m02:09:36.317194 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:09:37.671348 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.353 seconds
[0m02:09:37.674080 [debug] [Thread-2 (]: On model.crypto_analytics_dbt.int_crypto_features: Close
[0m02:09:37.879814 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ce2b4ae-e4ad-4d7f-a168-fcdf19321af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e974620>]}
[0m02:09:37.880655 [info ] [Thread-2 (]: 2 of 3 OK created sql table model PARROT_FEAT_PARROT_FEAT.int_crypto_features .. [[32mSUCCESS 1[0m in 1.59s]
[0m02:09:37.881532 [debug] [Thread-2 (]: Finished running node model.crypto_analytics_dbt.int_crypto_features
[0m02:09:37.882314 [debug] [Thread-1 (]: Began running node model.crypto_analytics_dbt.mart_crypto_summary
[0m02:09:37.882901 [info ] [Thread-1 (]: 3 of 3 START sql table model PARROT_FEAT_PARROT_FEAT.mart_crypto_summary ....... [RUN]
[0m02:09:37.883491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics_dbt.stg_crypto_prices, now model.crypto_analytics_dbt.mart_crypto_summary)
[0m02:09:37.883930 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics_dbt.mart_crypto_summary
[0m02:09:37.886800 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics_dbt.mart_crypto_summary"
[0m02:09:37.888244 [debug] [Thread-1 (]: Began executing node model.crypto_analytics_dbt.mart_crypto_summary
[0m02:09:37.890513 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics_dbt.mart_crypto_summary"
[0m02:09:37.891737 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_analytics_dbt.mart_crypto_summary"
[0m02:09:37.892096 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.mart_crypto_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.mart_crypto_summary"} */
create or replace transient table USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
         as
        (

select
  symbol,
  price_date,
  close,
  sma_5,
  sma_20,
  sma_50,
  momentum_5d_pct,
  case when sma_5 > sma_20 then 1 else 0 end as bull_signal_cross
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
order by price_date, symbol
        );
[0m02:09:37.892457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:39.648027 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.755 seconds
[0m02:09:39.650284 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.mart_crypto_summary: Close
[0m02:09:39.894534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ce2b4ae-e4ad-4d7f-a168-fcdf19321af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6234380>]}
[0m02:09:39.896025 [info ] [Thread-1 (]: 3 of 3 OK created sql table model PARROT_FEAT_PARROT_FEAT.mart_crypto_summary .. [[32mSUCCESS 1[0m in 2.01s]
[0m02:09:39.897246 [debug] [Thread-1 (]: Finished running node model.crypto_analytics_dbt.mart_crypto_summary
[0m02:09:39.899323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:09:39.900011 [debug] [MainThread]: Connection 'model.crypto_analytics_dbt.mart_crypto_summary' was properly closed.
[0m02:09:39.900372 [debug] [MainThread]: Connection 'model.crypto_analytics_dbt.int_crypto_features' was properly closed.
[0m02:09:39.900838 [info ] [MainThread]: 
[0m02:09:39.901693 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 7.47 seconds (7.47s).
[0m02:09:39.902706 [debug] [MainThread]: Command end result
[0m02:09:39.935751 [info ] [MainThread]: 
[0m02:09:39.936412 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:09:39.936914 [info ] [MainThread]: 
[0m02:09:39.937272 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m02:09:39.938115 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.497228, "process_user_time": 4.438159, "process_kernel_time": 0.252553, "process_mem_max_rss": "218284", "process_in_blocks": "1848", "process_out_blocks": "2849"}
[0m02:09:39.938640 [debug] [MainThread]: Command `dbt run` succeeded at 02:09:39.938527 after 9.50 seconds
[0m02:09:39.939025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6c87b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff941883e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6a16cf0>]}
[0m02:09:39.939383 [debug] [MainThread]: Flushing usage events
[0m02:09:43.557747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb46fa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7b967e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb87e43b0>]}


============================== 02:09:43.563479 | fcb8fe32-ce29-4859-a979-34635276ebb3 ==============================
[0m02:09:43.563479 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:09:43.564328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:09:44.267081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcb8fe32-ce29-4859-a979-34635276ebb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb912bfe0>]}
[0m02:09:44.301399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcb8fe32-ce29-4859-a979-34635276ebb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93db39e0>]}
[0m02:09:44.302119 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:09:44.371890 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:09:44.471895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:09:44.472352 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:09:44.509209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcb8fe32-ce29-4859-a979-34635276ebb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9249e690>]}
[0m02:09:44.602804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcb8fe32-ce29-4859-a979-34635276ebb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff920adfd0>]}
[0m02:09:44.603312 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m02:09:44.603916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcb8fe32-ce29-4859-a979-34635276ebb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9249e030>]}
[0m02:09:44.605454 [info ] [MainThread]: 
[0m02:09:44.606057 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:09:44.609428 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_SNAP'
[0m02:09:44.617456 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT'
[0m02:09:44.625324 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m02:09:44.625760 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m02:09:44.626105 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m02:09:44.626443 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m02:09:44.626783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:09:44.627090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:09:45.354519 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.727 seconds
[0m02:09:45.358133 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m02:09:45.398073 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.771 seconds
[0m02:09:45.401761 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m02:09:45.611408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcb8fe32-ce29-4859-a979-34635276ebb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9286e7b0>]}
[0m02:09:45.612510 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m02:09:45.613402 [info ] [MainThread]: 
[0m02:09:45.623262 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m02:09:45.623998 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m02:09:45.624353 [info ] [Thread-1 (]: 1 of 6 START test not_null_int_crypto_features_price_date ...................... [RUN]
[0m02:09:45.624913 [info ] [Thread-2 (]: 2 of 6 START test not_null_int_crypto_features_symbol .......................... [RUN]
[0m02:09:45.625508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_SNAP, now test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6)
[0m02:09:45.625925 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2)
[0m02:09:45.626365 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m02:09:45.626760 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m02:09:45.640042 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m02:09:45.643192 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m02:09:45.644885 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m02:09:45.658064 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m02:09:45.660805 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m02:09:45.662673 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m02:09:45.664601 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m02:09:45.665127 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m02:09:45.665449 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
where price_date is null



      
    ) dbt_internal_test
[0m02:09:45.665863 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
where symbol is null



      
    ) dbt_internal_test
[0m02:09:45.666230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:45.666590 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:09:46.513577 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.847 seconds
[0m02:09:46.514872 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.849 seconds
[0m02:09:46.522690 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2: Close
[0m02:09:46.524480 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6: Close
[0m02:09:46.776822 [info ] [Thread-2 (]: 2 of 6 PASS not_null_int_crypto_features_symbol ................................ [[32mPASS[0m in 1.15s]
[0m02:09:46.777751 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m02:09:46.778278 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m02:09:46.778907 [info ] [Thread-2 (]: 3 of 6 START test not_null_mart_crypto_summary_price_date ...................... [RUN]
[0m02:09:46.779892 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2, now test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b)
[0m02:09:46.780405 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m02:09:46.781156 [info ] [Thread-1 (]: 1 of 6 PASS not_null_int_crypto_features_price_date ............................ [[32mPASS[0m in 1.16s]
[0m02:09:46.785128 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m02:09:46.785764 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m02:09:46.786499 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m02:09:46.786852 [info ] [Thread-1 (]: 4 of 6 START test not_null_mart_crypto_summary_symbol .......................... [RUN]
[0m02:09:46.787408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6, now test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce)
[0m02:09:46.787809 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m02:09:46.788108 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m02:09:46.791235 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m02:09:46.793164 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m02:09:46.794202 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m02:09:46.794761 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m02:09:46.796638 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m02:09:46.797026 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
where price_date is null



      
    ) dbt_internal_test
[0m02:09:46.797560 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:09:46.799487 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m02:09:46.799905 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
where symbol is null



      
    ) dbt_internal_test
[0m02:09:46.800236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:47.415809 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.618 seconds
[0m02:09:47.420312 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b: Close
[0m02:09:47.493733 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.693 seconds
[0m02:09:47.497694 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce: Close
[0m02:09:47.620184 [info ] [Thread-2 (]: 3 of 6 PASS not_null_mart_crypto_summary_price_date ............................ [[32mPASS[0m in 0.84s]
[0m02:09:47.621045 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m02:09:47.621490 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m02:09:47.621893 [info ] [Thread-2 (]: 5 of 6 START test not_null_stg_crypto_prices_price_date ........................ [RUN]
[0m02:09:47.622495 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b, now test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314)
[0m02:09:47.622869 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m02:09:47.626267 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m02:09:47.628086 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m02:09:47.629881 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m02:09:47.631064 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m02:09:47.631511 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
where price_date is null



      
    ) dbt_internal_test
[0m02:09:47.631870 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:09:47.701662 [info ] [Thread-1 (]: 4 of 6 PASS not_null_mart_crypto_summary_symbol ................................ [[32mPASS[0m in 0.91s]
[0m02:09:47.702552 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m02:09:47.703012 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m02:09:47.703378 [info ] [Thread-1 (]: 6 of 6 START test not_null_stg_crypto_prices_symbol ............................ [RUN]
[0m02:09:47.703938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce, now test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a)
[0m02:09:47.704277 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m02:09:47.707621 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m02:09:47.708655 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m02:09:47.710502 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m02:09:47.711616 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m02:09:47.711945 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
where symbol is null



      
    ) dbt_internal_test
[0m02:09:47.712452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:48.383581 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m02:09:48.387454 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a: Close
[0m02:09:48.399699 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.768 seconds
[0m02:09:48.403409 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314: Close
[0m02:09:48.631933 [info ] [Thread-1 (]: 6 of 6 PASS not_null_stg_crypto_prices_symbol .................................. [[32mPASS[0m in 0.93s]
[0m02:09:48.633683 [info ] [Thread-2 (]: 5 of 6 PASS not_null_stg_crypto_prices_price_date .............................. [[32mPASS[0m in 1.01s]
[0m02:09:48.635176 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m02:09:48.635997 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m02:09:48.638422 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:09:48.638939 [debug] [MainThread]: Connection 'test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a' was properly closed.
[0m02:09:48.639325 [debug] [MainThread]: Connection 'test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314' was properly closed.
[0m02:09:48.639856 [info ] [MainThread]: 
[0m02:09:48.640529 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 4.03 seconds (4.03s).
[0m02:09:48.642062 [debug] [MainThread]: Command end result
[0m02:09:48.674933 [info ] [MainThread]: 
[0m02:09:48.675944 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:09:48.676302 [info ] [MainThread]: 
[0m02:09:48.676625 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m02:09:48.677584 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.168977, "process_user_time": 3.69723, "process_kernel_time": 0.221712, "process_mem_max_rss": "214320", "process_out_blocks": "1936", "process_in_blocks": "0"}
[0m02:09:48.678075 [debug] [MainThread]: Command `dbt test` succeeded at 02:09:48.677999 after 5.17 seconds
[0m02:09:48.678500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7e8ed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8cb9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8563440>]}
[0m02:09:48.678951 [debug] [MainThread]: Flushing usage events
[0m02:09:51.638242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98775c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98ca3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9744d520>]}


============================== 02:09:51.643863 | 90cf99a3-87d4-4837-924f-fda3538e0844 ==============================
[0m02:09:51.643863 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:09:51.644631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:09:52.275113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90cf99a3-87d4-4837-924f-fda3538e0844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75903500>]}
[0m02:09:52.309651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90cf99a3-87d4-4837-924f-fda3538e0844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97f26870>]}
[0m02:09:52.310390 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:09:52.378883 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:09:52.477261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:09:52.477687 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:09:52.516486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90cf99a3-87d4-4837-924f-fda3538e0844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75b27bf0>]}
[0m02:09:52.611408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90cf99a3-87d4-4837-924f-fda3538e0844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff757781d0>]}
[0m02:09:52.611957 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m02:09:52.612563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90cf99a3-87d4-4837-924f-fda3538e0844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7599a420>]}
[0m02:09:52.614207 [info ] [MainThread]: 
[0m02:09:52.614787 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:09:52.616108 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m02:09:52.627877 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m02:09:52.628349 [debug] [ThreadPool]: On list_USER_DB_PARROT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
show terse schemas in database USER_DB_PARROT
    limit 10000
[0m02:09:52.628655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:09:53.392334 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.764 seconds
[0m02:09:53.394288 [debug] [ThreadPool]: On list_USER_DB_PARROT: Close
[0m02:09:53.610795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT)
[0m02:09:53.618885 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_SNAP'
[0m02:09:53.624511 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m02:09:53.626996 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m02:09:53.627520 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m02:09:53.627933 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m02:09:53.628305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:09:53.628732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:09:54.305212 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.676 seconds
[0m02:09:54.308833 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m02:09:54.366310 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.738 seconds
[0m02:09:54.369742 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m02:09:54.604515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90cf99a3-87d4-4837-924f-fda3538e0844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74a44b30>]}
[0m02:09:54.605633 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m02:09:54.606208 [info ] [MainThread]: 
[0m02:09:54.617034 [debug] [Thread-1 (]: Began running node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m02:09:54.617973 [info ] [Thread-1 (]: 1 of 1 START snapshot PARROT_SNAP.crypto_prices_snapshot ....................... [RUN]
[0m02:09:54.619298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now snapshot.crypto_analytics_dbt.crypto_prices_snapshot)
[0m02:09:54.619954 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m02:09:54.626525 [debug] [Thread-1 (]: Began executing node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m02:09:54.671859 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:09:54.672477 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m02:09:54.672885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:55.326739 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.654 seconds
[0m02:09:55.368344 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:09:55.369038 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
create or replace temporary table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
    SYMBOL,
    PRICE_DATE,
    OPEN,
    HIGH,
    LOW,
    CLOSE,
    ADJ_CLOSE,
    VOLUME,
    INGESTED_AT
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES


    ),

    snapshotted_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    

        from "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            
  
  coalesce(nullif(INGESTED_AT, INGESTED_AT), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol || to_char(price_date) as varchar ), '')
         || '|' || coalesce(cast(INGESTED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            INGESTED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.INGESTED_AT))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.INGESTED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m02:09:56.802182 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.432 seconds
[0m02:09:56.808627 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:09:56.809378 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m02:09:56.965720 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.156 seconds
[0m02:09:56.970818 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:09:56.971490 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m02:09:57.149653 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.177 seconds
[0m02:09:57.155636 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:09:57.156406 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m02:09:57.307221 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.150 seconds
[0m02:09:57.312689 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:09:57.313338 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m02:09:57.456752 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.143 seconds
[0m02:09:57.468464 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:09:57.469633 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m02:09:57.627782 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.157 seconds
[0m02:09:57.652410 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:09:57.653270 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
select * from (
        

    with snapshot_query as (

        



select
    SYMBOL,
    PRICE_DATE,
    OPEN,
    HIGH,
    LOW,
    CLOSE,
    ADJ_CLOSE,
    VOLUME,
    INGESTED_AT
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES


    ),

    snapshotted_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    

        from "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            
  
  coalesce(nullif(INGESTED_AT, INGESTED_AT), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol || to_char(price_date) as varchar ), '')
         || '|' || coalesce(cast(INGESTED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            INGESTED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.INGESTED_AT))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.INGESTED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m02:09:58.290905 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.637 seconds
[0m02:09:58.298292 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:09:58.299087 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m02:09:58.434897 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.135 seconds
[0m02:09:58.436806 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:09:58.441911 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:09:58.442890 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
BEGIN
[0m02:09:58.666681 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.223 seconds
[0m02:09:58.667830 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:09:58.668480 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
merge into "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "PRICE_DATE", "OPEN", "HIGH", "LOW", "CLOSE", "ADJ_CLOSE", "VOLUME", "INGESTED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "PRICE_DATE", "OPEN", "HIGH", "LOW", "CLOSE", "ADJ_CLOSE", "VOLUME", "INGESTED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m02:09:59.782563 [debug] [Thread-1 (]: SQL status: SUCCESS 1460 in 1.113 seconds
[0m02:09:59.783883 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:09:59.784662 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
COMMIT
[0m02:10:00.282424 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.497 seconds
[0m02:10:00.299567 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: Close
[0m02:10:00.618616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90cf99a3-87d4-4837-924f-fda3538e0844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75aadcd0>]}
[0m02:10:00.619807 [info ] [Thread-1 (]: 1 of 1 OK snapshotted PARROT_SNAP.crypto_prices_snapshot ....................... [[32mSUCCESS 1460[0m in 6.00s]
[0m02:10:00.620989 [debug] [Thread-1 (]: Finished running node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m02:10:00.622843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:10:00.623265 [debug] [MainThread]: Connection 'snapshot.crypto_analytics_dbt.crypto_prices_snapshot' was properly closed.
[0m02:10:00.623572 [debug] [MainThread]: Connection 'list_USER_DB_PARROT_PARROT_SNAP' was properly closed.
[0m02:10:00.623915 [info ] [MainThread]: 
[0m02:10:00.624474 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 8.01 seconds (8.01s).
[0m02:10:00.625320 [debug] [MainThread]: Command end result
[0m02:10:00.658553 [info ] [MainThread]: 
[0m02:10:00.659491 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:10:00.659951 [info ] [MainThread]: 
[0m02:10:00.660372 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:10:00.661515 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 9.056672, "process_user_time": 3.631604, "process_kernel_time": 0.215738, "process_mem_max_rss": "213648", "process_out_blocks": "1920", "process_in_blocks": "0"}
[0m02:10:00.662034 [debug] [MainThread]: Command `dbt snapshot` succeeded at 02:10:00.661953 after 9.06 seconds
[0m02:10:00.662469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99c78a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff755a0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff972e3230>]}
[0m02:10:00.662932 [debug] [MainThread]: Flushing usage events
[0m02:33:47.777872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c348e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd1d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cf5b440>]}


============================== 02:33:47.784017 | 637b1611-8ce8-49dd-9265-2834a56f84e4 ==============================
[0m02:33:47.784017 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:33:47.784623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:33:48.477347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '637b1611-8ce8-49dd-9265-2834a56f84e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c3d7470>]}
[0m02:33:48.512691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '637b1611-8ce8-49dd-9265-2834a56f84e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67a6b020>]}
[0m02:33:48.514058 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:33:48.597162 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:33:48.699313 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:33:48.699768 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:33:48.737141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '637b1611-8ce8-49dd-9265-2834a56f84e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c7ab620>]}
[0m02:33:48.825008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '637b1611-8ce8-49dd-9265-2834a56f84e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66976b40>]}
[0m02:33:48.825659 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m02:33:48.826054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '637b1611-8ce8-49dd-9265-2834a56f84e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c3478c0>]}
[0m02:33:48.827776 [info ] [MainThread]: 
[0m02:33:48.828475 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:33:48.832118 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m02:33:48.844266 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m02:33:48.844687 [debug] [ThreadPool]: On list_USER_DB_PARROT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
show terse schemas in database USER_DB_PARROT
    limit 10000
[0m02:33:48.845000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:33:49.717456 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.872 seconds
[0m02:33:49.720944 [debug] [ThreadPool]: On list_USER_DB_PARROT: Close
[0m02:33:49.971839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now create_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT)
[0m02:33:49.973160 [debug] [ThreadPool]: Creating schema "database: "USER_DB_PARROT"
schema: "PARROT_FEAT_PARROT_FEAT"
"
[0m02:33:49.981090 [debug] [ThreadPool]: Using snowflake connection "create_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m02:33:49.982098 [debug] [ThreadPool]: On create_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "create_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
create schema if not exists USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT
[0m02:33:49.982691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:33:50.595987 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.613 seconds
[0m02:33:50.598665 [debug] [ThreadPool]: On create_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m02:33:50.835190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT)
[0m02:33:50.839043 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_SNAP'
[0m02:33:50.853642 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m02:33:50.854246 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m02:33:50.854558 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m02:33:50.854972 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m02:33:50.855374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:33:50.855779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:33:51.423039 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.567 seconds
[0m02:33:51.426209 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m02:33:51.509789 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.654 seconds
[0m02:33:51.513202 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m02:33:51.738907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '637b1611-8ce8-49dd-9265-2834a56f84e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bfab740>]}
[0m02:33:51.740352 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m02:33:51.741711 [info ] [MainThread]: 
[0m02:33:51.755405 [debug] [Thread-1 (]: Began running node model.crypto_analytics_dbt.stg_crypto_prices
[0m02:33:51.756505 [info ] [Thread-1 (]: 1 of 3 START sql view model PARROT_FEAT_PARROT_FEAT.stg_crypto_prices .......... [RUN]
[0m02:33:51.757586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now model.crypto_analytics_dbt.stg_crypto_prices)
[0m02:33:51.758027 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics_dbt.stg_crypto_prices
[0m02:33:51.765785 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics_dbt.stg_crypto_prices"
[0m02:33:51.768577 [debug] [Thread-1 (]: Began executing node model.crypto_analytics_dbt.stg_crypto_prices
[0m02:33:51.790352 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics_dbt.stg_crypto_prices"
[0m02:33:51.792220 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_analytics_dbt.stg_crypto_prices"
[0m02:33:51.792717 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.stg_crypto_prices"} */
create or replace   view USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
  
   as (
    

select
  upper(symbol)                                      as symbol,
  cast(price_date as date)                           as price_date,
  cast(open as number(38,8))                         as open,
  cast(high as number(38,8))                         as high,
  cast(low as number(38,8))                          as low,
  cast(close as number(38,8))                        as close,
  cast(adj_close as number(38,8))                    as adj_close,
  cast(volume as number(38,8))                       as volume
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES
  );
[0m02:33:51.793089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:33:52.511894 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.718 seconds
[0m02:33:52.536461 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.stg_crypto_prices: Close
[0m02:33:52.788373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '637b1611-8ce8-49dd-9265-2834a56f84e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66dadca0>]}
[0m02:33:52.790093 [info ] [Thread-1 (]: 1 of 3 OK created sql view model PARROT_FEAT_PARROT_FEAT.stg_crypto_prices ..... [[32mSUCCESS 1[0m in 1.03s]
[0m02:33:52.791226 [debug] [Thread-1 (]: Finished running node model.crypto_analytics_dbt.stg_crypto_prices
[0m02:33:52.792927 [debug] [Thread-2 (]: Began running node model.crypto_analytics_dbt.int_crypto_features
[0m02:33:52.793766 [info ] [Thread-2 (]: 2 of 3 START sql table model PARROT_FEAT_PARROT_FEAT.int_crypto_features ....... [RUN]
[0m02:33:52.794811 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_SNAP, now model.crypto_analytics_dbt.int_crypto_features)
[0m02:33:52.795458 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics_dbt.int_crypto_features
[0m02:33:52.802093 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics_dbt.int_crypto_features"
[0m02:33:52.805013 [debug] [Thread-2 (]: Began executing node model.crypto_analytics_dbt.int_crypto_features
[0m02:33:52.821474 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics_dbt.int_crypto_features"
[0m02:33:52.823078 [debug] [Thread-2 (]: Using snowflake connection "model.crypto_analytics_dbt.int_crypto_features"
[0m02:33:52.823440 [debug] [Thread-2 (]: On model.crypto_analytics_dbt.int_crypto_features: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.int_crypto_features"} */
create or replace transient table USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
         as
        (

with base as (
  select *
  from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
)
select
  symbol,
  price_date,
  close,
  avg(close) over (partition by symbol order by price_date rows between 4 preceding and current row)  as sma_5,
  avg(close) over (partition by symbol order by price_date rows between 19 preceding and current row) as sma_20,
  avg(close) over (partition by symbol order by price_date rows between 49 preceding and current row) as sma_50,
  (close / nullif(lag(close,5) over (partition by symbol order by price_date),0) - 1) * 100 as momentum_5d_pct
from base
        );
[0m02:33:52.823781 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:33:54.586381 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.762 seconds
[0m02:33:54.590766 [debug] [Thread-2 (]: On model.crypto_analytics_dbt.int_crypto_features: Close
[0m02:33:54.957150 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '637b1611-8ce8-49dd-9265-2834a56f84e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65e0a3f0>]}
[0m02:33:54.958194 [info ] [Thread-2 (]: 2 of 3 OK created sql table model PARROT_FEAT_PARROT_FEAT.int_crypto_features .. [[32mSUCCESS 1[0m in 2.16s]
[0m02:33:54.959386 [debug] [Thread-2 (]: Finished running node model.crypto_analytics_dbt.int_crypto_features
[0m02:33:54.960699 [debug] [Thread-1 (]: Began running node model.crypto_analytics_dbt.mart_crypto_summary
[0m02:33:54.961203 [info ] [Thread-1 (]: 3 of 3 START sql table model PARROT_FEAT_PARROT_FEAT.mart_crypto_summary ....... [RUN]
[0m02:33:54.961948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics_dbt.stg_crypto_prices, now model.crypto_analytics_dbt.mart_crypto_summary)
[0m02:33:54.962345 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics_dbt.mart_crypto_summary
[0m02:33:54.965795 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics_dbt.mart_crypto_summary"
[0m02:33:54.966928 [debug] [Thread-1 (]: Began executing node model.crypto_analytics_dbt.mart_crypto_summary
[0m02:33:54.969041 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics_dbt.mart_crypto_summary"
[0m02:33:54.970278 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_analytics_dbt.mart_crypto_summary"
[0m02:33:54.970602 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.mart_crypto_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.mart_crypto_summary"} */
create or replace transient table USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
         as
        (

select
  symbol,
  price_date,
  close,
  sma_5,
  sma_20,
  sma_50,
  momentum_5d_pct,
  case when sma_5 > sma_20 then 1 else 0 end as bull_signal_cross
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
order by price_date, symbol
        );
[0m02:33:54.970921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:33:56.223041 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.252 seconds
[0m02:33:56.226470 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.mart_crypto_summary: Close
[0m02:33:56.474012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '637b1611-8ce8-49dd-9265-2834a56f84e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65e0a570>]}
[0m02:33:56.475132 [info ] [Thread-1 (]: 3 of 3 OK created sql table model PARROT_FEAT_PARROT_FEAT.mart_crypto_summary .. [[32mSUCCESS 1[0m in 1.51s]
[0m02:33:56.476162 [debug] [Thread-1 (]: Finished running node model.crypto_analytics_dbt.mart_crypto_summary
[0m02:33:56.477690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:33:56.478151 [debug] [MainThread]: Connection 'model.crypto_analytics_dbt.mart_crypto_summary' was properly closed.
[0m02:33:56.478458 [debug] [MainThread]: Connection 'model.crypto_analytics_dbt.int_crypto_features' was properly closed.
[0m02:33:56.478974 [info ] [MainThread]: 
[0m02:33:56.479605 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 7.65 seconds (7.65s).
[0m02:33:56.481009 [debug] [MainThread]: Command end result
[0m02:33:56.514158 [info ] [MainThread]: 
[0m02:33:56.514913 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:33:56.515319 [info ] [MainThread]: 
[0m02:33:56.515638 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m02:33:56.516907 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.773634, "process_user_time": 3.68655, "process_kernel_time": 0.286207, "process_mem_max_rss": "213100", "process_out_blocks": "1923", "process_in_blocks": "0"}
[0m02:33:56.517369 [debug] [MainThread]: Command `dbt run` succeeded at 02:33:56.517287 after 8.77 seconds
[0m02:33:56.517847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd1d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf6f2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67c933e0>]}
[0m02:33:56.518273 [debug] [MainThread]: Flushing usage events
[0m02:33:59.780272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff841981d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84199790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81525280>]}


============================== 02:33:59.786463 | 4af0266a-e910-460e-87c0-2fecbfae4783 ==============================
[0m02:33:59.786463 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:33:59.787441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:34:00.419037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4af0266a-e910-460e-87c0-2fecbfae4783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60334680>]}
[0m02:34:00.453698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4af0266a-e910-460e-87c0-2fecbfae4783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff614e7d70>]}
[0m02:34:00.454446 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:34:00.523381 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:34:00.625753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:34:00.626251 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:34:00.664789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4af0266a-e910-460e-87c0-2fecbfae4783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5be263f0>]}
[0m02:34:00.761488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4af0266a-e910-460e-87c0-2fecbfae4783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ba5a1b0>]}
[0m02:34:00.762064 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m02:34:00.762732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4af0266a-e910-460e-87c0-2fecbfae4783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5be26bd0>]}
[0m02:34:00.764500 [info ] [MainThread]: 
[0m02:34:00.765241 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:34:00.768929 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT'
[0m02:34:00.778026 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_SNAP'
[0m02:34:00.782892 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m02:34:00.784699 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m02:34:00.785181 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m02:34:00.785568 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m02:34:00.785931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:34:00.786261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:34:01.718637 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.933 seconds
[0m02:34:01.720919 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m02:34:01.729373 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.943 seconds
[0m02:34:01.731040 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m02:34:02.037400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4af0266a-e910-460e-87c0-2fecbfae4783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82b9d010>]}
[0m02:34:02.038626 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m02:34:02.040063 [info ] [MainThread]: 
[0m02:34:02.059595 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m02:34:02.060941 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m02:34:02.061390 [info ] [Thread-1 (]: 1 of 6 START test not_null_int_crypto_features_price_date ...................... [RUN]
[0m02:34:02.062187 [info ] [Thread-2 (]: 2 of 6 START test not_null_int_crypto_features_symbol .......................... [RUN]
[0m02:34:02.062895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_SNAP, now test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6)
[0m02:34:02.063350 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2)
[0m02:34:02.063858 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m02:34:02.064331 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m02:34:02.090968 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m02:34:02.092345 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m02:34:02.094336 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m02:34:02.094851 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m02:34:02.119541 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m02:34:02.122860 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m02:34:02.125157 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m02:34:02.125837 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m02:34:02.126206 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
where symbol is null



      
    ) dbt_internal_test
[0m02:34:02.126655 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
where price_date is null



      
    ) dbt_internal_test
[0m02:34:02.127147 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:34:02.127520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:34:02.788720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.661 seconds
[0m02:34:02.801064 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6: Close
[0m02:34:02.908369 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.781 seconds
[0m02:34:02.912352 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2: Close
[0m02:34:02.985472 [info ] [Thread-1 (]: 1 of 6 PASS not_null_int_crypto_features_price_date ............................ [[32mPASS[0m in 0.92s]
[0m02:34:02.986633 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m02:34:02.987162 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m02:34:02.987615 [info ] [Thread-1 (]: 3 of 6 START test not_null_mart_crypto_summary_price_date ...................... [RUN]
[0m02:34:02.988278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6, now test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b)
[0m02:34:02.988644 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m02:34:02.992559 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m02:34:02.993730 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m02:34:02.995588 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m02:34:02.996700 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m02:34:02.997015 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
where price_date is null



      
    ) dbt_internal_test
[0m02:34:02.997293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:34:03.120077 [info ] [Thread-2 (]: 2 of 6 PASS not_null_int_crypto_features_symbol ................................ [[32mPASS[0m in 1.06s]
[0m02:34:03.121063 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m02:34:03.121524 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m02:34:03.121970 [info ] [Thread-2 (]: 4 of 6 START test not_null_mart_crypto_summary_symbol .......................... [RUN]
[0m02:34:03.122923 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2, now test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce)
[0m02:34:03.123856 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m02:34:03.128397 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m02:34:03.129641 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m02:34:03.131690 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m02:34:03.132849 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m02:34:03.133179 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
where symbol is null



      
    ) dbt_internal_test
[0m02:34:03.133471 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:34:03.709408 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.712 seconds
[0m02:34:03.713166 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b: Close
[0m02:34:03.772895 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m02:34:03.775957 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce: Close
[0m02:34:03.943480 [info ] [Thread-1 (]: 3 of 6 PASS not_null_mart_crypto_summary_price_date ............................ [[32mPASS[0m in 0.95s]
[0m02:34:03.945182 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m02:34:03.945937 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m02:34:03.946537 [info ] [Thread-1 (]: 5 of 6 START test not_null_stg_crypto_prices_price_date ........................ [RUN]
[0m02:34:03.947518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b, now test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314)
[0m02:34:03.948253 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m02:34:03.955530 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m02:34:03.958790 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m02:34:03.961961 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m02:34:03.963402 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m02:34:03.963808 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
where price_date is null



      
    ) dbt_internal_test
[0m02:34:03.964240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:34:04.033195 [info ] [Thread-2 (]: 4 of 6 PASS not_null_mart_crypto_summary_symbol ................................ [[32mPASS[0m in 0.91s]
[0m02:34:04.034433 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m02:34:04.034856 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m02:34:04.035294 [info ] [Thread-2 (]: 6 of 6 START test not_null_stg_crypto_prices_symbol ............................ [RUN]
[0m02:34:04.036072 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce, now test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a)
[0m02:34:04.036590 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m02:34:04.040857 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m02:34:04.042363 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m02:34:04.046200 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m02:34:04.047231 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m02:34:04.047551 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
where symbol is null



      
    ) dbt_internal_test
[0m02:34:04.047859 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:34:04.869582 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.821 seconds
[0m02:34:04.873280 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a: Close
[0m02:34:05.036092 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.071 seconds
[0m02:34:05.039443 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314: Close
[0m02:34:05.136936 [info ] [Thread-2 (]: 6 of 6 PASS not_null_stg_crypto_prices_symbol .................................. [[32mPASS[0m in 1.10s]
[0m02:34:05.138027 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m02:34:05.337059 [info ] [Thread-1 (]: 5 of 6 PASS not_null_stg_crypto_prices_price_date .............................. [[32mPASS[0m in 1.39s]
[0m02:34:05.338926 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m02:34:05.341373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:34:05.342046 [debug] [MainThread]: Connection 'test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a' was properly closed.
[0m02:34:05.342524 [debug] [MainThread]: Connection 'test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314' was properly closed.
[0m02:34:05.343256 [info ] [MainThread]: 
[0m02:34:05.344121 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 4.58 seconds (4.58s).
[0m02:34:05.345630 [debug] [MainThread]: Command end result
[0m02:34:05.381387 [info ] [MainThread]: 
[0m02:34:05.382233 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:34:05.382587 [info ] [MainThread]: 
[0m02:34:05.382928 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m02:34:05.383840 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.636655, "process_user_time": 3.707869, "process_kernel_time": 0.198346, "process_mem_max_rss": "214176", "process_out_blocks": "1936", "process_in_blocks": "0"}
[0m02:34:05.384297 [debug] [MainThread]: Command `dbt test` succeeded at 02:34:05.384219 after 5.64 seconds
[0m02:34:05.384650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82140920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6009b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81940a40>]}
[0m02:34:05.384979 [debug] [MainThread]: Flushing usage events
[0m02:34:08.853864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cc237a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c1acbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c0b85f0>]}


============================== 02:34:08.859724 | ac8e9d55-4057-4cc0-b816-aee81418050e ==============================
[0m02:34:08.859724 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:34:08.860655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:34:09.493929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac8e9d55-4057-4cc0-b816-aee81418050e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff677922d0>]}
[0m02:34:09.527823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac8e9d55-4057-4cc0-b816-aee81418050e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66ba29f0>]}
[0m02:34:09.528581 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:34:09.597177 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:34:09.692757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:34:09.693222 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:34:09.731354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac8e9d55-4057-4cc0-b816-aee81418050e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6666e180>]}
[0m02:34:09.825093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac8e9d55-4057-4cc0-b816-aee81418050e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66795130>]}
[0m02:34:09.825822 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m02:34:09.826537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac8e9d55-4057-4cc0-b816-aee81418050e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66992060>]}
[0m02:34:09.828375 [info ] [MainThread]: 
[0m02:34:09.829063 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:34:09.830084 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m02:34:09.842751 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m02:34:09.843239 [debug] [ThreadPool]: On list_USER_DB_PARROT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
show terse schemas in database USER_DB_PARROT
    limit 10000
[0m02:34:09.843568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:34:11.487132 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.643 seconds
[0m02:34:11.489071 [debug] [ThreadPool]: On list_USER_DB_PARROT: Close
[0m02:34:11.693576 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT)
[0m02:34:11.695053 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_SNAP'
[0m02:34:11.706955 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m02:34:11.709825 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m02:34:11.710464 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m02:34:11.710946 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m02:34:11.711377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:34:11.711754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:34:12.326164 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.615 seconds
[0m02:34:12.330172 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m02:34:12.368750 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.657 seconds
[0m02:34:12.372405 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m02:34:12.595002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac8e9d55-4057-4cc0-b816-aee81418050e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d709760>]}
[0m02:34:12.595687 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m02:34:12.596390 [info ] [MainThread]: 
[0m02:34:12.604873 [debug] [Thread-1 (]: Began running node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m02:34:12.605384 [info ] [Thread-1 (]: 1 of 1 START snapshot PARROT_SNAP.crypto_prices_snapshot ....................... [RUN]
[0m02:34:12.605963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_SNAP, now snapshot.crypto_analytics_dbt.crypto_prices_snapshot)
[0m02:34:12.606369 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m02:34:12.612771 [debug] [Thread-1 (]: Began executing node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m02:34:12.650826 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:34:12.651341 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m02:34:12.651710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:34:13.282399 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.630 seconds
[0m02:34:13.322606 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:34:13.323243 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
create or replace temporary table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
    SYMBOL,
    PRICE_DATE,
    OPEN,
    HIGH,
    LOW,
    CLOSE,
    ADJ_CLOSE,
    VOLUME,
    INGESTED_AT
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES


    ),

    snapshotted_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    

        from "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            
  
  coalesce(nullif(INGESTED_AT, INGESTED_AT), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol || to_char(price_date) as varchar ), '')
         || '|' || coalesce(cast(INGESTED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            INGESTED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.INGESTED_AT))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.INGESTED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m02:34:14.577406 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.254 seconds
[0m02:34:14.582571 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:34:14.583522 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m02:34:14.752656 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.168 seconds
[0m02:34:14.759537 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:34:14.760428 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m02:34:14.880635 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.119 seconds
[0m02:34:14.887565 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:34:14.888465 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m02:34:15.038003 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.149 seconds
[0m02:34:15.044783 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:34:15.045709 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m02:34:15.191787 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.145 seconds
[0m02:34:15.200502 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:34:15.201173 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m02:34:15.372065 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.170 seconds
[0m02:34:15.394393 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:34:15.394970 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
select * from (
        

    with snapshot_query as (

        



select
    SYMBOL,
    PRICE_DATE,
    OPEN,
    HIGH,
    LOW,
    CLOSE,
    ADJ_CLOSE,
    VOLUME,
    INGESTED_AT
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES


    ),

    snapshotted_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    

        from "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            
  
  coalesce(nullif(INGESTED_AT, INGESTED_AT), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol || to_char(price_date) as varchar ), '')
         || '|' || coalesce(cast(INGESTED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            INGESTED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.INGESTED_AT))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.INGESTED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m02:34:15.715353 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.320 seconds
[0m02:34:15.723208 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:34:15.723838 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m02:34:15.846945 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.122 seconds
[0m02:34:15.849467 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:34:15.855311 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:34:15.856367 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
BEGIN
[0m02:34:16.031520 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.174 seconds
[0m02:34:16.033093 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:34:16.034122 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
merge into "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "PRICE_DATE", "OPEN", "HIGH", "LOW", "CLOSE", "ADJ_CLOSE", "VOLUME", "INGESTED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "PRICE_DATE", "OPEN", "HIGH", "LOW", "CLOSE", "ADJ_CLOSE", "VOLUME", "INGESTED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m02:34:17.015945 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.981 seconds
[0m02:34:17.016697 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m02:34:17.017094 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
COMMIT
[0m02:34:17.525085 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.507 seconds
[0m02:34:17.549613 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: Close
[0m02:34:17.758217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac8e9d55-4057-4cc0-b816-aee81418050e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66aa5dc0>]}
[0m02:34:17.760088 [info ] [Thread-1 (]: 1 of 1 OK snapshotted PARROT_SNAP.crypto_prices_snapshot ....................... [[32mSUCCESS 0[0m in 5.15s]
[0m02:34:17.761202 [debug] [Thread-1 (]: Finished running node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m02:34:17.764535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:34:17.765140 [debug] [MainThread]: Connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT' was properly closed.
[0m02:34:17.765531 [debug] [MainThread]: Connection 'snapshot.crypto_analytics_dbt.crypto_prices_snapshot' was properly closed.
[0m02:34:17.766080 [info ] [MainThread]: 
[0m02:34:17.766836 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.94 seconds (7.94s).
[0m02:34:17.767787 [debug] [MainThread]: Command end result
[0m02:34:17.801809 [info ] [MainThread]: 
[0m02:34:17.802723 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:34:17.803136 [info ] [MainThread]: 
[0m02:34:17.803445 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:34:17.804819 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.984289, "process_user_time": 3.714707, "process_kernel_time": 0.234966, "process_mem_max_rss": "213672", "process_out_blocks": "1920", "process_in_blocks": "0"}
[0m02:34:17.805333 [debug] [MainThread]: Command `dbt snapshot` succeeded at 02:34:17.805251 after 8.98 seconds
[0m02:34:17.805762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c5126c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c3add00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d432ab0>]}
[0m02:34:17.806103 [debug] [MainThread]: Flushing usage events
[0m18:39:26.757779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cabe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106337c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106337ed0>]}


============================== 18:39:26.762518 | b6d3f30e-f030-4169-a2d3-a77280374881 ==============================
[0m18:39:26.762518 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m18:39:26.762975 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_colors': 'True', 'log_path': '/Users/spartan/Desktop/Airflow/crypto_analytics_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'empty': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'fail_fast': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'profiles_dir': '/Users/spartan/.dbt', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'write_json': 'True', 'introspect': 'True', 'partial_parse': 'True', 'static_parser': 'True'}
[0m18:39:28.352142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6d3f30e-f030-4169-a2d3-a77280374881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046408a0>]}
[0m18:39:28.391444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6d3f30e-f030-4169-a2d3-a77280374881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13089c5a0>]}
[0m18:39:28.392282 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m18:39:28.501751 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m18:39:28.608538 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:39:28.608954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b6d3f30e-f030-4169-a2d3-a77280374881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130883b50>]}
[0m18:39:29.563995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6d3f30e-f030-4169-a2d3-a77280374881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130f2e990>]}
[0m18:39:29.627015 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/spartan/Desktop/Airflow/crypto_analytics_dbt/target/manifest.json
[0m18:39:29.629069 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/spartan/Desktop/Airflow/crypto_analytics_dbt/target/semantic_manifest.json
[0m18:39:29.646725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6d3f30e-f030-4169-a2d3-a77280374881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13142ea50>]}
[0m18:39:29.647117 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 492 macros
[0m18:39:29.647361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6d3f30e-f030-4169-a2d3-a77280374881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130fa14a0>]}
[0m18:39:29.648778 [info ] [MainThread]: 
[0m18:39:29.649030 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:39:29.649208 [info ] [MainThread]: 
[0m18:39:29.649551 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:39:29.652876 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m18:39:29.740524 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m18:39:29.740828 [debug] [ThreadPool]: On list_USER_DB_PARROT: show terse schemas in database USER_DB_PARROT
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
[0m18:39:29.741022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:39:33.030796 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 3.290 seconds
[0m18:39:33.036276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now list_USER_DB_PARROT_PARROT_SNAP)
[0m18:39:33.043258 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT'
[0m18:39:33.053603 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m18:39:33.054201 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m18:39:33.054522 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */;
[0m18:39:33.054773 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: show objects in USER_DB_PARROT.PARROT_SNAP
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */;
[0m18:39:33.054998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:39:33.303183 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.248 seconds
[0m18:39:36.007359 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.952 seconds
[0m18:39:36.012059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6d3f30e-f030-4169-a2d3-a77280374881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1412b6990>]}
[0m18:39:36.016500 [debug] [Thread-1 (]: Began running node model.crypto_analytics_dbt.stg_crypto_prices
[0m18:39:36.017217 [info ] [Thread-1 (]: 1 of 3 START sql view model PARROT_FEAT_PARROT_FEAT.stg_crypto_prices .......... [RUN]
[0m18:39:36.017754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_SNAP, now model.crypto_analytics_dbt.stg_crypto_prices)
[0m18:39:36.018129 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics_dbt.stg_crypto_prices
[0m18:39:36.027496 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics_dbt.stg_crypto_prices"
[0m18:39:36.028753 [debug] [Thread-1 (]: Began executing node model.crypto_analytics_dbt.stg_crypto_prices
[0m18:39:36.059091 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics_dbt.stg_crypto_prices"
[0m18:39:36.060284 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_analytics_dbt.stg_crypto_prices"
[0m18:39:36.060574 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.stg_crypto_prices: create or replace   view USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
  
  
  
  
  as (
    

select
  upper(symbol)                                      as symbol,
  cast(price_date as date)                           as price_date,
  cast(open as number(38,8))                         as open,
  cast(high as number(38,8))                         as high,
  cast(low as number(38,8))                          as low,
  cast(close as number(38,8))                        as close,
  cast(adj_close as number(38,8))                    as adj_close,
  cast(volume as number(38,8))                       as volume
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.stg_crypto_prices"} */;
[0m18:39:36.417192 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.356 seconds
[0m18:39:36.439514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6d3f30e-f030-4169-a2d3-a77280374881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154265860>]}
[0m18:39:36.440057 [info ] [Thread-1 (]: 1 of 3 OK created sql view model PARROT_FEAT_PARROT_FEAT.stg_crypto_prices ..... [[32mSUCCESS 1[0m in 0.42s]
[0m18:39:36.440467 [debug] [Thread-1 (]: Finished running node model.crypto_analytics_dbt.stg_crypto_prices
[0m18:39:36.441054 [debug] [Thread-2 (]: Began running node model.crypto_analytics_dbt.int_crypto_features
[0m18:39:36.441488 [info ] [Thread-2 (]: 2 of 3 START sql table model PARROT_FEAT_PARROT_FEAT.int_crypto_features ....... [RUN]
[0m18:39:36.441848 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now model.crypto_analytics_dbt.int_crypto_features)
[0m18:39:36.442114 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics_dbt.int_crypto_features
[0m18:39:36.444222 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics_dbt.int_crypto_features"
[0m18:39:36.445144 [debug] [Thread-2 (]: Began executing node model.crypto_analytics_dbt.int_crypto_features
[0m18:39:36.463177 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics_dbt.int_crypto_features"
[0m18:39:36.464277 [debug] [Thread-2 (]: Using snowflake connection "model.crypto_analytics_dbt.int_crypto_features"
[0m18:39:36.464556 [debug] [Thread-2 (]: On model.crypto_analytics_dbt.int_crypto_features: create or replace transient table USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
    
    
    
    as (

with base as (
  select *
  from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
)
select
  symbol,
  price_date,
  close,
  avg(close) over (partition by symbol order by price_date rows between 4 preceding and current row)  as sma_5,
  avg(close) over (partition by symbol order by price_date rows between 19 preceding and current row) as sma_20,
  avg(close) over (partition by symbol order by price_date rows between 49 preceding and current row) as sma_50,
  (close / nullif(lag(close,5) over (partition by symbol order by price_date),0) - 1) * 100 as momentum_5d_pct
from base
    )

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.int_crypto_features"} */;
[0m18:39:37.213535 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.749 seconds
[0m18:39:37.216538 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6d3f30e-f030-4169-a2d3-a77280374881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1314f0e10>]}
[0m18:39:37.217255 [info ] [Thread-2 (]: 2 of 3 OK created sql table model PARROT_FEAT_PARROT_FEAT.int_crypto_features .. [[32mSUCCESS 1[0m in 0.77s]
[0m18:39:37.217747 [debug] [Thread-2 (]: Finished running node model.crypto_analytics_dbt.int_crypto_features
[0m18:39:37.218478 [debug] [Thread-1 (]: Began running node model.crypto_analytics_dbt.mart_crypto_summary
[0m18:39:37.219014 [info ] [Thread-1 (]: 3 of 3 START sql table model PARROT_FEAT_PARROT_FEAT.mart_crypto_summary ....... [RUN]
[0m18:39:37.219561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics_dbt.stg_crypto_prices, now model.crypto_analytics_dbt.mart_crypto_summary)
[0m18:39:37.219915 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics_dbt.mart_crypto_summary
[0m18:39:37.223716 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics_dbt.mart_crypto_summary"
[0m18:39:37.225109 [debug] [Thread-1 (]: Began executing node model.crypto_analytics_dbt.mart_crypto_summary
[0m18:39:37.228658 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics_dbt.mart_crypto_summary"
[0m18:39:37.230273 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_analytics_dbt.mart_crypto_summary"
[0m18:39:37.230754 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.mart_crypto_summary: create or replace transient table USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
    
    
    
    as (

select
  symbol,
  price_date,
  close,
  sma_5,
  sma_20,
  sma_50,
  momentum_5d_pct,
  case when sma_5 > sma_20 then 1 else 0 end as bull_signal_cross
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
order by price_date, symbol
    )

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.mart_crypto_summary"} */;
[0m18:39:38.250346 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.019 seconds
[0m18:39:38.253865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6d3f30e-f030-4169-a2d3-a77280374881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1543c36d0>]}
[0m18:39:38.254651 [info ] [Thread-1 (]: 3 of 3 OK created sql table model PARROT_FEAT_PARROT_FEAT.mart_crypto_summary .. [[32mSUCCESS 1[0m in 1.03s]
[0m18:39:38.255218 [debug] [Thread-1 (]: Finished running node model.crypto_analytics_dbt.mart_crypto_summary
[0m18:39:38.256748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:39:38.257120 [debug] [MainThread]: Connection 'model.crypto_analytics_dbt.mart_crypto_summary' was left open.
[0m18:39:38.257415 [debug] [MainThread]: On model.crypto_analytics_dbt.mart_crypto_summary: Close
[0m18:39:38.876534 [debug] [MainThread]: Connection 'model.crypto_analytics_dbt.int_crypto_features' was left open.
[0m18:39:38.877177 [debug] [MainThread]: On model.crypto_analytics_dbt.int_crypto_features: Close
[0m18:39:39.073689 [info ] [MainThread]: 
[0m18:39:39.074299 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 9.42 seconds (9.42s).
[0m18:39:39.075363 [debug] [MainThread]: Command end result
[0m18:39:39.095287 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/spartan/Desktop/Airflow/crypto_analytics_dbt/target/manifest.json
[0m18:39:39.096921 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/spartan/Desktop/Airflow/crypto_analytics_dbt/target/semantic_manifest.json
[0m18:39:39.101776 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/spartan/Desktop/Airflow/crypto_analytics_dbt/target/run_results.json
[0m18:39:39.102106 [info ] [MainThread]: 
[0m18:39:39.102410 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:39:39.102617 [info ] [MainThread]: 
[0m18:39:39.102848 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m18:39:39.112673 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.412028, "process_in_blocks": "0", "process_kernel_time": 1.647199, "process_mem_max_rss": "254558208", "process_out_blocks": "0", "process_user_time": 4.712811}
[0m18:39:39.113137 [debug] [MainThread]: Command `dbt run` succeeded at 18:39:39.113057 after 12.41 seconds
[0m18:39:39.113413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106394ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1009631c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1542c3a10>]}
[0m18:39:39.113688 [debug] [MainThread]: Flushing usage events
[0m18:39:39.816888 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:53:55.519243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c0962a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e4b8b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c094350>]}


============================== 06:53:55.525478 | 58ab3fd4-86b4-4d4d-9c92-41b3b50bcc54 ==============================
[0m06:53:55.525478 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:53:55.525962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:53:56.235232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58ab3fd4-86b4-4d4d-9c92-41b3b50bcc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7716fdd0>]}
[0m06:53:56.270461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58ab3fd4-86b4-4d4d-9c92-41b3b50bcc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bc971d0>]}
[0m06:53:56.271219 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m06:53:56.342355 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:53:56.434774 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m06:53:56.435372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '58ab3fd4-86b4-4d4d-9c92-41b3b50bcc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75f4e300>]}
[0m06:53:57.137985 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:53:57.138609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '58ab3fd4-86b4-4d4d-9c92-41b3b50bcc54', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75d40740>]}
[0m06:53:57.387945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58ab3fd4-86b4-4d4d-9c92-41b3b50bcc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75d13fe0>]}
[0m06:53:57.481232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58ab3fd4-86b4-4d4d-9c92-41b3b50bcc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75f03860>]}
[0m06:53:57.481846 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m06:53:57.482177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58ab3fd4-86b4-4d4d-9c92-41b3b50bcc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75d72cc0>]}
[0m06:53:57.483670 [info ] [MainThread]: 
[0m06:53:57.484164 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:53:57.487676 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m06:53:57.497956 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m06:53:57.498362 [debug] [ThreadPool]: On list_USER_DB_PARROT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
show terse schemas in database USER_DB_PARROT
    limit 10000
[0m06:53:57.498678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:53:58.094346 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.596 seconds
[0m06:53:58.096404 [debug] [ThreadPool]: On list_USER_DB_PARROT: Close
[0m06:53:58.279904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT)
[0m06:53:58.281091 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_SNAP'
[0m06:53:58.291976 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m06:53:58.294319 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m06:53:58.294845 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m06:53:58.295390 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m06:53:58.295947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:53:58.296355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:53:58.783895 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.488 seconds
[0m06:53:58.785546 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m06:53:58.845019 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.549 seconds
[0m06:53:58.846754 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m06:53:59.552453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58ab3fd4-86b4-4d4d-9c92-41b3b50bcc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ceb9070>]}
[0m06:53:59.553401 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m06:53:59.553864 [info ] [MainThread]: 
[0m06:53:59.563065 [debug] [Thread-1 (]: Began running node model.crypto_analytics_dbt.stg_crypto_prices
[0m06:53:59.563792 [info ] [Thread-1 (]: 1 of 3 START sql view model PARROT_FEAT_PARROT_FEAT.stg_crypto_prices .......... [RUN]
[0m06:53:59.564359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_SNAP, now model.crypto_analytics_dbt.stg_crypto_prices)
[0m06:53:59.564732 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics_dbt.stg_crypto_prices
[0m06:53:59.571213 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics_dbt.stg_crypto_prices"
[0m06:53:59.573038 [debug] [Thread-1 (]: Began executing node model.crypto_analytics_dbt.stg_crypto_prices
[0m06:53:59.594847 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics_dbt.stg_crypto_prices"
[0m06:53:59.596944 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_analytics_dbt.stg_crypto_prices"
[0m06:53:59.597350 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.stg_crypto_prices"} */
create or replace   view USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
  
   as (
    

select
  upper(symbol)                                      as symbol,
  cast(price_date as date)                           as price_date,
  cast(open as number(38,8))                         as open,
  cast(high as number(38,8))                         as high,
  cast(low as number(38,8))                          as low,
  cast(close as number(38,8))                        as close,
  cast(adj_close as number(38,8))                    as adj_close,
  cast(volume as number(38,8))                       as volume
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES
  );
[0m06:53:59.597694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:00.241138 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.643 seconds
[0m06:54:00.262334 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.stg_crypto_prices: Close
[0m06:54:00.473273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58ab3fd4-86b4-4d4d-9c92-41b3b50bcc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76252000>]}
[0m06:54:00.474335 [info ] [Thread-1 (]: 1 of 3 OK created sql view model PARROT_FEAT_PARROT_FEAT.stg_crypto_prices ..... [[32mSUCCESS 1[0m in 0.91s]
[0m06:54:00.475054 [debug] [Thread-1 (]: Finished running node model.crypto_analytics_dbt.stg_crypto_prices
[0m06:54:00.476095 [debug] [Thread-2 (]: Began running node model.crypto_analytics_dbt.int_crypto_features
[0m06:54:00.476594 [info ] [Thread-2 (]: 2 of 3 START sql table model PARROT_FEAT_PARROT_FEAT.int_crypto_features ....... [RUN]
[0m06:54:00.477055 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now model.crypto_analytics_dbt.int_crypto_features)
[0m06:54:00.477393 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics_dbt.int_crypto_features
[0m06:54:00.480334 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics_dbt.int_crypto_features"
[0m06:54:00.482466 [debug] [Thread-2 (]: Began executing node model.crypto_analytics_dbt.int_crypto_features
[0m06:54:00.499913 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics_dbt.int_crypto_features"
[0m06:54:00.501589 [debug] [Thread-2 (]: Using snowflake connection "model.crypto_analytics_dbt.int_crypto_features"
[0m06:54:00.501949 [debug] [Thread-2 (]: On model.crypto_analytics_dbt.int_crypto_features: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.int_crypto_features"} */
create or replace transient table USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
         as
        (

with base as (
  select *
  from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
)
select
  symbol,
  price_date,
  close,
  avg(close) over (partition by symbol order by price_date rows between 4 preceding and current row)  as sma_5,
  avg(close) over (partition by symbol order by price_date rows between 19 preceding and current row) as sma_20,
  avg(close) over (partition by symbol order by price_date rows between 49 preceding and current row) as sma_50,
  (close / nullif(lag(close,5) over (partition by symbol order by price_date),0) - 1) * 100 as momentum_5d_pct
from base
        );
[0m06:54:00.502367 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:54:02.056117 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.553 seconds
[0m06:54:02.061335 [debug] [Thread-2 (]: On model.crypto_analytics_dbt.int_crypto_features: Close
[0m06:54:02.276442 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58ab3fd4-86b4-4d4d-9c92-41b3b50bcc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74437f80>]}
[0m06:54:02.277994 [info ] [Thread-2 (]: 2 of 3 OK created sql table model PARROT_FEAT_PARROT_FEAT.int_crypto_features .. [[32mSUCCESS 1[0m in 1.80s]
[0m06:54:02.279100 [debug] [Thread-2 (]: Finished running node model.crypto_analytics_dbt.int_crypto_features
[0m06:54:02.280803 [debug] [Thread-1 (]: Began running node model.crypto_analytics_dbt.mart_crypto_summary
[0m06:54:02.281576 [info ] [Thread-1 (]: 3 of 3 START sql table model PARROT_FEAT_PARROT_FEAT.mart_crypto_summary ....... [RUN]
[0m06:54:02.282355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics_dbt.stg_crypto_prices, now model.crypto_analytics_dbt.mart_crypto_summary)
[0m06:54:02.282921 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics_dbt.mart_crypto_summary
[0m06:54:02.287873 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics_dbt.mart_crypto_summary"
[0m06:54:02.290263 [debug] [Thread-1 (]: Began executing node model.crypto_analytics_dbt.mart_crypto_summary
[0m06:54:02.293799 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics_dbt.mart_crypto_summary"
[0m06:54:02.295718 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_analytics_dbt.mart_crypto_summary"
[0m06:54:02.296177 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.mart_crypto_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.mart_crypto_summary"} */
create or replace transient table USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
         as
        (

select
  symbol,
  price_date,
  close,
  sma_5,
  sma_20,
  sma_50,
  momentum_5d_pct,
  case when sma_5 > sma_20 then 1 else 0 end as bull_signal_cross
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
order by price_date, symbol
        );
[0m06:54:02.296661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:03.692210 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.395 seconds
[0m06:54:03.695173 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.mart_crypto_summary: Close
[0m06:54:03.882710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58ab3fd4-86b4-4d4d-9c92-41b3b50bcc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74494e30>]}
[0m06:54:03.883631 [info ] [Thread-1 (]: 3 of 3 OK created sql table model PARROT_FEAT_PARROT_FEAT.mart_crypto_summary .. [[32mSUCCESS 1[0m in 1.60s]
[0m06:54:03.884279 [debug] [Thread-1 (]: Finished running node model.crypto_analytics_dbt.mart_crypto_summary
[0m06:54:03.885998 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:54:03.886518 [debug] [MainThread]: Connection 'model.crypto_analytics_dbt.int_crypto_features' was properly closed.
[0m06:54:03.886897 [debug] [MainThread]: Connection 'model.crypto_analytics_dbt.mart_crypto_summary' was properly closed.
[0m06:54:03.887460 [info ] [MainThread]: 
[0m06:54:03.887863 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 6.40 seconds (6.40s).
[0m06:54:03.888798 [debug] [MainThread]: Command end result
[0m06:54:03.920441 [info ] [MainThread]: 
[0m06:54:03.920916 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:54:03.921207 [info ] [MainThread]: 
[0m06:54:03.921507 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:54:03.922567 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.43849, "process_user_time": 4.479667, "process_kernel_time": 0.324965, "process_mem_max_rss": "218284", "process_out_blocks": "2847", "process_in_blocks": "0"}
[0m06:54:03.923035 [debug] [MainThread]: Command `dbt run` succeeded at 06:54:03.922966 after 8.44 seconds
[0m06:54:03.923406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e4b8b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c0cbe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b92fe30>]}
[0m06:54:03.923730 [debug] [MainThread]: Flushing usage events
[0m06:54:07.384784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9c816d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba2451f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9c803e0>]}


============================== 06:54:07.390829 | d8d7604e-674b-456d-9012-640847202c08 ==============================
[0m06:54:07.390829 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:54:07.391349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m06:54:08.010942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8d7604e-674b-456d-9012-640847202c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aba9730>]}
[0m06:54:08.045616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8d7604e-674b-456d-9012-640847202c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff991e8da0>]}
[0m06:54:08.046346 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m06:54:08.114613 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:54:08.215926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:54:08.216429 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:54:08.253097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8d7604e-674b-456d-9012-640847202c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93ff1850>]}
[0m06:54:08.346773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8d7604e-674b-456d-9012-640847202c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d1dbb0>]}
[0m06:54:08.347399 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m06:54:08.347731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8d7604e-674b-456d-9012-640847202c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93e50800>]}
[0m06:54:08.349517 [info ] [MainThread]: 
[0m06:54:08.350079 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:54:08.353715 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT'
[0m06:54:08.362213 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_SNAP'
[0m06:54:08.367681 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m06:54:08.369523 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m06:54:08.370131 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m06:54:08.370549 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m06:54:08.370956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:54:08.371292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:54:08.998055 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.627 seconds
[0m06:54:09.001432 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m06:54:09.052718 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.681 seconds
[0m06:54:09.056238 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m06:54:09.363105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8d7604e-674b-456d-9012-640847202c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a3779e0>]}
[0m06:54:09.364089 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m06:54:09.364592 [info ] [MainThread]: 
[0m06:54:09.374235 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m06:54:09.375052 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m06:54:09.375515 [info ] [Thread-1 (]: 1 of 6 START test not_null_int_crypto_features_price_date ...................... [RUN]
[0m06:54:09.376131 [info ] [Thread-2 (]: 2 of 6 START test not_null_int_crypto_features_symbol .......................... [RUN]
[0m06:54:09.377142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6)
[0m06:54:09.377738 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_SNAP, now test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2)
[0m06:54:09.378193 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m06:54:09.378649 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m06:54:09.396141 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m06:54:09.397277 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m06:54:09.398714 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m06:54:09.399068 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m06:54:09.416717 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m06:54:09.418051 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m06:54:09.419917 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m06:54:09.420472 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m06:54:09.420791 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
where symbol is null



      
    ) dbt_internal_test
[0m06:54:09.421180 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
where price_date is null



      
    ) dbt_internal_test
[0m06:54:09.421570 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:54:09.421909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:09.956092 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.534 seconds
[0m06:54:09.967447 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6: Close
[0m06:54:09.989935 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.568 seconds
[0m06:54:09.993919 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2: Close
[0m06:54:10.176665 [info ] [Thread-1 (]: 1 of 6 PASS not_null_int_crypto_features_price_date ............................ [[32mPASS[0m in 0.80s]
[0m06:54:10.178263 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m06:54:10.178994 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m06:54:10.179615 [info ] [Thread-1 (]: 3 of 6 START test not_null_mart_crypto_summary_price_date ...................... [RUN]
[0m06:54:10.180221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6, now test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b)
[0m06:54:10.180734 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m06:54:10.187634 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m06:54:10.189262 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m06:54:10.192289 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m06:54:10.193916 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m06:54:10.194417 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
where price_date is null



      
    ) dbt_internal_test
[0m06:54:10.194922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:10.199060 [info ] [Thread-2 (]: 2 of 6 PASS not_null_int_crypto_features_symbol ................................ [[32mPASS[0m in 0.82s]
[0m06:54:10.199871 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m06:54:10.200315 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m06:54:10.200720 [info ] [Thread-2 (]: 4 of 6 START test not_null_mart_crypto_summary_symbol .......................... [RUN]
[0m06:54:10.201150 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2, now test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce)
[0m06:54:10.201488 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m06:54:10.205451 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m06:54:10.206584 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m06:54:10.208549 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m06:54:10.209537 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m06:54:10.209839 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
where symbol is null



      
    ) dbt_internal_test
[0m06:54:10.210149 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:54:10.980366 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.770 seconds
[0m06:54:10.984443 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce: Close
[0m06:54:10.988184 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.793 seconds
[0m06:54:10.990786 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b: Close
[0m06:54:11.203388 [info ] [Thread-2 (]: 4 of 6 PASS not_null_mart_crypto_summary_symbol ................................ [[32mPASS[0m in 1.00s]
[0m06:54:11.204918 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m06:54:11.205674 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m06:54:11.206380 [info ] [Thread-2 (]: 5 of 6 START test not_null_stg_crypto_prices_price_date ........................ [RUN]
[0m06:54:11.207161 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce, now test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314)
[0m06:54:11.207778 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m06:54:11.214196 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m06:54:11.217163 [info ] [Thread-1 (]: 3 of 6 PASS not_null_mart_crypto_summary_price_date ............................ [[32mPASS[0m in 1.04s]
[0m06:54:11.218251 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m06:54:11.219349 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m06:54:11.219817 [info ] [Thread-1 (]: 6 of 6 START test not_null_stg_crypto_prices_symbol ............................ [RUN]
[0m06:54:11.220408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b, now test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a)
[0m06:54:11.220892 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m06:54:11.221249 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m06:54:11.223983 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m06:54:11.227499 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m06:54:11.228762 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m06:54:11.229109 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m06:54:11.229408 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
where price_date is null



      
    ) dbt_internal_test
[0m06:54:11.233182 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m06:54:11.233636 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:54:11.235925 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m06:54:11.236372 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
where symbol is null



      
    ) dbt_internal_test
[0m06:54:11.236833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:12.256160 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.019 seconds
[0m06:54:12.257573 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.024 seconds
[0m06:54:12.261220 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a: Close
[0m06:54:12.263670 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314: Close
[0m06:54:12.456874 [info ] [Thread-1 (]: 6 of 6 PASS not_null_stg_crypto_prices_symbol .................................. [[32mPASS[0m in 1.24s]
[0m06:54:12.458246 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m06:54:12.476544 [info ] [Thread-2 (]: 5 of 6 PASS not_null_stg_crypto_prices_price_date .............................. [[32mPASS[0m in 1.27s]
[0m06:54:12.477899 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m06:54:12.480386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:54:12.480922 [debug] [MainThread]: Connection 'test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a' was properly closed.
[0m06:54:12.481330 [debug] [MainThread]: Connection 'test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314' was properly closed.
[0m06:54:12.481836 [info ] [MainThread]: 
[0m06:54:12.482257 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 4.13 seconds (4.13s).
[0m06:54:12.483564 [debug] [MainThread]: Command end result
[0m06:54:12.516253 [info ] [MainThread]: 
[0m06:54:12.516845 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:54:12.517175 [info ] [MainThread]: 
[0m06:54:12.517526 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:54:12.518536 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.170527, "process_user_time": 3.611132, "process_kernel_time": 0.26853, "process_mem_max_rss": "214368", "process_out_blocks": "1936", "process_in_blocks": "0"}
[0m06:54:12.519033 [debug] [MainThread]: Command `dbt test` succeeded at 06:54:12.518954 after 5.17 seconds
[0m06:54:12.519451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9c816d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9de5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba218c20>]}
[0m06:54:12.519806 [debug] [MainThread]: Flushing usage events
[0m06:54:15.881658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eb2e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dce6780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dce67b0>]}


============================== 06:54:15.887792 | 31692ff2-fc3d-458d-922c-f7bce7bf1672 ==============================
[0m06:54:15.887792 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:54:15.888359 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m06:54:16.579642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31692ff2-fc3d-458d-922c-f7bce7bf1672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5cc07260>]}
[0m06:54:16.615634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31692ff2-fc3d-458d-922c-f7bce7bf1672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d9a2a0>]}
[0m06:54:16.616513 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m06:54:16.688993 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:54:16.795517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:54:16.795986 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:54:16.836670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31692ff2-fc3d-458d-922c-f7bce7bf1672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8d12b0>]}
[0m06:54:16.928110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31692ff2-fc3d-458d-922c-f7bce7bf1672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5c4396d0>]}
[0m06:54:16.928734 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m06:54:16.929162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31692ff2-fc3d-458d-922c-f7bce7bf1672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8d3ef0>]}
[0m06:54:16.930775 [info ] [MainThread]: 
[0m06:54:16.931296 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:54:16.932110 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m06:54:16.950465 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m06:54:16.950994 [debug] [ThreadPool]: On list_USER_DB_PARROT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
show terse schemas in database USER_DB_PARROT
    limit 10000
[0m06:54:16.951363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:54:17.651352 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.700 seconds
[0m06:54:17.653049 [debug] [ThreadPool]: On list_USER_DB_PARROT: Close
[0m06:54:17.818388 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now list_USER_DB_PARROT_PARROT_SNAP)
[0m06:54:17.825181 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT'
[0m06:54:17.827479 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m06:54:17.829597 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m06:54:17.830062 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m06:54:17.830454 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m06:54:17.830903 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:54:17.831276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:54:18.406753 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.575 seconds
[0m06:54:18.409331 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m06:54:18.475757 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.645 seconds
[0m06:54:18.477797 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m06:54:18.696250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31692ff2-fc3d-458d-922c-f7bce7bf1672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5c607530>]}
[0m06:54:18.698102 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m06:54:18.698551 [info ] [MainThread]: 
[0m06:54:18.708198 [debug] [Thread-1 (]: Began running node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m06:54:18.708941 [info ] [Thread-1 (]: 1 of 1 START snapshot PARROT_SNAP.crypto_prices_snapshot ....................... [RUN]
[0m06:54:18.709466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_SNAP, now snapshot.crypto_analytics_dbt.crypto_prices_snapshot)
[0m06:54:18.709879 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m06:54:18.717587 [debug] [Thread-1 (]: Began executing node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m06:54:18.759512 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m06:54:18.760060 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m06:54:18.760412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:19.330578 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.570 seconds
[0m06:54:19.363560 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m06:54:19.364148 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
create or replace temporary table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
    SYMBOL,
    PRICE_DATE,
    OPEN,
    HIGH,
    LOW,
    CLOSE,
    ADJ_CLOSE,
    VOLUME,
    INGESTED_AT
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES


    ),

    snapshotted_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    

        from "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            
  
  coalesce(nullif(INGESTED_AT, INGESTED_AT), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol || to_char(price_date) as varchar ), '')
         || '|' || coalesce(cast(INGESTED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            INGESTED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.INGESTED_AT))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.INGESTED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m06:54:20.652363 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.287 seconds
[0m06:54:20.660599 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m06:54:20.661430 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m06:54:20.789685 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.128 seconds
[0m06:54:20.793190 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m06:54:20.793564 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m06:54:20.929730 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.136 seconds
[0m06:54:20.933559 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m06:54:20.934011 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m06:54:21.081113 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.146 seconds
[0m06:54:21.087446 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m06:54:21.088360 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m06:54:21.264941 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.176 seconds
[0m06:54:21.275527 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m06:54:21.276259 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m06:54:21.412894 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.136 seconds
[0m06:54:21.439310 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m06:54:21.439945 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
select * from (
        

    with snapshot_query as (

        



select
    SYMBOL,
    PRICE_DATE,
    OPEN,
    HIGH,
    LOW,
    CLOSE,
    ADJ_CLOSE,
    VOLUME,
    INGESTED_AT
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES


    ),

    snapshotted_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    

        from "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            
  
  coalesce(nullif(INGESTED_AT, INGESTED_AT), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol || to_char(price_date) as varchar ), '')
         || '|' || coalesce(cast(INGESTED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            INGESTED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.INGESTED_AT))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.INGESTED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m06:54:21.852440 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.412 seconds
[0m06:54:21.859919 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m06:54:21.860611 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m06:54:22.011587 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.150 seconds
[0m06:54:22.013144 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m06:54:22.017246 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m06:54:22.017884 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
BEGIN
[0m06:54:22.193336 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.175 seconds
[0m06:54:22.194716 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m06:54:22.195336 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
merge into "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "PRICE_DATE", "OPEN", "HIGH", "LOW", "CLOSE", "ADJ_CLOSE", "VOLUME", "INGESTED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "PRICE_DATE", "OPEN", "HIGH", "LOW", "CLOSE", "ADJ_CLOSE", "VOLUME", "INGESTED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m06:54:23.313853 [debug] [Thread-1 (]: SQL status: SUCCESS 1458 in 1.117 seconds
[0m06:54:23.315215 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m06:54:23.315865 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
COMMIT
[0m06:54:23.723447 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.407 seconds
[0m06:54:23.747509 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: Close
[0m06:54:23.969688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31692ff2-fc3d-458d-922c-f7bce7bf1672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff57665130>]}
[0m06:54:23.972630 [info ] [Thread-1 (]: 1 of 1 OK snapshotted PARROT_SNAP.crypto_prices_snapshot ....................... [[32mSUCCESS 1458[0m in 5.26s]
[0m06:54:23.975843 [debug] [Thread-1 (]: Finished running node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m06:54:23.989166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:54:23.990913 [debug] [MainThread]: Connection 'snapshot.crypto_analytics_dbt.crypto_prices_snapshot' was properly closed.
[0m06:54:23.991537 [debug] [MainThread]: Connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT' was properly closed.
[0m06:54:23.992705 [info ] [MainThread]: 
[0m06:54:23.993505 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.06 seconds (7.06s).
[0m06:54:23.996438 [debug] [MainThread]: Command end result
[0m06:54:24.061957 [info ] [MainThread]: 
[0m06:54:24.062617 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:54:24.062986 [info ] [MainThread]: 
[0m06:54:24.063341 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:54:24.064861 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.217076, "process_user_time": 3.744372, "process_kernel_time": 0.258371, "process_mem_max_rss": "213364", "process_out_blocks": "1920", "process_in_blocks": "0"}
[0m06:54:24.065428 [debug] [MainThread]: Command `dbt snapshot` succeeded at 06:54:24.065348 after 8.22 seconds
[0m06:54:24.065862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5c2cb230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5c5fc170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8bea20>]}
[0m06:54:24.066217 [debug] [MainThread]: Flushing usage events
[0m01:30:03.530699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fa7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d5bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d5bed0>]}


============================== 01:30:03.535245 | 44c02036-9a88-4dc1-a24e-c768babdeff8 ==============================
[0m01:30:03.535245 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m01:30:03.535709 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt snapshot', 'write_json': 'True', 'target_path': 'None', 'warn_error': 'None', 'log_path': '/Users/spartan/Desktop/Airflow/crypto_analytics_dbt/logs', 'log_format': 'default', 'profiles_dir': '/Users/spartan/.dbt', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'no_print': 'None', 'printer_width': '80', 'version_check': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'empty': 'False', 'use_colors': 'True', 'quiet': 'False', 'static_parser': 'True', 'debug': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True'}
[0m01:30:04.888649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44c02036-9a88-4dc1-a24e-c768babdeff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066488a0>]}
[0m01:30:04.928054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44c02036-9a88-4dc1-a24e-c768babdeff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154da45a0>]}
[0m01:30:04.928936 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m01:30:05.045866 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m01:30:05.150057 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m01:30:05.150455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '44c02036-9a88-4dc1-a24e-c768babdeff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154d83b50>]}
[0m01:30:06.098771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44c02036-9a88-4dc1-a24e-c768babdeff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1554da990>]}
[0m01:30:06.162159 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/spartan/Desktop/Airflow/crypto_analytics_dbt/target/manifest.json
[0m01:30:06.164239 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/spartan/Desktop/Airflow/crypto_analytics_dbt/target/semantic_manifest.json
[0m01:30:06.182628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44c02036-9a88-4dc1-a24e-c768babdeff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1555e9d30>]}
[0m01:30:06.183019 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 492 macros
[0m01:30:06.183263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44c02036-9a88-4dc1-a24e-c768babdeff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155a0ab60>]}
[0m01:30:06.184615 [info ] [MainThread]: 
[0m01:30:06.184860 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:30:06.185039 [info ] [MainThread]: 
[0m01:30:06.185437 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:30:06.186103 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m01:30:06.234740 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m01:30:06.235058 [debug] [ThreadPool]: On list_USER_DB_PARROT: show terse schemas in database USER_DB_PARROT
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
[0m01:30:06.235257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:08.942452 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 2.707 seconds
[0m01:30:08.949667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT)
[0m01:30:08.956505 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_SNAP'
[0m01:30:08.960296 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m01:30:08.961628 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m01:30:08.961881 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */;
[0m01:30:08.962088 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: show objects in USER_DB_PARROT.PARROT_SNAP
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */;
[0m01:30:08.962571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:09.117497 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.155 seconds
[0m01:30:11.493202 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.530 seconds
[0m01:30:11.497486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44c02036-9a88-4dc1-a24e-c768babdeff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155ac2810>]}
[0m01:30:11.501413 [debug] [Thread-1 (]: Began running node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m01:30:11.502150 [info ] [Thread-1 (]: 1 of 1 START snapshot PARROT_SNAP.crypto_prices_snapshot ....................... [RUN]
[0m01:30:11.502664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now snapshot.crypto_analytics_dbt.crypto_prices_snapshot)
[0m01:30:11.502999 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m01:30:11.512175 [debug] [Thread-1 (]: Began executing node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m01:30:11.556327 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:11.556708 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
[0m01:30:11.665886 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.109 seconds
[0m01:30:11.701888 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:11.702321 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: create or replace temporary table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
as (
    
    
    with snapshot_query as (

        



select
    SYMBOL,
    PRICE_DATE,
    OPEN,
    HIGH,
    LOW,
    CLOSE,
    ADJ_CLOSE,
    VOLUME,
    INGESTED_AT
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES


    ),

    snapshotted_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    

        from "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            
  
  coalesce(nullif(INGESTED_AT, INGESTED_AT), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol || to_char(price_date) as varchar ), '')
         || '|' || coalesce(cast(INGESTED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            INGESTED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.INGESTED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.INGESTED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */;
[0m01:30:13.517359 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.814 seconds
[0m01:30:13.522921 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:13.523498 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
[0m01:30:14.029941 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.506 seconds
[0m01:30:14.035989 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:14.036521 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
[0m01:30:14.154719 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.118 seconds
[0m01:30:14.160195 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:14.160695 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
[0m01:30:14.336560 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.175 seconds
[0m01:30:14.341810 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:14.342268 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
[0m01:30:14.473999 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.131 seconds
[0m01:30:14.484035 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:14.484590 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
[0m01:30:14.586591 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.101 seconds
[0m01:30:14.611830 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:14.612302 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: select * from (
        
    
    with snapshot_query as (

        



select
    SYMBOL,
    PRICE_DATE,
    OPEN,
    HIGH,
    LOW,
    CLOSE,
    ADJ_CLOSE,
    VOLUME,
    INGESTED_AT
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES


    ),

    snapshotted_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    

        from "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            
  
  coalesce(nullif(INGESTED_AT, INGESTED_AT), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol || to_char(price_date) as varchar ), '')
         || '|' || coalesce(cast(INGESTED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            INGESTED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.INGESTED_AT)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.INGESTED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
[0m01:30:14.958392 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.345 seconds
[0m01:30:14.967203 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:14.967514 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
[0m01:30:15.052979 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.085 seconds
[0m01:30:15.054136 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:15.056476 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:15.056869 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
[0m01:30:15.184717 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.127 seconds
[0m01:30:15.185944 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:15.186817 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: merge into "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "PRICE_DATE", "OPEN", "HIGH", "LOW", "CLOSE", "ADJ_CLOSE", "VOLUME", "INGESTED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "PRICE_DATE", "OPEN", "HIGH", "LOW", "CLOSE", "ADJ_CLOSE", "VOLUME", "INGESTED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */;
[0m01:30:16.078028 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.890 seconds
[0m01:30:16.079301 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:16.079763 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
[0m01:30:16.793116 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.713 seconds
[0m01:30:16.812427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44c02036-9a88-4dc1-a24e-c768babdeff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1687a0680>]}
[0m01:30:16.813163 [info ] [Thread-1 (]: 1 of 1 OK snapshotted PARROT_SNAP.crypto_prices_snapshot ....................... [[32mSUCCESS 0[0m in 5.31s]
[0m01:30:16.813595 [debug] [Thread-1 (]: Finished running node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m01:30:16.814648 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:30:16.814896 [debug] [MainThread]: Connection 'snapshot.crypto_analytics_dbt.crypto_prices_snapshot' was left open.
[0m01:30:16.815110 [debug] [MainThread]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: Close
[0m01:30:16.928060 [debug] [MainThread]: Connection 'list_USER_DB_PARROT_PARROT_SNAP' was left open.
[0m01:30:16.928587 [debug] [MainThread]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m01:30:17.070104 [info ] [MainThread]: 
[0m01:30:17.070899 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 10.88 seconds (10.88s).
[0m01:30:17.071757 [debug] [MainThread]: Command end result
[0m01:30:17.095273 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/spartan/Desktop/Airflow/crypto_analytics_dbt/target/manifest.json
[0m01:30:17.097080 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/spartan/Desktop/Airflow/crypto_analytics_dbt/target/semantic_manifest.json
[0m01:30:17.101568 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/spartan/Desktop/Airflow/crypto_analytics_dbt/target/run_results.json
[0m01:30:17.101799 [info ] [MainThread]: 
[0m01:30:17.102091 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:30:17.102282 [info ] [MainThread]: 
[0m01:30:17.102506 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:30:17.116596 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 13.641471, "process_in_blocks": "0", "process_kernel_time": 2.0013, "process_mem_max_rss": "242974720", "process_out_blocks": "0", "process_user_time": 4.292864}
[0m01:30:17.117164 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:30:17.117078 after 13.64 seconds
[0m01:30:17.117479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1555f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1688cda30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155966350>]}
[0m01:30:17.117765 [debug] [MainThread]: Flushing usage events
[0m01:30:17.456893 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:30:02.499223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95a0b920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98408b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96641c10>]}


============================== 01:30:02.505551 | 6679288a-89f3-464c-ac48-792ec7cb680d ==============================
[0m01:30:02.505551 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:30:02.506055 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m01:30:03.211782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6679288a-89f3-464c-ac48-792ec7cb680d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff953e8770>]}
[0m01:30:03.248105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6679288a-89f3-464c-ac48-792ec7cb680d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74eb9fa0>]}
[0m01:30:03.248926 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:30:03.318860 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:30:03.406014 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m01:30:03.406490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6679288a-89f3-464c-ac48-792ec7cb680d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fc2a030>]}
[0m01:30:04.095129 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:30:04.095664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6679288a-89f3-464c-ac48-792ec7cb680d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fd5d670>]}
[0m01:30:04.342673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6679288a-89f3-464c-ac48-792ec7cb680d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e6a63f0>]}
[0m01:30:04.431877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6679288a-89f3-464c-ac48-792ec7cb680d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fdba3f0>]}
[0m01:30:04.432401 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m01:30:04.432748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6679288a-89f3-464c-ac48-792ec7cb680d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fd5cbc0>]}
[0m01:30:04.434339 [info ] [MainThread]: 
[0m01:30:04.434899 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:30:04.438570 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m01:30:04.448989 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m01:30:04.449345 [debug] [ThreadPool]: On list_USER_DB_PARROT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
show terse schemas in database USER_DB_PARROT
    limit 10000
[0m01:30:04.449652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:05.468155 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.018 seconds
[0m01:30:05.471361 [debug] [ThreadPool]: On list_USER_DB_PARROT: Close
[0m01:30:05.700436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now list_USER_DB_PARROT_PARROT_SNAP)
[0m01:30:05.708263 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT'
[0m01:30:05.713377 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m01:30:05.715593 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m01:30:05.716091 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m01:30:05.716583 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m01:30:05.716989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:30:05.717387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:06.231615 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.514 seconds
[0m01:30:06.233198 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.516 seconds
[0m01:30:06.235768 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m01:30:06.237783 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m01:30:06.381580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6679288a-89f3-464c-ac48-792ec7cb680d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e869820>]}
[0m01:30:06.383055 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:30:06.383815 [info ] [MainThread]: 
[0m01:30:06.397092 [debug] [Thread-1 (]: Began running node model.crypto_analytics_dbt.stg_crypto_prices
[0m01:30:06.397965 [info ] [Thread-1 (]: 1 of 3 START sql view model PARROT_FEAT_PARROT_FEAT.stg_crypto_prices .......... [RUN]
[0m01:30:06.398670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now model.crypto_analytics_dbt.stg_crypto_prices)
[0m01:30:06.399141 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics_dbt.stg_crypto_prices
[0m01:30:06.406696 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics_dbt.stg_crypto_prices"
[0m01:30:06.409451 [debug] [Thread-1 (]: Began executing node model.crypto_analytics_dbt.stg_crypto_prices
[0m01:30:06.431324 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics_dbt.stg_crypto_prices"
[0m01:30:06.433562 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_analytics_dbt.stg_crypto_prices"
[0m01:30:06.433941 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.stg_crypto_prices"} */
create or replace   view USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
  
   as (
    

select
  upper(symbol)                                      as symbol,
  cast(price_date as date)                           as price_date,
  cast(open as number(38,8))                         as open,
  cast(high as number(38,8))                         as high,
  cast(low as number(38,8))                          as low,
  cast(close as number(38,8))                        as close,
  cast(adj_close as number(38,8))                    as adj_close,
  cast(volume as number(38,8))                       as volume
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES
  );
[0m01:30:06.434291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:07.103057 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.668 seconds
[0m01:30:07.127226 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.stg_crypto_prices: Close
[0m01:30:07.238015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6679288a-89f3-464c-ac48-792ec7cb680d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95fc8770>]}
[0m01:30:07.239509 [info ] [Thread-1 (]: 1 of 3 OK created sql view model PARROT_FEAT_PARROT_FEAT.stg_crypto_prices ..... [[32mSUCCESS 1[0m in 0.84s]
[0m01:30:07.240506 [debug] [Thread-1 (]: Finished running node model.crypto_analytics_dbt.stg_crypto_prices
[0m01:30:07.242012 [debug] [Thread-2 (]: Began running node model.crypto_analytics_dbt.int_crypto_features
[0m01:30:07.242639 [info ] [Thread-2 (]: 2 of 3 START sql table model PARROT_FEAT_PARROT_FEAT.int_crypto_features ....... [RUN]
[0m01:30:07.243433 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_SNAP, now model.crypto_analytics_dbt.int_crypto_features)
[0m01:30:07.244060 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics_dbt.int_crypto_features
[0m01:30:07.247236 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics_dbt.int_crypto_features"
[0m01:30:07.249630 [debug] [Thread-2 (]: Began executing node model.crypto_analytics_dbt.int_crypto_features
[0m01:30:07.265644 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics_dbt.int_crypto_features"
[0m01:30:07.267275 [debug] [Thread-2 (]: Using snowflake connection "model.crypto_analytics_dbt.int_crypto_features"
[0m01:30:07.267624 [debug] [Thread-2 (]: On model.crypto_analytics_dbt.int_crypto_features: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.int_crypto_features"} */
create or replace transient table USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
         as
        (

with base as (
  select *
  from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
)
select
  symbol,
  price_date,
  close,
  avg(close) over (partition by symbol order by price_date rows between 4 preceding and current row)  as sma_5,
  avg(close) over (partition by symbol order by price_date rows between 19 preceding and current row) as sma_20,
  avg(close) over (partition by symbol order by price_date rows between 49 preceding and current row) as sma_50,
  (close / nullif(lag(close,5) over (partition by symbol order by price_date),0) - 1) * 100 as momentum_5d_pct
from base
        );
[0m01:30:07.268004 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:30:09.253741 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.985 seconds
[0m01:30:09.257001 [debug] [Thread-2 (]: On model.crypto_analytics_dbt.int_crypto_features: Close
[0m01:30:09.381682 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6679288a-89f3-464c-ac48-792ec7cb680d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6dc41c70>]}
[0m01:30:09.384998 [info ] [Thread-2 (]: 2 of 3 OK created sql table model PARROT_FEAT_PARROT_FEAT.int_crypto_features .. [[32mSUCCESS 1[0m in 2.14s]
[0m01:30:09.386172 [debug] [Thread-2 (]: Finished running node model.crypto_analytics_dbt.int_crypto_features
[0m01:30:09.387697 [debug] [Thread-1 (]: Began running node model.crypto_analytics_dbt.mart_crypto_summary
[0m01:30:09.388379 [info ] [Thread-1 (]: 3 of 3 START sql table model PARROT_FEAT_PARROT_FEAT.mart_crypto_summary ....... [RUN]
[0m01:30:09.389174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics_dbt.stg_crypto_prices, now model.crypto_analytics_dbt.mart_crypto_summary)
[0m01:30:09.389691 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics_dbt.mart_crypto_summary
[0m01:30:09.393668 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics_dbt.mart_crypto_summary"
[0m01:30:09.395033 [debug] [Thread-1 (]: Began executing node model.crypto_analytics_dbt.mart_crypto_summary
[0m01:30:09.397508 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics_dbt.mart_crypto_summary"
[0m01:30:09.398758 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_analytics_dbt.mart_crypto_summary"
[0m01:30:09.399104 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.mart_crypto_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.mart_crypto_summary"} */
create or replace transient table USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
         as
        (

select
  symbol,
  price_date,
  close,
  sma_5,
  sma_20,
  sma_50,
  momentum_5d_pct,
  case when sma_5 > sma_20 then 1 else 0 end as bull_signal_cross
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
order by price_date, symbol
        );
[0m01:30:09.399484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:10.791153 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.391 seconds
[0m01:30:10.796352 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.mart_crypto_summary: Close
[0m01:30:10.902940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6679288a-89f3-464c-ac48-792ec7cb680d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d27b740>]}
[0m01:30:10.904660 [info ] [Thread-1 (]: 3 of 3 OK created sql table model PARROT_FEAT_PARROT_FEAT.mart_crypto_summary .. [[32mSUCCESS 1[0m in 1.51s]
[0m01:30:10.905875 [debug] [Thread-1 (]: Finished running node model.crypto_analytics_dbt.mart_crypto_summary
[0m01:30:10.908231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:30:10.908756 [debug] [MainThread]: Connection 'model.crypto_analytics_dbt.int_crypto_features' was properly closed.
[0m01:30:10.909115 [debug] [MainThread]: Connection 'model.crypto_analytics_dbt.mart_crypto_summary' was properly closed.
[0m01:30:10.909647 [info ] [MainThread]: 
[0m01:30:10.910124 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 6.47 seconds (6.47s).
[0m01:30:10.911235 [debug] [MainThread]: Command end result
[0m01:30:10.946238 [info ] [MainThread]: 
[0m01:30:10.946768 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:30:10.947080 [info ] [MainThread]: 
[0m01:30:10.947386 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:30:10.948646 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.483808, "process_user_time": 4.645906, "process_kernel_time": 0.393246, "process_mem_max_rss": "219964", "process_out_blocks": "4815", "process_in_blocks": "0"}
[0m01:30:10.949163 [debug] [MainThread]: Command `dbt run` succeeded at 01:30:10.949085 after 8.48 seconds
[0m01:30:10.949568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95a0b920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff953af620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95fcaab0>]}
[0m01:30:10.949886 [debug] [MainThread]: Flushing usage events
[0m01:30:13.477688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cefc200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cefc1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ddfd6a0>]}


============================== 01:30:13.483298 | 2c1ae85b-e144-4679-a4ee-30607ab5cc1a ==============================
[0m01:30:13.483298 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:30:13.483868 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:30:14.107013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c1ae85b-e144-4679-a4ee-30607ab5cc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ecd77a0>]}
[0m01:30:14.141509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c1ae85b-e144-4679-a4ee-30607ab5cc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ed83860>]}
[0m01:30:14.142245 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:30:14.211046 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:30:14.310111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:30:14.310583 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:30:14.348078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c1ae85b-e144-4679-a4ee-30607ab5cc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff677b2240>]}
[0m01:30:14.443858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c1ae85b-e144-4679-a4ee-30607ab5cc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff677b1fd0>]}
[0m01:30:14.444425 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m01:30:14.444790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c1ae85b-e144-4679-a4ee-30607ab5cc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff672e0200>]}
[0m01:30:14.446494 [info ] [MainThread]: 
[0m01:30:14.447084 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:30:14.450855 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_SNAP'
[0m01:30:14.459559 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT'
[0m01:30:14.465000 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m01:30:14.466864 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m01:30:14.467242 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m01:30:14.467594 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m01:30:14.467935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:14.468273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:14.922873 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.455 seconds
[0m01:30:14.925272 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m01:30:14.945818 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.478 seconds
[0m01:30:14.947466 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m01:30:15.042951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c1ae85b-e144-4679-a4ee-30607ab5cc1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67397650>]}
[0m01:30:15.044145 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:30:15.044793 [info ] [MainThread]: 
[0m01:30:15.058718 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m01:30:15.059703 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m01:30:15.060214 [info ] [Thread-1 (]: 1 of 6 START test not_null_int_crypto_features_price_date ...................... [RUN]
[0m01:30:15.060775 [info ] [Thread-2 (]: 2 of 6 START test not_null_int_crypto_features_symbol .......................... [RUN]
[0m01:30:15.061444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_SNAP, now test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6)
[0m01:30:15.061989 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2)
[0m01:30:15.062444 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m01:30:15.062902 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m01:30:15.076282 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m01:30:15.079445 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m01:30:15.080989 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m01:30:15.081295 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m01:30:15.096110 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m01:30:15.098007 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m01:30:15.099861 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m01:30:15.100395 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m01:30:15.100718 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
where symbol is null



      
    ) dbt_internal_test
[0m01:30:15.101095 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
where price_date is null



      
    ) dbt_internal_test
[0m01:30:15.101459 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:30:15.101816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:15.807825 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.706 seconds
[0m01:30:15.820698 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2: Close
[0m01:30:16.423020 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.321 seconds
[0m01:30:16.425428 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6: Close
[0m01:30:16.523378 [info ] [Thread-2 (]: 2 of 6 PASS not_null_int_crypto_features_symbol ................................ [[32mPASS[0m in 1.46s]
[0m01:30:16.524572 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m01:30:16.525095 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m01:30:16.525540 [info ] [Thread-2 (]: 3 of 6 START test not_null_mart_crypto_summary_price_date ...................... [RUN]
[0m01:30:16.526092 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2, now test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b)
[0m01:30:16.526598 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m01:30:16.531426 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m01:30:16.533675 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m01:30:16.534853 [info ] [Thread-1 (]: 1 of 6 PASS not_null_int_crypto_features_price_date ............................ [[32mPASS[0m in 1.47s]
[0m01:30:16.537963 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m01:30:16.538827 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m01:30:16.539614 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m01:30:16.540102 [info ] [Thread-1 (]: 4 of 6 START test not_null_mart_crypto_summary_symbol .......................... [RUN]
[0m01:30:16.540681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6, now test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce)
[0m01:30:16.541319 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m01:30:16.541637 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m01:30:16.542046 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
where price_date is null



      
    ) dbt_internal_test
[0m01:30:16.545617 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m01:30:16.546076 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:30:16.548428 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m01:30:16.550694 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m01:30:16.551974 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m01:30:16.552382 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
where symbol is null



      
    ) dbt_internal_test
[0m01:30:16.552788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:16.983114 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.437 seconds
[0m01:30:16.986049 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b: Close
[0m01:30:17.142810 [info ] [Thread-2 (]: 3 of 6 PASS not_null_mart_crypto_summary_price_date ............................ [[32mPASS[0m in 0.62s]
[0m01:30:17.143764 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m01:30:17.144353 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m01:30:17.144817 [info ] [Thread-2 (]: 5 of 6 START test not_null_stg_crypto_prices_price_date ........................ [RUN]
[0m01:30:17.145346 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b, now test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314)
[0m01:30:17.145853 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m01:30:17.151698 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m01:30:17.153686 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m01:30:17.156809 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m01:30:17.158371 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m01:30:17.158859 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
where price_date is null



      
    ) dbt_internal_test
[0m01:30:17.159212 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:30:17.177511 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m01:30:17.179859 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce: Close
[0m01:30:17.305834 [info ] [Thread-1 (]: 4 of 6 PASS not_null_mart_crypto_summary_symbol ................................ [[32mPASS[0m in 0.76s]
[0m01:30:17.306796 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m01:30:17.307385 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m01:30:17.307884 [info ] [Thread-1 (]: 6 of 6 START test not_null_stg_crypto_prices_symbol ............................ [RUN]
[0m01:30:17.308369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce, now test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a)
[0m01:30:17.308940 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m01:30:17.312749 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m01:30:17.313918 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m01:30:17.316119 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m01:30:17.317351 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m01:30:17.317744 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
where symbol is null



      
    ) dbt_internal_test
[0m01:30:17.318111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:17.557860 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.398 seconds
[0m01:30:17.561302 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314: Close
[0m01:30:17.701420 [info ] [Thread-2 (]: 5 of 6 PASS not_null_stg_crypto_prices_price_date .............................. [[32mPASS[0m in 0.55s]
[0m01:30:17.703044 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m01:30:18.063060 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.745 seconds
[0m01:30:18.067653 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a: Close
[0m01:30:18.212842 [info ] [Thread-1 (]: 6 of 6 PASS not_null_stg_crypto_prices_symbol .................................. [[32mPASS[0m in 0.90s]
[0m01:30:18.213985 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m01:30:18.216416 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:30:18.217278 [debug] [MainThread]: Connection 'test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a' was properly closed.
[0m01:30:18.217857 [debug] [MainThread]: Connection 'test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314' was properly closed.
[0m01:30:18.218483 [info ] [MainThread]: 
[0m01:30:18.219218 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 3.77 seconds (3.77s).
[0m01:30:18.221093 [debug] [MainThread]: Command end result
[0m01:30:18.255473 [info ] [MainThread]: 
[0m01:30:18.256125 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:30:18.256578 [info ] [MainThread]: 
[0m01:30:18.257004 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m01:30:18.258061 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.8128347, "process_user_time": 3.552921, "process_kernel_time": 0.218117, "process_mem_max_rss": "214376", "process_out_blocks": "1936", "process_in_blocks": "0"}
[0m01:30:18.258590 [debug] [MainThread]: Command `dbt test` succeeded at 01:30:18.258484 after 4.81 seconds
[0m01:30:18.260487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d1fe1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d569460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ced4dd0>]}
[0m01:30:18.260883 [debug] [MainThread]: Flushing usage events
[0m01:30:21.467503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff877e1760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85ba97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85a183e0>]}


============================== 01:30:21.473181 | 7920b3ef-7e37-4002-a28a-4e49b296a32d ==============================
[0m01:30:21.473181 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:30:21.473683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:30:22.082298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7920b3ef-7e37-4002-a28a-4e49b296a32d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff871ebdd0>]}
[0m01:30:22.117376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7920b3ef-7e37-4002-a28a-4e49b296a32d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67961cd0>]}
[0m01:30:22.118081 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:30:22.185196 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:30:22.282512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:30:22.283006 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:30:22.320012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7920b3ef-7e37-4002-a28a-4e49b296a32d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff648f6600>]}
[0m01:30:22.411466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7920b3ef-7e37-4002-a28a-4e49b296a32d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ffc07d0>]}
[0m01:30:22.412042 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m01:30:22.412434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7920b3ef-7e37-4002-a28a-4e49b296a32d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ffe2690>]}
[0m01:30:22.414018 [info ] [MainThread]: 
[0m01:30:22.414513 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:30:22.415367 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m01:30:22.426811 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m01:30:22.427183 [debug] [ThreadPool]: On list_USER_DB_PARROT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
show terse schemas in database USER_DB_PARROT
    limit 10000
[0m01:30:22.427493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:22.844045 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.416 seconds
[0m01:30:22.846122 [debug] [ThreadPool]: On list_USER_DB_PARROT: Close
[0m01:30:23.177552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT)
[0m01:30:23.184723 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_SNAP'
[0m01:30:23.189967 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m01:30:23.193234 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m01:30:23.193727 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m01:30:23.194222 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m01:30:23.194613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:30:23.194945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:23.614001 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.419 seconds
[0m01:30:23.616055 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m01:30:23.663962 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.469 seconds
[0m01:30:23.666254 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m01:30:23.810359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7920b3ef-7e37-4002-a28a-4e49b296a32d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87069460>]}
[0m01:30:23.811705 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:30:23.812355 [info ] [MainThread]: 
[0m01:30:23.824800 [debug] [Thread-1 (]: Began running node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m01:30:23.825433 [info ] [Thread-1 (]: 1 of 1 START snapshot PARROT_SNAP.crypto_prices_snapshot ....................... [RUN]
[0m01:30:23.825942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now snapshot.crypto_analytics_dbt.crypto_prices_snapshot)
[0m01:30:23.826346 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m01:30:23.833733 [debug] [Thread-1 (]: Began executing node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m01:30:23.872077 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:23.872511 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m01:30:23.872855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:24.188565 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.316 seconds
[0m01:30:24.220867 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:24.221411 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
create or replace temporary table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
    SYMBOL,
    PRICE_DATE,
    OPEN,
    HIGH,
    LOW,
    CLOSE,
    ADJ_CLOSE,
    VOLUME,
    INGESTED_AT
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES


    ),

    snapshotted_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    

        from "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            
  
  coalesce(nullif(INGESTED_AT, INGESTED_AT), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol || to_char(price_date) as varchar ), '')
         || '|' || coalesce(cast(INGESTED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            INGESTED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.INGESTED_AT))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.INGESTED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m01:30:25.976309 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.754 seconds
[0m01:30:25.982109 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:25.983048 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m01:30:26.130661 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.146 seconds
[0m01:30:26.137316 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:26.138259 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m01:30:26.262485 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.123 seconds
[0m01:30:26.272010 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:26.272805 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m01:30:26.389889 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.116 seconds
[0m01:30:26.396044 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:26.396783 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m01:30:26.501066 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.103 seconds
[0m01:30:26.512175 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:26.512756 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m01:30:26.597179 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.084 seconds
[0m01:30:26.622718 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:26.623242 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
select * from (
        

    with snapshot_query as (

        



select
    SYMBOL,
    PRICE_DATE,
    OPEN,
    HIGH,
    LOW,
    CLOSE,
    ADJ_CLOSE,
    VOLUME,
    INGESTED_AT
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES


    ),

    snapshotted_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    

        from "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            
  
  coalesce(nullif(INGESTED_AT, INGESTED_AT), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol || to_char(price_date) as varchar ), '')
         || '|' || coalesce(cast(INGESTED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            INGESTED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.INGESTED_AT))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.INGESTED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m01:30:27.065436 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.441 seconds
[0m01:30:27.074108 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:27.075085 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:30:27.147595 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.072 seconds
[0m01:30:27.149017 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:27.152387 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:27.153065 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
BEGIN
[0m01:30:27.296345 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.142 seconds
[0m01:30:27.297801 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:27.298354 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
merge into "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "PRICE_DATE", "OPEN", "HIGH", "LOW", "CLOSE", "ADJ_CLOSE", "VOLUME", "INGESTED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "PRICE_DATE", "OPEN", "HIGH", "LOW", "CLOSE", "ADJ_CLOSE", "VOLUME", "INGESTED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:30:28.404623 [debug] [Thread-1 (]: SQL status: SUCCESS 1460 in 1.105 seconds
[0m01:30:28.405898 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:28.406534 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
COMMIT
[0m01:30:28.760096 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.353 seconds
[0m01:30:28.782301 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: Close
[0m01:30:28.891056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7920b3ef-7e37-4002-a28a-4e49b296a32d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff644323f0>]}
[0m01:30:28.892053 [info ] [Thread-1 (]: 1 of 1 OK snapshotted PARROT_SNAP.crypto_prices_snapshot ....................... [[32mSUCCESS 1460[0m in 5.06s]
[0m01:30:28.892627 [debug] [Thread-1 (]: Finished running node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m01:30:28.894100 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:30:28.894408 [debug] [MainThread]: Connection 'snapshot.crypto_analytics_dbt.crypto_prices_snapshot' was properly closed.
[0m01:30:28.894676 [debug] [MainThread]: Connection 'list_USER_DB_PARROT_PARROT_SNAP' was properly closed.
[0m01:30:28.895017 [info ] [MainThread]: 
[0m01:30:28.895350 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.48 seconds (6.48s).
[0m01:30:28.895912 [debug] [MainThread]: Command end result
[0m01:30:28.926544 [info ] [MainThread]: 
[0m01:30:28.927064 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:30:28.927365 [info ] [MainThread]: 
[0m01:30:28.927649 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:30:28.928483 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.4940314, "process_user_time": 3.58625, "process_kernel_time": 0.223508, "process_mem_max_rss": "213276", "process_out_blocks": "1920", "process_in_blocks": "0"}
[0m01:30:28.928946 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:30:28.928866 after 7.49 seconds
[0m01:30:28.929312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff877e1760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ffdaed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85e725a0>]}
[0m01:30:28.929621 [debug] [MainThread]: Flushing usage events
[0m01:30:02.879362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b15130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2f551f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b17c50>]}


============================== 01:30:02.885890 | d3a39d89-070b-47d1-be31-4f0ce1a9562d ==============================
[0m01:30:02.885890 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:30:02.886419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:30:03.570262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3a39d89-070b-47d1-be31-4f0ce1a9562d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9166b470>]}
[0m01:30:03.609905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3a39d89-070b-47d1-be31-4f0ce1a9562d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb41042c0>]}
[0m01:30:03.611204 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:30:03.688150 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:30:03.790220 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:30:03.790689 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:30:03.827901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3a39d89-070b-47d1-be31-4f0ce1a9562d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff923cb320>]}
[0m01:30:03.918913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3a39d89-070b-47d1-be31-4f0ce1a9562d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff911de810>]}
[0m01:30:03.919482 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m01:30:03.919835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3a39d89-070b-47d1-be31-4f0ce1a9562d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff913ab410>]}
[0m01:30:03.921493 [info ] [MainThread]: 
[0m01:30:03.922074 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:30:03.925763 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m01:30:03.938539 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m01:30:03.938919 [debug] [ThreadPool]: On list_USER_DB_PARROT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
show terse schemas in database USER_DB_PARROT
    limit 10000
[0m01:30:03.939191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:04.586602 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.647 seconds
[0m01:30:04.588420 [debug] [ThreadPool]: On list_USER_DB_PARROT: Close
[0m01:30:04.862784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now list_USER_DB_PARROT_PARROT_SNAP)
[0m01:30:04.870006 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT'
[0m01:30:04.876186 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m01:30:04.878508 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m01:30:04.878968 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m01:30:04.879508 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m01:30:04.879898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:30:04.880267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:06.287611 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.407 seconds
[0m01:30:06.290757 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m01:30:06.334992 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.455 seconds
[0m01:30:06.338014 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m01:30:06.615844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3a39d89-070b-47d1-be31-4f0ce1a9562d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fd2090>]}
[0m01:30:06.617072 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:30:06.617655 [info ] [MainThread]: 
[0m01:30:06.630247 [debug] [Thread-1 (]: Began running node model.crypto_analytics_dbt.stg_crypto_prices
[0m01:30:06.631159 [info ] [Thread-1 (]: 1 of 3 START sql view model PARROT_FEAT_PARROT_FEAT.stg_crypto_prices .......... [RUN]
[0m01:30:06.631844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_SNAP, now model.crypto_analytics_dbt.stg_crypto_prices)
[0m01:30:06.632257 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics_dbt.stg_crypto_prices
[0m01:30:06.640008 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics_dbt.stg_crypto_prices"
[0m01:30:06.642874 [debug] [Thread-1 (]: Began executing node model.crypto_analytics_dbt.stg_crypto_prices
[0m01:30:06.665007 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics_dbt.stg_crypto_prices"
[0m01:30:06.666828 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_analytics_dbt.stg_crypto_prices"
[0m01:30:06.667172 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.stg_crypto_prices"} */
create or replace   view USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
  
   as (
    

select
  upper(symbol)                                      as symbol,
  cast(price_date as date)                           as price_date,
  cast(open as number(38,8))                         as open,
  cast(high as number(38,8))                         as high,
  cast(low as number(38,8))                          as low,
  cast(close as number(38,8))                        as close,
  cast(adj_close as number(38,8))                    as adj_close,
  cast(volume as number(38,8))                       as volume
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES
  );
[0m01:30:06.667538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:07.443459 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.775 seconds
[0m01:30:07.468486 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.stg_crypto_prices: Close
[0m01:30:07.726736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3a39d89-070b-47d1-be31-4f0ce1a9562d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90572ff0>]}
[0m01:30:07.728600 [info ] [Thread-1 (]: 1 of 3 OK created sql view model PARROT_FEAT_PARROT_FEAT.stg_crypto_prices ..... [[32mSUCCESS 1[0m in 1.09s]
[0m01:30:07.729670 [debug] [Thread-1 (]: Finished running node model.crypto_analytics_dbt.stg_crypto_prices
[0m01:30:07.731349 [debug] [Thread-2 (]: Began running node model.crypto_analytics_dbt.int_crypto_features
[0m01:30:07.732146 [info ] [Thread-2 (]: 2 of 3 START sql table model PARROT_FEAT_PARROT_FEAT.int_crypto_features ....... [RUN]
[0m01:30:07.732986 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now model.crypto_analytics_dbt.int_crypto_features)
[0m01:30:07.733506 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics_dbt.int_crypto_features
[0m01:30:07.737252 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics_dbt.int_crypto_features"
[0m01:30:07.739960 [debug] [Thread-2 (]: Began executing node model.crypto_analytics_dbt.int_crypto_features
[0m01:30:07.758523 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics_dbt.int_crypto_features"
[0m01:30:07.760023 [debug] [Thread-2 (]: Using snowflake connection "model.crypto_analytics_dbt.int_crypto_features"
[0m01:30:07.760418 [debug] [Thread-2 (]: On model.crypto_analytics_dbt.int_crypto_features: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.int_crypto_features"} */
create or replace transient table USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
         as
        (

with base as (
  select *
  from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
)
select
  symbol,
  price_date,
  close,
  avg(close) over (partition by symbol order by price_date rows between 4 preceding and current row)  as sma_5,
  avg(close) over (partition by symbol order by price_date rows between 19 preceding and current row) as sma_20,
  avg(close) over (partition by symbol order by price_date rows between 49 preceding and current row) as sma_50,
  (close / nullif(lag(close,5) over (partition by symbol order by price_date),0) - 1) * 100 as momentum_5d_pct
from base
        );
[0m01:30:07.760757 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:30:10.716669 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.955 seconds
[0m01:30:10.720612 [debug] [Thread-2 (]: On model.crypto_analytics_dbt.int_crypto_features: Close
[0m01:30:10.842761 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3a39d89-070b-47d1-be31-4f0ce1a9562d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90656db0>]}
[0m01:30:10.843959 [info ] [Thread-2 (]: 2 of 3 OK created sql table model PARROT_FEAT_PARROT_FEAT.int_crypto_features .. [[32mSUCCESS 1[0m in 3.11s]
[0m01:30:10.844680 [debug] [Thread-2 (]: Finished running node model.crypto_analytics_dbt.int_crypto_features
[0m01:30:10.845887 [debug] [Thread-1 (]: Began running node model.crypto_analytics_dbt.mart_crypto_summary
[0m01:30:10.846476 [info ] [Thread-1 (]: 3 of 3 START sql table model PARROT_FEAT_PARROT_FEAT.mart_crypto_summary ....... [RUN]
[0m01:30:10.846967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics_dbt.stg_crypto_prices, now model.crypto_analytics_dbt.mart_crypto_summary)
[0m01:30:10.847365 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics_dbt.mart_crypto_summary
[0m01:30:10.850996 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics_dbt.mart_crypto_summary"
[0m01:30:10.853496 [debug] [Thread-1 (]: Began executing node model.crypto_analytics_dbt.mart_crypto_summary
[0m01:30:10.855749 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics_dbt.mart_crypto_summary"
[0m01:30:10.857185 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_analytics_dbt.mart_crypto_summary"
[0m01:30:10.857578 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.mart_crypto_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.mart_crypto_summary"} */
create or replace transient table USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
         as
        (

select
  symbol,
  price_date,
  close,
  sma_5,
  sma_20,
  sma_50,
  momentum_5d_pct,
  case when sma_5 > sma_20 then 1 else 0 end as bull_signal_cross
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
order by price_date, symbol
        );
[0m01:30:10.858057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:12.254359 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.396 seconds
[0m01:30:12.258612 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.mart_crypto_summary: Close
[0m01:30:12.426109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3a39d89-070b-47d1-be31-4f0ce1a9562d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff906d37a0>]}
[0m01:30:12.427641 [info ] [Thread-1 (]: 3 of 3 OK created sql table model PARROT_FEAT_PARROT_FEAT.mart_crypto_summary .. [[32mSUCCESS 1[0m in 1.58s]
[0m01:30:12.428647 [debug] [Thread-1 (]: Finished running node model.crypto_analytics_dbt.mart_crypto_summary
[0m01:30:12.431060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:30:12.431743 [debug] [MainThread]: Connection 'model.crypto_analytics_dbt.mart_crypto_summary' was properly closed.
[0m01:30:12.432180 [debug] [MainThread]: Connection 'model.crypto_analytics_dbt.int_crypto_features' was properly closed.
[0m01:30:12.432830 [info ] [MainThread]: 
[0m01:30:12.433452 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 8.51 seconds (8.51s).
[0m01:30:12.434767 [debug] [MainThread]: Command end result
[0m01:30:12.471816 [info ] [MainThread]: 
[0m01:30:12.472362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:30:12.472701 [info ] [MainThread]: 
[0m01:30:12.473042 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:30:12.474249 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.629388, "process_user_time": 4.052569, "process_kernel_time": 0.483545, "process_mem_max_rss": "215204", "process_out_blocks": "4985", "process_in_blocks": "0"}
[0m01:30:12.474840 [debug] [MainThread]: Command `dbt run` succeeded at 01:30:12.474761 after 9.63 seconds
[0m01:30:12.475235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2c3ffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91121550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9114b1a0>]}
[0m01:30:12.475581 [debug] [MainThread]: Flushing usage events
[0m01:30:15.874935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac7aa240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad7196a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacac2180>]}


============================== 01:30:15.880981 | eec720ef-963d-41b9-abeb-1334970a17ce ==============================
[0m01:30:15.880981 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:30:15.881580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m01:30:16.511607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eec720ef-963d-41b9-abeb-1334970a17ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8701b620>]}
[0m01:30:16.545998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eec720ef-963d-41b9-abeb-1334970a17ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfffface59700>]}
[0m01:30:16.546738 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:30:16.614741 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:30:16.714084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:30:16.714500 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:30:16.751629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eec720ef-963d-41b9-abeb-1334970a17ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff870b2c30>]}
[0m01:30:16.845807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eec720ef-963d-41b9-abeb-1334970a17ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86cba630>]}
[0m01:30:16.846316 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m01:30:16.846677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eec720ef-963d-41b9-abeb-1334970a17ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86be23f0>]}
[0m01:30:16.848297 [info ] [MainThread]: 
[0m01:30:16.848829 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:30:16.852220 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT'
[0m01:30:16.860717 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_SNAP'
[0m01:30:16.866050 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m01:30:16.867736 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m01:30:16.868107 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m01:30:16.868461 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m01:30:16.868806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:16.869112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:17.384142 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.515 seconds
[0m01:30:17.387769 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m01:30:17.513470 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.644 seconds
[0m01:30:17.516872 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m01:30:17.637216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eec720ef-963d-41b9-abeb-1334970a17ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaddf95e0>]}
[0m01:30:17.638686 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:30:17.639485 [info ] [MainThread]: 
[0m01:30:17.652094 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m01:30:17.653162 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m01:30:17.653731 [info ] [Thread-1 (]: 1 of 6 START test not_null_int_crypto_features_price_date ...................... [RUN]
[0m01:30:17.654437 [info ] [Thread-2 (]: 2 of 6 START test not_null_int_crypto_features_symbol .......................... [RUN]
[0m01:30:17.655154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_SNAP, now test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6)
[0m01:30:17.655676 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2)
[0m01:30:17.656119 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m01:30:17.656529 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m01:30:17.670357 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m01:30:17.673648 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m01:30:17.675210 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m01:30:17.675583 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m01:30:17.693831 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m01:30:17.694653 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m01:30:17.696651 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m01:30:17.697181 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m01:30:17.697512 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
where price_date is null



      
    ) dbt_internal_test
[0m01:30:17.697883 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
where symbol is null



      
    ) dbt_internal_test
[0m01:30:17.698241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:17.698577 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:30:18.497742 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.799 seconds
[0m01:30:18.510631 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6: Close
[0m01:30:18.630344 [info ] [Thread-1 (]: 1 of 6 PASS not_null_int_crypto_features_price_date ............................ [[32mPASS[0m in 0.97s]
[0m01:30:18.631778 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m01:30:18.632617 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m01:30:18.633284 [info ] [Thread-1 (]: 3 of 6 START test not_null_mart_crypto_summary_price_date ...................... [RUN]
[0m01:30:18.634050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6, now test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b)
[0m01:30:18.634611 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m01:30:18.641314 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m01:30:18.643238 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m01:30:18.646586 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m01:30:18.648194 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m01:30:18.648637 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
where price_date is null



      
    ) dbt_internal_test
[0m01:30:18.649023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:18.959756 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.261 seconds
[0m01:30:18.963210 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2: Close
[0m01:30:19.076545 [info ] [Thread-2 (]: 2 of 6 PASS not_null_int_crypto_features_symbol ................................ [[32mPASS[0m in 1.42s]
[0m01:30:19.078244 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m01:30:19.079137 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m01:30:19.079825 [info ] [Thread-2 (]: 4 of 6 START test not_null_mart_crypto_summary_symbol .......................... [RUN]
[0m01:30:19.080668 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2, now test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce)
[0m01:30:19.081333 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m01:30:19.087990 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m01:30:19.090091 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m01:30:19.093102 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m01:30:19.094608 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m01:30:19.095050 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
where symbol is null



      
    ) dbt_internal_test
[0m01:30:19.095586 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:30:19.261056 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m01:30:19.263586 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b: Close
[0m01:30:19.596556 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.501 seconds
[0m01:30:19.600799 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce: Close
[0m01:30:19.668736 [info ] [Thread-1 (]: 3 of 6 PASS not_null_mart_crypto_summary_price_date ............................ [[32mPASS[0m in 1.03s]
[0m01:30:19.670138 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m01:30:19.670916 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m01:30:19.671524 [info ] [Thread-1 (]: 5 of 6 START test not_null_stg_crypto_prices_price_date ........................ [RUN]
[0m01:30:19.672188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b, now test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314)
[0m01:30:19.672739 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m01:30:19.680030 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m01:30:19.682021 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m01:30:19.684860 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m01:30:19.686362 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m01:30:19.686781 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
where price_date is null



      
    ) dbt_internal_test
[0m01:30:19.687119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:19.728090 [info ] [Thread-2 (]: 4 of 6 PASS not_null_mart_crypto_summary_symbol ................................ [[32mPASS[0m in 0.65s]
[0m01:30:19.728873 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m01:30:19.729394 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m01:30:19.729925 [info ] [Thread-2 (]: 6 of 6 START test not_null_stg_crypto_prices_symbol ............................ [RUN]
[0m01:30:19.730467 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce, now test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a)
[0m01:30:19.730915 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m01:30:19.734545 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m01:30:19.735812 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m01:30:19.738905 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m01:30:19.740086 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m01:30:19.740409 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
where symbol is null



      
    ) dbt_internal_test
[0m01:30:19.740714 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:30:20.195905 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.509 seconds
[0m01:30:20.199522 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314: Close
[0m01:30:20.314236 [info ] [Thread-1 (]: 5 of 6 PASS not_null_stg_crypto_prices_price_date .............................. [[32mPASS[0m in 0.64s]
[0m01:30:20.315717 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m01:30:21.059955 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.319 seconds
[0m01:30:21.063964 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a: Close
[0m01:30:21.177588 [info ] [Thread-2 (]: 6 of 6 PASS not_null_stg_crypto_prices_symbol .................................. [[32mPASS[0m in 1.45s]
[0m01:30:21.179675 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m01:30:21.187888 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:30:21.189543 [debug] [MainThread]: Connection 'test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a' was properly closed.
[0m01:30:21.190162 [debug] [MainThread]: Connection 'test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314' was properly closed.
[0m01:30:21.190799 [info ] [MainThread]: 
[0m01:30:21.191268 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 4.34 seconds (4.34s).
[0m01:30:21.192595 [debug] [MainThread]: Command end result
[0m01:30:21.224768 [info ] [MainThread]: 
[0m01:30:21.225247 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:30:21.225569 [info ] [MainThread]: 
[0m01:30:21.225865 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m01:30:21.226662 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.3861, "process_user_time": 3.660407, "process_kernel_time": 0.219624, "process_mem_max_rss": "214492", "process_out_blocks": "1936", "process_in_blocks": "0"}
[0m01:30:21.227104 [debug] [MainThread]: Command `dbt test` succeeded at 01:30:21.227035 after 5.39 seconds
[0m01:30:21.227441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac7bc7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac7bd1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac7bd4c0>]}
[0m01:30:21.227737 [debug] [MainThread]: Flushing usage events
[0m01:30:23.790938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86e21700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85024e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85024d70>]}


============================== 01:30:23.796717 | d0ad05bc-3b95-4d5f-be38-9a1b8025076d ==============================
[0m01:30:23.796717 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:30:23.797219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:30:24.397408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0ad05bc-3b95-4d5f-be38-9a1b8025076d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff865ebef0>]}
[0m01:30:24.431649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0ad05bc-3b95-4d5f-be38-9a1b8025076d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff854661e0>]}
[0m01:30:24.432377 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:30:24.500764 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:30:24.598640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:30:24.599075 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:30:24.636527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0ad05bc-3b95-4d5f-be38-9a1b8025076d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f8fc380>]}
[0m01:30:24.723314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0ad05bc-3b95-4d5f-be38-9a1b8025076d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f73c350>]}
[0m01:30:24.723802 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m01:30:24.724137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0ad05bc-3b95-4d5f-be38-9a1b8025076d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f8fea20>]}
[0m01:30:24.725750 [info ] [MainThread]: 
[0m01:30:24.726310 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:30:24.727169 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m01:30:24.738334 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m01:30:24.738705 [debug] [ThreadPool]: On list_USER_DB_PARROT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
show terse schemas in database USER_DB_PARROT
    limit 10000
[0m01:30:24.739011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:25.233179 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.494 seconds
[0m01:30:25.234937 [debug] [ThreadPool]: On list_USER_DB_PARROT: Close
[0m01:30:25.348024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT)
[0m01:30:25.357112 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_SNAP'
[0m01:30:25.361850 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m01:30:25.363720 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m01:30:25.364109 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m01:30:25.364483 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m01:30:25.364826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:30:25.365141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:25.707137 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.342 seconds
[0m01:30:25.709370 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m01:30:25.734866 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.370 seconds
[0m01:30:25.736467 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m01:30:25.837042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0ad05bc-3b95-4d5f-be38-9a1b8025076d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66f62c90>]}
[0m01:30:25.838325 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:30:25.838968 [info ] [MainThread]: 
[0m01:30:25.850983 [debug] [Thread-1 (]: Began running node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m01:30:25.851703 [info ] [Thread-1 (]: 1 of 1 START snapshot PARROT_SNAP.crypto_prices_snapshot ....................... [RUN]
[0m01:30:25.852260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now snapshot.crypto_analytics_dbt.crypto_prices_snapshot)
[0m01:30:25.852659 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m01:30:25.859903 [debug] [Thread-1 (]: Began executing node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m01:30:25.898273 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:25.898721 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m01:30:25.899052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:26.424796 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.525 seconds
[0m01:30:26.464041 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:26.464818 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
create or replace temporary table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
    SYMBOL,
    PRICE_DATE,
    OPEN,
    HIGH,
    LOW,
    CLOSE,
    ADJ_CLOSE,
    VOLUME,
    INGESTED_AT
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES


    ),

    snapshotted_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    

        from "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            
  
  coalesce(nullif(INGESTED_AT, INGESTED_AT), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol || to_char(price_date) as varchar ), '')
         || '|' || coalesce(cast(INGESTED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            INGESTED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.INGESTED_AT))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.INGESTED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m01:30:28.126882 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.661 seconds
[0m01:30:28.132325 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:28.133181 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m01:30:28.237910 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.104 seconds
[0m01:30:28.247525 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:28.248566 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m01:30:28.428161 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.179 seconds
[0m01:30:28.434157 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:28.434912 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m01:30:28.565048 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.129 seconds
[0m01:30:28.571820 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:28.572534 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m01:30:28.676271 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.103 seconds
[0m01:30:28.687044 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:28.687623 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m01:30:28.807257 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.119 seconds
[0m01:30:28.832117 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:28.832788 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
select * from (
        

    with snapshot_query as (

        



select
    SYMBOL,
    PRICE_DATE,
    OPEN,
    HIGH,
    LOW,
    CLOSE,
    ADJ_CLOSE,
    VOLUME,
    INGESTED_AT
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES


    ),

    snapshotted_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    

        from "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            
  
  coalesce(nullif(INGESTED_AT, INGESTED_AT), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol || to_char(price_date) as varchar ), '')
         || '|' || coalesce(cast(INGESTED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            INGESTED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.INGESTED_AT))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.INGESTED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m01:30:29.250496 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.417 seconds
[0m01:30:29.258688 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:29.259576 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:30:29.358079 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.097 seconds
[0m01:30:29.359979 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:29.364528 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:29.365211 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
BEGIN
[0m01:30:29.511294 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.145 seconds
[0m01:30:29.512611 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:29.513312 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
merge into "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "PRICE_DATE", "OPEN", "HIGH", "LOW", "CLOSE", "ADJ_CLOSE", "VOLUME", "INGESTED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "PRICE_DATE", "OPEN", "HIGH", "LOW", "CLOSE", "ADJ_CLOSE", "VOLUME", "INGESTED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:30:30.484042 [debug] [Thread-1 (]: SQL status: SUCCESS 1458 in 0.970 seconds
[0m01:30:30.485513 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:30.486163 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
COMMIT
[0m01:30:30.990932 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.504 seconds
[0m01:30:31.008534 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: Close
[0m01:30:31.150330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0ad05bc-3b95-4d5f-be38-9a1b8025076d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ebff4a0>]}
[0m01:30:31.152001 [info ] [Thread-1 (]: 1 of 1 OK snapshotted PARROT_SNAP.crypto_prices_snapshot ....................... [[32mSUCCESS 1458[0m in 5.30s]
[0m01:30:31.153076 [debug] [Thread-1 (]: Finished running node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m01:30:31.155304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:30:31.155833 [debug] [MainThread]: Connection 'snapshot.crypto_analytics_dbt.crypto_prices_snapshot' was properly closed.
[0m01:30:31.156211 [debug] [MainThread]: Connection 'list_USER_DB_PARROT_PARROT_SNAP' was properly closed.
[0m01:30:31.156665 [info ] [MainThread]: 
[0m01:30:31.157097 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.43 seconds (6.43s).
[0m01:30:31.157904 [debug] [MainThread]: Command end result
[0m01:30:31.191319 [info ] [MainThread]: 
[0m01:30:31.191922 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:30:31.192276 [info ] [MainThread]: 
[0m01:30:31.192684 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:30:31.193731 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.4359713, "process_user_time": 3.544067, "process_kernel_time": 0.193112, "process_mem_max_rss": "213392", "process_out_blocks": "1920", "process_in_blocks": "0"}
[0m01:30:31.194230 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:30:31.194150 after 7.44 seconds
[0m01:30:31.194628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89547050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84c65be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84c64d10>]}
[0m01:30:31.194980 [debug] [MainThread]: Flushing usage events
[0m01:30:02.950239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ba2d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff898acb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a113020>]}


============================== 01:30:02.956915 | 2700c20e-d1b4-4154-a51a-b769d19ec1b9 ==============================
[0m01:30:02.956915 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:30:02.957457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:30:03.641276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2700c20e-d1b4-4154-a51a-b769d19ec1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69075bb0>]}
[0m01:30:03.675186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2700c20e-d1b4-4154-a51a-b769d19ec1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69690620>]}
[0m01:30:03.675860 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:30:03.759532 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:30:03.860663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:30:03.861104 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:30:03.897612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2700c20e-d1b4-4154-a51a-b769d19ec1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63fa6360>]}
[0m01:30:03.984714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2700c20e-d1b4-4154-a51a-b769d19ec1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63ddc260>]}
[0m01:30:03.985249 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m01:30:03.985619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2700c20e-d1b4-4154-a51a-b769d19ec1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89346150>]}
[0m01:30:03.987299 [info ] [MainThread]: 
[0m01:30:03.987818 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:30:03.991347 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m01:30:04.002619 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m01:30:04.002981 [debug] [ThreadPool]: On list_USER_DB_PARROT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
show terse schemas in database USER_DB_PARROT
    limit 10000
[0m01:30:04.003286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:04.735445 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.732 seconds
[0m01:30:04.736998 [debug] [ThreadPool]: On list_USER_DB_PARROT: Close
[0m01:30:04.872387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT)
[0m01:30:04.879121 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_SNAP'
[0m01:30:04.881002 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m01:30:04.882749 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m01:30:04.883135 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m01:30:04.883522 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m01:30:04.883882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:30:04.884242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:05.446911 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.562 seconds
[0m01:30:05.450337 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m01:30:05.867335 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.983 seconds
[0m01:30:05.869090 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m01:30:06.118046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2700c20e-d1b4-4154-a51a-b769d19ec1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63fa6420>]}
[0m01:30:06.119410 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:30:06.120039 [info ] [MainThread]: 
[0m01:30:06.133796 [debug] [Thread-1 (]: Began running node model.crypto_analytics_dbt.stg_crypto_prices
[0m01:30:06.134586 [info ] [Thread-1 (]: 1 of 3 START sql view model PARROT_FEAT_PARROT_FEAT.stg_crypto_prices .......... [RUN]
[0m01:30:06.135204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now model.crypto_analytics_dbt.stg_crypto_prices)
[0m01:30:06.135584 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics_dbt.stg_crypto_prices
[0m01:30:06.142998 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics_dbt.stg_crypto_prices"
[0m01:30:06.145732 [debug] [Thread-1 (]: Began executing node model.crypto_analytics_dbt.stg_crypto_prices
[0m01:30:06.168904 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics_dbt.stg_crypto_prices"
[0m01:30:06.171061 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_analytics_dbt.stg_crypto_prices"
[0m01:30:06.171499 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.stg_crypto_prices"} */
create or replace   view USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
  
   as (
    

select
  upper(symbol)                                      as symbol,
  cast(price_date as date)                           as price_date,
  cast(open as number(38,8))                         as open,
  cast(high as number(38,8))                         as high,
  cast(low as number(38,8))                          as low,
  cast(close as number(38,8))                        as close,
  cast(adj_close as number(38,8))                    as adj_close,
  cast(volume as number(38,8))                       as volume
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES
  );
[0m01:30:06.171884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:07.271071 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.099 seconds
[0m01:30:07.292447 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.stg_crypto_prices: Close
[0m01:30:07.648886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2700c20e-d1b4-4154-a51a-b769d19ec1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68135ee0>]}
[0m01:30:07.651593 [info ] [Thread-1 (]: 1 of 3 OK created sql view model PARROT_FEAT_PARROT_FEAT.stg_crypto_prices ..... [[32mSUCCESS 1[0m in 1.51s]
[0m01:30:07.653485 [debug] [Thread-1 (]: Finished running node model.crypto_analytics_dbt.stg_crypto_prices
[0m01:30:07.655418 [debug] [Thread-2 (]: Began running node model.crypto_analytics_dbt.int_crypto_features
[0m01:30:07.656281 [info ] [Thread-2 (]: 2 of 3 START sql table model PARROT_FEAT_PARROT_FEAT.int_crypto_features ....... [RUN]
[0m01:30:07.657014 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_SNAP, now model.crypto_analytics_dbt.int_crypto_features)
[0m01:30:07.657499 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics_dbt.int_crypto_features
[0m01:30:07.662369 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics_dbt.int_crypto_features"
[0m01:30:07.666446 [debug] [Thread-2 (]: Began executing node model.crypto_analytics_dbt.int_crypto_features
[0m01:30:07.685511 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics_dbt.int_crypto_features"
[0m01:30:07.688534 [debug] [Thread-2 (]: Using snowflake connection "model.crypto_analytics_dbt.int_crypto_features"
[0m01:30:07.689021 [debug] [Thread-2 (]: On model.crypto_analytics_dbt.int_crypto_features: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.int_crypto_features"} */
create or replace transient table USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
         as
        (

with base as (
  select *
  from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
)
select
  symbol,
  price_date,
  close,
  avg(close) over (partition by symbol order by price_date rows between 4 preceding and current row)  as sma_5,
  avg(close) over (partition by symbol order by price_date rows between 19 preceding and current row) as sma_20,
  avg(close) over (partition by symbol order by price_date rows between 49 preceding and current row) as sma_50,
  (close / nullif(lag(close,5) over (partition by symbol order by price_date),0) - 1) * 100 as momentum_5d_pct
from base
        );
[0m01:30:07.689367 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:30:10.039609 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.349 seconds
[0m01:30:10.047507 [debug] [Thread-2 (]: On model.crypto_analytics_dbt.int_crypto_features: Close
[0m01:30:10.207427 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2700c20e-d1b4-4154-a51a-b769d19ec1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6316b7d0>]}
[0m01:30:10.209608 [info ] [Thread-2 (]: 2 of 3 OK created sql table model PARROT_FEAT_PARROT_FEAT.int_crypto_features .. [[32mSUCCESS 1[0m in 2.55s]
[0m01:30:10.211108 [debug] [Thread-2 (]: Finished running node model.crypto_analytics_dbt.int_crypto_features
[0m01:30:10.215047 [debug] [Thread-1 (]: Began running node model.crypto_analytics_dbt.mart_crypto_summary
[0m01:30:10.216468 [info ] [Thread-1 (]: 3 of 3 START sql table model PARROT_FEAT_PARROT_FEAT.mart_crypto_summary ....... [RUN]
[0m01:30:10.217402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics_dbt.stg_crypto_prices, now model.crypto_analytics_dbt.mart_crypto_summary)
[0m01:30:10.217893 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics_dbt.mart_crypto_summary
[0m01:30:10.223982 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics_dbt.mart_crypto_summary"
[0m01:30:10.226745 [debug] [Thread-1 (]: Began executing node model.crypto_analytics_dbt.mart_crypto_summary
[0m01:30:10.229561 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics_dbt.mart_crypto_summary"
[0m01:30:10.231002 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_analytics_dbt.mart_crypto_summary"
[0m01:30:10.231474 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.mart_crypto_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.mart_crypto_summary"} */
create or replace transient table USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
         as
        (

select
  symbol,
  price_date,
  close,
  sma_5,
  sma_20,
  sma_50,
  momentum_5d_pct,
  case when sma_5 > sma_20 then 1 else 0 end as bull_signal_cross
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
order by price_date, symbol
        );
[0m01:30:10.231849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:11.676835 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.445 seconds
[0m01:30:11.681454 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.mart_crypto_summary: Close
[0m01:30:11.781146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2700c20e-d1b4-4154-a51a-b769d19ec1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff631be240>]}
[0m01:30:11.782815 [info ] [Thread-1 (]: 3 of 3 OK created sql table model PARROT_FEAT_PARROT_FEAT.mart_crypto_summary .. [[32mSUCCESS 1[0m in 1.56s]
[0m01:30:11.783943 [debug] [Thread-1 (]: Finished running node model.crypto_analytics_dbt.mart_crypto_summary
[0m01:30:11.787082 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:30:11.787825 [debug] [MainThread]: Connection 'model.crypto_analytics_dbt.mart_crypto_summary' was properly closed.
[0m01:30:11.788290 [debug] [MainThread]: Connection 'model.crypto_analytics_dbt.int_crypto_features' was properly closed.
[0m01:30:11.789086 [info ] [MainThread]: 
[0m01:30:11.789718 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 7.80 seconds (7.80s).
[0m01:30:11.791064 [debug] [MainThread]: Command end result
[0m01:30:11.827618 [info ] [MainThread]: 
[0m01:30:11.828251 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:30:11.828591 [info ] [MainThread]: 
[0m01:30:11.829006 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:30:11.831220 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.914589, "process_user_time": 3.666787, "process_kernel_time": 0.353654, "process_mem_max_rss": "213144", "process_out_blocks": "1921", "process_in_blocks": "0"}
[0m01:30:11.831946 [debug] [MainThread]: Command `dbt run` succeeded at 01:30:11.831864 after 8.92 seconds
[0m01:30:11.832492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af1cfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f3ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63f0bd10>]}
[0m01:30:11.833033 [debug] [MainThread]: Flushing usage events
[0m01:30:15.073441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fbd8da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d337740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d148ce0>]}


============================== 01:30:15.079191 | 318d6f96-928a-403c-82ae-9352b34b9d47 ==============================
[0m01:30:15.079191 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:30:15.079702 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:30:15.726052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '318d6f96-928a-403c-82ae-9352b34b9d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff57798770>]}
[0m01:30:15.760209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '318d6f96-928a-403c-82ae-9352b34b9d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff57e428a0>]}
[0m01:30:15.760876 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:30:15.833505 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:30:15.947287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:30:15.947744 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:30:15.985637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '318d6f96-928a-403c-82ae-9352b34b9d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff57842d50>]}
[0m01:30:16.085881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '318d6f96-928a-403c-82ae-9352b34b9d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5727e060>]}
[0m01:30:16.086428 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m01:30:16.086817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '318d6f96-928a-403c-82ae-9352b34b9d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5745f440>]}
[0m01:30:16.088523 [info ] [MainThread]: 
[0m01:30:16.089075 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:30:16.092554 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT'
[0m01:30:16.100623 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_SNAP'
[0m01:30:16.105976 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m01:30:16.107684 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m01:30:16.108047 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m01:30:16.108412 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m01:30:16.108811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:16.109120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:16.568353 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.459 seconds
[0m01:30:16.571818 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m01:30:16.632440 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.523 seconds
[0m01:30:16.635867 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m01:30:16.759484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '318d6f96-928a-403c-82ae-9352b34b9d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5782a360>]}
[0m01:30:16.760812 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:30:16.761536 [info ] [MainThread]: 
[0m01:30:16.773364 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m01:30:16.774292 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m01:30:16.774720 [info ] [Thread-1 (]: 1 of 6 START test not_null_int_crypto_features_price_date ...................... [RUN]
[0m01:30:16.775263 [info ] [Thread-2 (]: 2 of 6 START test not_null_int_crypto_features_symbol .......................... [RUN]
[0m01:30:16.775829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_SNAP, now test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6)
[0m01:30:16.776322 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2)
[0m01:30:16.776742 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m01:30:16.777147 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m01:30:16.790628 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m01:30:16.793810 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m01:30:16.795449 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m01:30:16.795743 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m01:30:16.813223 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m01:30:16.814449 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m01:30:16.816335 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m01:30:16.816913 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m01:30:16.817232 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
where price_date is null



      
    ) dbt_internal_test
[0m01:30:16.817593 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
where symbol is null



      
    ) dbt_internal_test
[0m01:30:16.817970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:16.818270 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:30:17.237277 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.417 seconds
[0m01:30:17.247858 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2: Close
[0m01:30:17.402006 [info ] [Thread-2 (]: 2 of 6 PASS not_null_int_crypto_features_symbol ................................ [[32mPASS[0m in 0.62s]
[0m01:30:17.403644 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m01:30:17.404518 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m01:30:17.405160 [info ] [Thread-2 (]: 3 of 6 START test not_null_mart_crypto_summary_price_date ...................... [RUN]
[0m01:30:17.405940 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2, now test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b)
[0m01:30:17.406484 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m01:30:17.412823 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m01:30:17.414400 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m01:30:17.417166 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m01:30:17.418452 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m01:30:17.418867 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
where price_date is null



      
    ) dbt_internal_test
[0m01:30:17.419318 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:30:17.566138 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.747 seconds
[0m01:30:17.569929 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6: Close
[0m01:30:17.747691 [info ] [Thread-1 (]: 1 of 6 PASS not_null_int_crypto_features_price_date ............................ [[32mPASS[0m in 0.97s]
[0m01:30:17.749190 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m01:30:17.749947 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m01:30:17.750654 [info ] [Thread-1 (]: 4 of 6 START test not_null_mart_crypto_summary_symbol .......................... [RUN]
[0m01:30:17.751342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6, now test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce)
[0m01:30:17.751854 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m01:30:17.758513 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m01:30:17.760287 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m01:30:17.763356 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m01:30:17.765032 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m01:30:17.765475 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
where symbol is null



      
    ) dbt_internal_test
[0m01:30:17.765887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:18.536488 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.117 seconds
[0m01:30:18.540624 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b: Close
[0m01:30:18.546959 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.781 seconds
[0m01:30:18.549443 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce: Close
[0m01:30:18.668644 [info ] [Thread-1 (]: 4 of 6 PASS not_null_mart_crypto_summary_symbol ................................ [[32mPASS[0m in 0.92s]
[0m01:30:18.670077 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m01:30:18.670848 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m01:30:18.671600 [info ] [Thread-1 (]: 5 of 6 START test not_null_stg_crypto_prices_price_date ........................ [RUN]
[0m01:30:18.672449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce, now test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314)
[0m01:30:18.673058 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m01:30:18.681070 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m01:30:18.684284 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m01:30:18.687334 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m01:30:18.688775 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m01:30:18.689227 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
where price_date is null



      
    ) dbt_internal_test
[0m01:30:18.689804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:18.785325 [info ] [Thread-2 (]: 3 of 6 PASS not_null_mart_crypto_summary_price_date ............................ [[32mPASS[0m in 1.38s]
[0m01:30:18.786635 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m01:30:18.787243 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m01:30:18.787717 [info ] [Thread-2 (]: 6 of 6 START test not_null_stg_crypto_prices_symbol ............................ [RUN]
[0m01:30:18.788894 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b, now test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a)
[0m01:30:18.789788 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m01:30:18.794600 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m01:30:18.802019 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m01:30:18.805862 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m01:30:18.806928 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m01:30:18.807400 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
where symbol is null



      
    ) dbt_internal_test
[0m01:30:18.807982 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:30:19.313036 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.623 seconds
[0m01:30:19.316923 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314: Close
[0m01:30:19.518952 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.710 seconds
[0m01:30:19.523045 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a: Close
[0m01:30:19.635209 [info ] [Thread-2 (]: 6 of 6 PASS not_null_stg_crypto_prices_symbol .................................. [[32mPASS[0m in 0.85s]
[0m01:30:19.636592 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m01:30:19.714523 [info ] [Thread-1 (]: 5 of 6 PASS not_null_stg_crypto_prices_price_date .............................. [[32mPASS[0m in 1.04s]
[0m01:30:19.715834 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m01:30:19.717982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:30:19.718508 [debug] [MainThread]: Connection 'test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a' was properly closed.
[0m01:30:19.718875 [debug] [MainThread]: Connection 'test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314' was properly closed.
[0m01:30:19.719588 [info ] [MainThread]: 
[0m01:30:19.720145 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 3.63 seconds (3.63s).
[0m01:30:19.721616 [debug] [MainThread]: Command end result
[0m01:30:19.753069 [info ] [MainThread]: 
[0m01:30:19.753623 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:30:19.753984 [info ] [MainThread]: 
[0m01:30:19.754342 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m01:30:19.755248 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.713717, "process_user_time": 3.68153, "process_kernel_time": 0.225935, "process_mem_max_rss": "214628", "process_out_blocks": "1936", "process_in_blocks": "0"}
[0m01:30:19.755760 [debug] [MainThread]: Command `dbt test` succeeded at 01:30:19.755677 after 4.71 seconds
[0m01:30:19.756143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7df59e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5745e2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d762d20>]}
[0m01:30:19.756546 [debug] [MainThread]: Flushing usage events
[0m01:30:22.810631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2485670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2044f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2044fe0>]}


============================== 01:30:22.816505 | b7650f29-7ca9-4f9e-abae-b7c2417b4880 ==============================
[0m01:30:22.816505 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:30:22.817130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:30:23.476124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7650f29-7ca9-4f9e-abae-b7c2417b4880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4cb88f0>]}
[0m01:30:23.510325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7650f29-7ca9-4f9e-abae-b7c2417b4880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff918fb020>]}
[0m01:30:23.511055 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:30:23.584405 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:30:23.688710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:30:23.689167 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:30:23.727446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7650f29-7ca9-4f9e-abae-b7c2417b4880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fb20f0>]}
[0m01:30:23.819171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7650f29-7ca9-4f9e-abae-b7c2417b4880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff907124e0>]}
[0m01:30:23.819900 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m01:30:23.820325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7650f29-7ca9-4f9e-abae-b7c2417b4880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90e331a0>]}
[0m01:30:23.822169 [info ] [MainThread]: 
[0m01:30:23.822945 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:30:23.823831 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m01:30:23.835405 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m01:30:23.835810 [debug] [ThreadPool]: On list_USER_DB_PARROT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
show terse schemas in database USER_DB_PARROT
    limit 10000
[0m01:30:23.836115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:24.272950 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.437 seconds
[0m01:30:24.274888 [debug] [ThreadPool]: On list_USER_DB_PARROT: Close
[0m01:30:24.559403 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now list_USER_DB_PARROT_PARROT_SNAP)
[0m01:30:24.566701 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT'
[0m01:30:24.568538 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m01:30:24.570207 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m01:30:24.570595 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m01:30:24.570943 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m01:30:24.571286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:30:24.571605 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:24.933733 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.362 seconds
[0m01:30:24.938320 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m01:30:24.995199 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.424 seconds
[0m01:30:24.996974 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m01:30:25.093602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7650f29-7ca9-4f9e-abae-b7c2417b4880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93ebaab0>]}
[0m01:30:25.094778 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:30:25.095425 [info ] [MainThread]: 
[0m01:30:25.106947 [debug] [Thread-1 (]: Began running node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m01:30:25.107515 [info ] [Thread-1 (]: 1 of 1 START snapshot PARROT_SNAP.crypto_prices_snapshot ....................... [RUN]
[0m01:30:25.107960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_SNAP, now snapshot.crypto_analytics_dbt.crypto_prices_snapshot)
[0m01:30:25.108309 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m01:30:25.115740 [debug] [Thread-1 (]: Began executing node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m01:30:25.154632 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:25.155049 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m01:30:25.155494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:26.113760 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.958 seconds
[0m01:30:26.151458 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:26.152066 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
create or replace temporary table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
    SYMBOL,
    PRICE_DATE,
    OPEN,
    HIGH,
    LOW,
    CLOSE,
    ADJ_CLOSE,
    VOLUME,
    INGESTED_AT
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES


    ),

    snapshotted_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    

        from "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            
  
  coalesce(nullif(INGESTED_AT, INGESTED_AT), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol || to_char(price_date) as varchar ), '')
         || '|' || coalesce(cast(INGESTED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            INGESTED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.INGESTED_AT))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.INGESTED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m01:30:27.661351 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.509 seconds
[0m01:30:27.664998 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:27.665408 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m01:30:27.857839 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.192 seconds
[0m01:30:27.867076 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:27.867842 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m01:30:28.017786 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.149 seconds
[0m01:30:28.023883 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:28.024606 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m01:30:28.126570 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.101 seconds
[0m01:30:28.137061 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:28.140913 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m01:30:28.241814 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.099 seconds
[0m01:30:28.251466 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:28.252105 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m01:30:28.330982 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.078 seconds
[0m01:30:28.356588 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:28.357577 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
select * from (
        

    with snapshot_query as (

        



select
    SYMBOL,
    PRICE_DATE,
    OPEN,
    HIGH,
    LOW,
    CLOSE,
    ADJ_CLOSE,
    VOLUME,
    INGESTED_AT
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES


    ),

    snapshotted_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    

        from "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            
  
  coalesce(nullif(INGESTED_AT, INGESTED_AT), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol || to_char(price_date) as varchar ), '')
         || '|' || coalesce(cast(INGESTED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            INGESTED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.INGESTED_AT))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.INGESTED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m01:30:28.709866 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.351 seconds
[0m01:30:28.716183 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:28.716796 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:30:28.825838 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.108 seconds
[0m01:30:28.827973 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:28.831855 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:28.832462 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
BEGIN
[0m01:30:29.006671 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.173 seconds
[0m01:30:29.007906 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:29.008514 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
merge into "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "PRICE_DATE", "OPEN", "HIGH", "LOW", "CLOSE", "ADJ_CLOSE", "VOLUME", "INGESTED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "PRICE_DATE", "OPEN", "HIGH", "LOW", "CLOSE", "ADJ_CLOSE", "VOLUME", "INGESTED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:30:29.974764 [debug] [Thread-1 (]: SQL status: SUCCESS 1458 in 0.965 seconds
[0m01:30:29.976313 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:29.976856 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
COMMIT
[0m01:30:30.417412 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.440 seconds
[0m01:30:30.444519 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: Close
[0m01:30:30.536499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7650f29-7ca9-4f9e-abae-b7c2417b4880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90a82270>]}
[0m01:30:30.538226 [info ] [Thread-1 (]: 1 of 1 OK snapshotted PARROT_SNAP.crypto_prices_snapshot ....................... [[32mSUCCESS 1458[0m in 5.43s]
[0m01:30:30.539581 [debug] [Thread-1 (]: Finished running node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m01:30:30.542691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:30:30.543212 [debug] [MainThread]: Connection 'snapshot.crypto_analytics_dbt.crypto_prices_snapshot' was properly closed.
[0m01:30:30.543635 [debug] [MainThread]: Connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT' was properly closed.
[0m01:30:30.544163 [info ] [MainThread]: 
[0m01:30:30.545147 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.72 seconds (6.72s).
[0m01:30:30.549178 [debug] [MainThread]: Command end result
[0m01:30:30.593527 [info ] [MainThread]: 
[0m01:30:30.594295 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:30:30.594627 [info ] [MainThread]: 
[0m01:30:30.594978 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:30:30.597304 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.8207297, "process_user_time": 3.555025, "process_kernel_time": 0.249071, "process_mem_max_rss": "213584", "process_out_blocks": "1920", "process_in_blocks": "0"}
[0m01:30:30.598523 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:30:30.598387 after 7.82 seconds
[0m01:30:30.599228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2f9f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c6b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90c6a570>]}
[0m01:30:30.599926 [debug] [MainThread]: Flushing usage events
[0m01:31:40.680858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ede4e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8183e6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f24d520>]}


============================== 01:31:40.686763 | 0c5ec3b2-2a05-4e35-9cdd-78557927cdcc ==============================
[0m01:31:40.686763 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:31:40.687385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:31:41.368954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c5ec3b2-2a05-4e35-9cdd-78557927cdcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e522e10>]}
[0m01:31:41.406692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c5ec3b2-2a05-4e35-9cdd-78557927cdcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5efd37d0>]}
[0m01:31:41.407885 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:31:41.493700 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:31:41.678665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:31:41.679305 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:31:41.785039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c5ec3b2-2a05-4e35-9cdd-78557927cdcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d71e510>]}
[0m01:31:41.966742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c5ec3b2-2a05-4e35-9cdd-78557927cdcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d52c9e0>]}
[0m01:31:41.967385 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m01:31:41.967926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c5ec3b2-2a05-4e35-9cdd-78557927cdcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d40c6e0>]}
[0m01:31:41.969664 [info ] [MainThread]: 
[0m01:31:41.970227 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:31:41.973964 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m01:31:41.986061 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m01:31:41.986539 [debug] [ThreadPool]: On list_USER_DB_PARROT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
show terse schemas in database USER_DB_PARROT
    limit 10000
[0m01:31:41.986853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:43.153656 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.167 seconds
[0m01:31:43.155793 [debug] [ThreadPool]: On list_USER_DB_PARROT: Close
[0m01:31:44.175997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT)
[0m01:31:44.177097 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_SNAP'
[0m01:31:44.187951 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m01:31:44.190479 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m01:31:44.191049 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m01:31:44.191672 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m01:31:44.192071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:31:44.192499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:44.857402 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.665 seconds
[0m01:31:44.860530 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m01:31:45.152929 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.961 seconds
[0m01:31:45.156144 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m01:31:45.570728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c5ec3b2-2a05-4e35-9cdd-78557927cdcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea0b2c0>]}
[0m01:31:45.571811 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:31:45.572344 [info ] [MainThread]: 
[0m01:31:45.582056 [debug] [Thread-1 (]: Began running node model.crypto_analytics_dbt.stg_crypto_prices
[0m01:31:45.582674 [info ] [Thread-1 (]: 1 of 3 START sql view model PARROT_FEAT_PARROT_FEAT.stg_crypto_prices .......... [RUN]
[0m01:31:45.583123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_SNAP, now model.crypto_analytics_dbt.stg_crypto_prices)
[0m01:31:45.583475 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics_dbt.stg_crypto_prices
[0m01:31:45.590084 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics_dbt.stg_crypto_prices"
[0m01:31:45.592028 [debug] [Thread-1 (]: Began executing node model.crypto_analytics_dbt.stg_crypto_prices
[0m01:31:45.612775 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics_dbt.stg_crypto_prices"
[0m01:31:45.614621 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_analytics_dbt.stg_crypto_prices"
[0m01:31:45.615010 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.stg_crypto_prices"} */
create or replace   view USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
  
   as (
    

select
  upper(symbol)                                      as symbol,
  cast(price_date as date)                           as price_date,
  cast(open as number(38,8))                         as open,
  cast(high as number(38,8))                         as high,
  cast(low as number(38,8))                          as low,
  cast(close as number(38,8))                        as close,
  cast(adj_close as number(38,8))                    as adj_close,
  cast(volume as number(38,8))                       as volume
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES
  );
[0m01:31:45.615378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:31:46.131963 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.516 seconds
[0m01:31:46.159123 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.stg_crypto_prices: Close
[0m01:31:46.313587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c5ec3b2-2a05-4e35-9cdd-78557927cdcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f6447d0>]}
[0m01:31:46.314847 [info ] [Thread-1 (]: 1 of 3 OK created sql view model PARROT_FEAT_PARROT_FEAT.stg_crypto_prices ..... [[32mSUCCESS 1[0m in 0.73s]
[0m01:31:46.315699 [debug] [Thread-1 (]: Finished running node model.crypto_analytics_dbt.stg_crypto_prices
[0m01:31:46.317126 [debug] [Thread-2 (]: Began running node model.crypto_analytics_dbt.int_crypto_features
[0m01:31:46.317836 [info ] [Thread-2 (]: 2 of 3 START sql table model PARROT_FEAT_PARROT_FEAT.int_crypto_features ....... [RUN]
[0m01:31:46.318465 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now model.crypto_analytics_dbt.int_crypto_features)
[0m01:31:46.318852 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics_dbt.int_crypto_features
[0m01:31:46.322517 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics_dbt.int_crypto_features"
[0m01:31:46.324871 [debug] [Thread-2 (]: Began executing node model.crypto_analytics_dbt.int_crypto_features
[0m01:31:46.341285 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics_dbt.int_crypto_features"
[0m01:31:46.343131 [debug] [Thread-2 (]: Using snowflake connection "model.crypto_analytics_dbt.int_crypto_features"
[0m01:31:46.343559 [debug] [Thread-2 (]: On model.crypto_analytics_dbt.int_crypto_features: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.int_crypto_features"} */
create or replace transient table USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
         as
        (

with base as (
  select *
  from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
)
select
  symbol,
  price_date,
  close,
  avg(close) over (partition by symbol order by price_date rows between 4 preceding and current row)  as sma_5,
  avg(close) over (partition by symbol order by price_date rows between 19 preceding and current row) as sma_20,
  avg(close) over (partition by symbol order by price_date rows between 49 preceding and current row) as sma_50,
  (close / nullif(lag(close,5) over (partition by symbol order by price_date),0) - 1) * 100 as momentum_5d_pct
from base
        );
[0m01:31:46.343971 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:32:04.951766 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 18.607 seconds
[0m01:32:04.956158 [debug] [Thread-2 (]: On model.crypto_analytics_dbt.int_crypto_features: Close
[0m01:32:05.215978 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c5ec3b2-2a05-4e35-9cdd-78557927cdcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5c73b8c0>]}
[0m01:32:05.217387 [info ] [Thread-2 (]: 2 of 3 OK created sql table model PARROT_FEAT_PARROT_FEAT.int_crypto_features .. [[32mSUCCESS 1[0m in 18.90s]
[0m01:32:05.218263 [debug] [Thread-2 (]: Finished running node model.crypto_analytics_dbt.int_crypto_features
[0m01:32:05.219370 [debug] [Thread-1 (]: Began running node model.crypto_analytics_dbt.mart_crypto_summary
[0m01:32:05.220143 [info ] [Thread-1 (]: 3 of 3 START sql table model PARROT_FEAT_PARROT_FEAT.mart_crypto_summary ....... [RUN]
[0m01:32:05.220707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics_dbt.stg_crypto_prices, now model.crypto_analytics_dbt.mart_crypto_summary)
[0m01:32:05.221078 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics_dbt.mart_crypto_summary
[0m01:32:05.226692 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics_dbt.mart_crypto_summary"
[0m01:32:05.227754 [debug] [Thread-1 (]: Began executing node model.crypto_analytics_dbt.mart_crypto_summary
[0m01:32:05.230061 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics_dbt.mart_crypto_summary"
[0m01:32:05.231421 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_analytics_dbt.mart_crypto_summary"
[0m01:32:05.231922 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.mart_crypto_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.mart_crypto_summary"} */
create or replace transient table USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
         as
        (

select
  symbol,
  price_date,
  close,
  sma_5,
  sma_20,
  sma_50,
  momentum_5d_pct,
  case when sma_5 > sma_20 then 1 else 0 end as bull_signal_cross
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
order by price_date, symbol
        );
[0m01:32:05.232378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:06.470835 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.238 seconds
[0m01:32:06.474304 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.mart_crypto_summary: Close
[0m01:32:06.803869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c5ec3b2-2a05-4e35-9cdd-78557927cdcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5c738c20>]}
[0m01:32:06.804801 [info ] [Thread-1 (]: 3 of 3 OK created sql table model PARROT_FEAT_PARROT_FEAT.mart_crypto_summary .. [[32mSUCCESS 1[0m in 1.58s]
[0m01:32:06.805505 [debug] [Thread-1 (]: Finished running node model.crypto_analytics_dbt.mart_crypto_summary
[0m01:32:06.807531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:32:06.807986 [debug] [MainThread]: Connection 'model.crypto_analytics_dbt.int_crypto_features' was properly closed.
[0m01:32:06.808353 [debug] [MainThread]: Connection 'model.crypto_analytics_dbt.mart_crypto_summary' was properly closed.
[0m01:32:06.808856 [info ] [MainThread]: 
[0m01:32:06.809266 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 24.84 seconds (24.84s).
[0m01:32:06.810196 [debug] [MainThread]: Command end result
[0m01:32:06.841183 [info ] [MainThread]: 
[0m01:32:06.841755 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:32:06.842037 [info ] [MainThread]: 
[0m01:32:06.842399 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:32:06.843680 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 26.196173, "process_user_time": 4.072241, "process_kernel_time": 0.665939, "process_mem_max_rss": "215260", "process_out_blocks": "3873", "process_in_blocks": "0"}
[0m01:32:06.844289 [debug] [MainThread]: Command `dbt run` succeeded at 01:32:06.844156 after 26.20 seconds
[0m01:32:06.844992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ede4e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f6447d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f114ec0>]}
[0m01:32:06.845508 [debug] [MainThread]: Flushing usage events
[0m02:21:04.920390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f2eaf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7fe240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f2e8890>]}


============================== 02:21:04.926372 | 534f60b6-fd5f-4db0-9e3b-74a2a390a737 ==============================
[0m02:21:04.926372 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:21:04.926906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m02:21:05.575392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '534f60b6-fd5f-4db0-9e3b-74a2a390a737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9006be30>]}
[0m02:21:05.610445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '534f60b6-fd5f-4db0-9e3b-74a2a390a737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fb28c80>]}
[0m02:21:05.611258 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:21:05.681393 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:21:05.779669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:21:05.780100 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:21:05.816822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '534f60b6-fd5f-4db0-9e3b-74a2a390a737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d406270>]}
[0m02:21:05.913109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '534f60b6-fd5f-4db0-9e3b-74a2a390a737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ce0ec00>]}
[0m02:21:05.913655 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m02:21:05.913997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '534f60b6-fd5f-4db0-9e3b-74a2a390a737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d1ea420>]}
[0m02:21:05.915650 [info ] [MainThread]: 
[0m02:21:05.916204 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:21:05.919783 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_SNAP'
[0m02:21:05.927487 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT'
[0m02:21:05.938639 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m02:21:05.939150 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m02:21:05.939503 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m02:21:05.939871 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m02:21:05.940206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:21:05.940529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:21:06.597557 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.657 seconds
[0m02:21:06.600799 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m02:21:07.082534 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.142 seconds
[0m02:21:07.085634 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m02:21:07.215564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '534f60b6-fd5f-4db0-9e3b-74a2a390a737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d3e9010>]}
[0m02:21:07.216696 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m02:21:07.217300 [info ] [MainThread]: 
[0m02:21:07.229856 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m02:21:07.230786 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m02:21:07.231264 [info ] [Thread-1 (]: 1 of 6 START test not_null_int_crypto_features_price_date ...................... [RUN]
[0m02:21:07.231914 [info ] [Thread-2 (]: 2 of 6 START test not_null_int_crypto_features_symbol .......................... [RUN]
[0m02:21:07.232553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6)
[0m02:21:07.233043 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_SNAP, now test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2)
[0m02:21:07.233519 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m02:21:07.233942 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m02:21:07.247791 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m02:21:07.250880 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m02:21:07.252397 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m02:21:07.267578 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m02:21:07.267962 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m02:21:07.271321 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m02:21:07.272632 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m02:21:07.273179 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m02:21:07.273504 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
where symbol is null



      
    ) dbt_internal_test
[0m02:21:07.273897 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
where price_date is null



      
    ) dbt_internal_test
[0m02:21:07.274283 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:21:07.274592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:21:24.024433 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 16.749 seconds
[0m02:21:24.026393 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 16.752 seconds
[0m02:21:24.040477 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6: Close
[0m02:21:24.044427 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2: Close
[0m02:21:24.147298 [info ] [Thread-1 (]: 1 of 6 PASS not_null_int_crypto_features_price_date ............................ [[32mPASS[0m in 16.91s]
[0m02:21:24.148623 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m02:21:24.149432 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m02:21:24.150114 [info ] [Thread-1 (]: 3 of 6 START test not_null_mart_crypto_summary_price_date ...................... [RUN]
[0m02:21:24.150807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6, now test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b)
[0m02:21:24.151398 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m02:21:24.157550 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m02:21:24.159335 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m02:21:24.162404 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m02:21:24.163719 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m02:21:24.164150 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
where price_date is null



      
    ) dbt_internal_test
[0m02:21:24.164502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:21:24.199317 [info ] [Thread-2 (]: 2 of 6 PASS not_null_int_crypto_features_symbol ................................ [[32mPASS[0m in 16.97s]
[0m02:21:24.200113 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m02:21:24.200612 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m02:21:24.201038 [info ] [Thread-2 (]: 4 of 6 START test not_null_mart_crypto_summary_symbol .......................... [RUN]
[0m02:21:24.201537 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2, now test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce)
[0m02:21:24.201910 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m02:21:24.205541 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m02:21:24.206811 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m02:21:24.208718 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m02:21:24.209803 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m02:21:24.210158 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
where symbol is null



      
    ) dbt_internal_test
[0m02:21:24.210474 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:21:25.321383 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.110 seconds
[0m02:21:25.325480 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce: Close
[0m02:21:25.326955 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.162 seconds
[0m02:21:25.330152 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b: Close
[0m02:21:25.430616 [info ] [Thread-1 (]: 3 of 6 PASS not_null_mart_crypto_summary_price_date ............................ [[32mPASS[0m in 1.28s]
[0m02:21:25.431944 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m02:21:25.432659 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m02:21:25.433247 [info ] [Thread-1 (]: 5 of 6 START test not_null_stg_crypto_prices_price_date ........................ [RUN]
[0m02:21:25.434006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b, now test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314)
[0m02:21:25.434492 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m02:21:25.440524 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m02:21:25.443012 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m02:21:25.445613 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m02:21:25.446873 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m02:21:25.447290 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
where price_date is null



      
    ) dbt_internal_test
[0m02:21:25.447657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:21:25.466199 [info ] [Thread-2 (]: 4 of 6 PASS not_null_mart_crypto_summary_symbol ................................ [[32mPASS[0m in 1.26s]
[0m02:21:25.466875 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m02:21:25.467311 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m02:21:25.467674 [info ] [Thread-2 (]: 6 of 6 START test not_null_stg_crypto_prices_symbol ............................ [RUN]
[0m02:21:25.468105 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce, now test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a)
[0m02:21:25.468450 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m02:21:25.472114 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m02:21:25.473147 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m02:21:25.476674 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m02:21:25.477651 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m02:21:25.477959 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
where symbol is null



      
    ) dbt_internal_test
[0m02:21:25.478279 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:21:26.033891 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.586 seconds
[0m02:21:26.035909 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314: Close
[0m02:21:26.176465 [info ] [Thread-1 (]: 5 of 6 PASS not_null_stg_crypto_prices_price_date .............................. [[32mPASS[0m in 0.74s]
[0m02:21:26.177918 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m02:21:26.198323 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.720 seconds
[0m02:21:26.203894 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a: Close
[0m02:21:26.322634 [info ] [Thread-2 (]: 6 of 6 PASS not_null_stg_crypto_prices_symbol .................................. [[32mPASS[0m in 0.85s]
[0m02:21:26.323968 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m02:21:26.326526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:21:26.327109 [debug] [MainThread]: Connection 'test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a' was properly closed.
[0m02:21:26.327552 [debug] [MainThread]: Connection 'test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314' was properly closed.
[0m02:21:26.328092 [info ] [MainThread]: 
[0m02:21:26.328596 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 20.41 seconds (20.41s).
[0m02:21:26.330185 [debug] [MainThread]: Command end result
[0m02:21:26.365404 [info ] [MainThread]: 
[0m02:21:26.365867 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:21:26.366188 [info ] [MainThread]: 
[0m02:21:26.366496 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m02:21:26.367513 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 21.480425, "process_user_time": 3.886633, "process_kernel_time": 0.251173, "process_mem_max_rss": "216280", "process_out_blocks": "1936", "process_in_blocks": "0"}
[0m02:21:26.367995 [debug] [MainThread]: Command `dbt test` succeeded at 02:21:26.367919 after 21.48 seconds
[0m02:21:26.368366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7fe240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eaf67e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cf24fb0>]}
[0m02:21:26.368700 [debug] [MainThread]: Flushing usage events
[0m02:21:29.961232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa749d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa69f7c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6a0f860>]}


============================== 02:21:29.966768 | 7caf39fb-d2ae-4def-966d-410403ac8a34 ==============================
[0m02:21:29.966768 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:21:29.967284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:21:30.651038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7caf39fb-d2ae-4def-966d-410403ac8a34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84bd2c30>]}
[0m02:21:30.685530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7caf39fb-d2ae-4def-966d-410403ac8a34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87af2210>]}
[0m02:21:30.686387 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:21:30.752193 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:21:30.849766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:21:30.850220 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:21:30.887690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7caf39fb-d2ae-4def-966d-410403ac8a34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff845fa390>]}
[0m02:21:30.975710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7caf39fb-d2ae-4def-966d-410403ac8a34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff843dbe90>]}
[0m02:21:30.976204 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m02:21:30.976561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7caf39fb-d2ae-4def-966d-410403ac8a34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff845ee870>]}
[0m02:21:30.978193 [info ] [MainThread]: 
[0m02:21:30.978742 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:21:30.979609 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m02:21:30.990633 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m02:21:30.990990 [debug] [ThreadPool]: On list_USER_DB_PARROT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
show terse schemas in database USER_DB_PARROT
    limit 10000
[0m02:21:30.991299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:21:31.839682 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.848 seconds
[0m02:21:31.843190 [debug] [ThreadPool]: On list_USER_DB_PARROT: Close
[0m02:21:31.964207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now list_USER_DB_PARROT_PARROT_SNAP)
[0m02:21:31.971652 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT'
[0m02:21:31.973856 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m02:21:31.975632 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m02:21:31.976028 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m02:21:31.976470 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m02:21:31.976810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:21:31.977161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:33:38.239139 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.486 seconds
[0m03:33:38.239952 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.487 seconds
[0m03:33:38.241500 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m03:33:38.242800 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m03:33:38.363088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7caf39fb-d2ae-4def-966d-410403ac8a34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84186f30>]}
[0m03:33:38.364014 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m03:33:38.364679 [info ] [MainThread]: 
[0m03:33:38.373905 [debug] [Thread-1 (]: Began running node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m03:33:38.374598 [info ] [Thread-1 (]: 1 of 1 START snapshot PARROT_SNAP.crypto_prices_snapshot ....................... [RUN]
[0m03:33:38.375107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_SNAP, now snapshot.crypto_analytics_dbt.crypto_prices_snapshot)
[0m03:33:38.375495 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m03:33:38.382569 [debug] [Thread-1 (]: Began executing node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m03:33:38.423926 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m03:33:38.424507 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m03:33:38.424889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:33:38.776105 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.351 seconds
[0m03:33:38.846035 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m03:33:38.847593 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
create or replace temporary table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
    SYMBOL,
    PRICE_DATE,
    OPEN,
    HIGH,
    LOW,
    CLOSE,
    ADJ_CLOSE,
    VOLUME,
    INGESTED_AT
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES


    ),

    snapshotted_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    

        from "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            
  
  coalesce(nullif(INGESTED_AT, INGESTED_AT), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol || to_char(price_date) as varchar ), '')
         || '|' || coalesce(cast(INGESTED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            INGESTED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.INGESTED_AT))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.INGESTED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m03:33:40.859357 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.010 seconds
[0m03:33:40.865537 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m03:33:40.866332 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m03:33:41.061299 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.194 seconds
[0m03:33:41.071024 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m03:33:41.071742 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m03:33:41.160731 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.088 seconds
[0m03:33:41.167535 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m03:33:41.168195 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m03:33:41.287436 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.119 seconds
[0m03:33:41.293293 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m03:33:41.293958 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m03:33:43.832250 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 2.538 seconds
[0m03:33:43.840594 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m03:33:43.841059 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m03:33:43.976798 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.135 seconds
[0m03:33:43.999608 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m03:33:44.000227 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
select * from (
        

    with snapshot_query as (

        



select
    SYMBOL,
    PRICE_DATE,
    OPEN,
    HIGH,
    LOW,
    CLOSE,
    ADJ_CLOSE,
    VOLUME,
    INGESTED_AT
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES


    ),

    snapshotted_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    

        from "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            
  
  coalesce(nullif(INGESTED_AT, INGESTED_AT), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol || to_char(price_date) as varchar ), '')
         || '|' || coalesce(cast(INGESTED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            INGESTED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.INGESTED_AT))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.INGESTED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m03:33:45.065040 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.064 seconds
[0m03:33:45.073408 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m03:33:45.074008 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:33:45.188717 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.114 seconds
[0m03:33:45.190059 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m03:33:45.194034 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m03:33:45.194569 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
BEGIN
[0m03:33:45.326808 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.131 seconds
[0m03:33:45.327913 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m03:33:45.328513 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
merge into "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "PRICE_DATE", "OPEN", "HIGH", "LOW", "CLOSE", "ADJ_CLOSE", "VOLUME", "INGESTED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "PRICE_DATE", "OPEN", "HIGH", "LOW", "CLOSE", "ADJ_CLOSE", "VOLUME", "INGESTED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m03:33:46.419841 [debug] [Thread-1 (]: SQL status: SUCCESS 1458 in 1.090 seconds
[0m03:33:46.421442 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m03:33:46.421973 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
COMMIT
[0m03:34:03.007762 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 16.585 seconds
[0m03:34:03.036542 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: Close
[0m03:34:03.155367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7caf39fb-d2ae-4def-966d-410403ac8a34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8470dd00>]}
[0m03:34:03.157338 [info ] [Thread-1 (]: 1 of 1 OK snapshotted PARROT_SNAP.crypto_prices_snapshot ....................... [[32mSUCCESS 1458[0m in 24.78s]
[0m03:34:03.158828 [debug] [Thread-1 (]: Finished running node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m03:34:03.161963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:34:03.162520 [debug] [MainThread]: Connection 'snapshot.crypto_analytics_dbt.crypto_prices_snapshot' was properly closed.
[0m03:34:03.162883 [debug] [MainThread]: Connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT' was properly closed.
[0m03:34:03.163432 [info ] [MainThread]: 
[0m03:34:03.163928 [info ] [MainThread]: Finished running 1 snapshot in 1 hours 12 minutes and 32.18 seconds (4352.18s).
[0m03:34:03.164883 [debug] [MainThread]: Command end result
[0m03:34:03.202438 [info ] [MainThread]: 
[0m03:34:03.203002 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:34:03.203334 [info ] [MainThread]: 
[0m03:34:03.203674 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:34:03.205568 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 27.501099, "process_user_time": 3.872799, "process_kernel_time": 0.221099, "process_mem_max_rss": "214052", "process_out_blocks": "1920", "process_in_blocks": "0"}
[0m03:34:03.206325 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:34:03.206229 after 27.50 seconds
[0m03:34:03.206884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa796c9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85196510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5cd4380>]}
[0m03:34:03.207295 [debug] [MainThread]: Flushing usage events
[0m01:30:02.122190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5006030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5dcb020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4d89b20>]}


============================== 01:30:02.128997 | 42ccb775-3e3b-4bf6-9ae1-b0d56df8e996 ==============================
[0m01:30:02.128997 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:30:02.129649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt', 'send_anonymous_usage_stats': 'True'}
[0m01:30:02.760993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42ccb775-3e3b-4bf6-9ae1-b0d56df8e996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f653b90>]}
[0m01:30:02.795012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42ccb775-3e3b-4bf6-9ae1-b0d56df8e996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fe7fc20>]}
[0m01:30:02.795678 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:30:02.862274 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:30:02.961590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:30:02.962029 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:30:02.998944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42ccb775-3e3b-4bf6-9ae1-b0d56df8e996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f502f00>]}
[0m01:30:03.087160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42ccb775-3e3b-4bf6-9ae1-b0d56df8e996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f2a2780>]}
[0m01:30:03.087710 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m01:30:03.088122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42ccb775-3e3b-4bf6-9ae1-b0d56df8e996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84576420>]}
[0m01:30:03.089729 [info ] [MainThread]: 
[0m01:30:03.090265 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:30:03.093722 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m01:30:03.104865 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m01:30:03.105225 [debug] [ThreadPool]: On list_USER_DB_PARROT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
show terse schemas in database USER_DB_PARROT
    limit 10000
[0m01:30:03.105542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:03.903353 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.798 seconds
[0m01:30:03.905964 [debug] [ThreadPool]: On list_USER_DB_PARROT: Close
[0m01:30:04.229112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT)
[0m01:30:04.230361 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_SNAP'
[0m01:30:04.242282 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m01:30:04.244691 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m01:30:04.245285 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m01:30:04.245813 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m01:30:04.246335 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:30:04.246755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:04.753970 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.507 seconds
[0m01:30:04.757743 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m01:30:04.771711 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.525 seconds
[0m01:30:04.774557 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m01:30:05.089803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42ccb775-3e3b-4bf6-9ae1-b0d56df8e996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa60ecc50>]}
[0m01:30:05.091240 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:30:05.091918 [info ] [MainThread]: 
[0m01:30:05.104315 [debug] [Thread-1 (]: Began running node model.crypto_analytics_dbt.stg_crypto_prices
[0m01:30:05.105247 [info ] [Thread-1 (]: 1 of 3 START sql view model PARROT_FEAT_PARROT_FEAT.stg_crypto_prices .......... [RUN]
[0m01:30:05.105905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now model.crypto_analytics_dbt.stg_crypto_prices)
[0m01:30:05.106414 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics_dbt.stg_crypto_prices
[0m01:30:05.113868 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics_dbt.stg_crypto_prices"
[0m01:30:05.116726 [debug] [Thread-1 (]: Began executing node model.crypto_analytics_dbt.stg_crypto_prices
[0m01:30:05.138669 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics_dbt.stg_crypto_prices"
[0m01:30:05.140655 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_analytics_dbt.stg_crypto_prices"
[0m01:30:05.141093 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.stg_crypto_prices"} */
create or replace   view USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
  
   as (
    

select
  upper(symbol)                                      as symbol,
  cast(price_date as date)                           as price_date,
  cast(open as number(38,8))                         as open,
  cast(high as number(38,8))                         as high,
  cast(low as number(38,8))                          as low,
  cast(close as number(38,8))                        as close,
  cast(adj_close as number(38,8))                    as adj_close,
  cast(volume as number(38,8))                       as volume
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES
  );
[0m01:30:05.141483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:05.870357 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.729 seconds
[0m01:30:05.896440 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.stg_crypto_prices: Close
[0m01:30:06.213912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42ccb775-3e3b-4bf6-9ae1-b0d56df8e996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f6120f0>]}
[0m01:30:06.215472 [info ] [Thread-1 (]: 1 of 3 OK created sql view model PARROT_FEAT_PARROT_FEAT.stg_crypto_prices ..... [[32mSUCCESS 1[0m in 1.11s]
[0m01:30:06.216518 [debug] [Thread-1 (]: Finished running node model.crypto_analytics_dbt.stg_crypto_prices
[0m01:30:06.218270 [debug] [Thread-2 (]: Began running node model.crypto_analytics_dbt.int_crypto_features
[0m01:30:06.219024 [info ] [Thread-2 (]: 2 of 3 START sql table model PARROT_FEAT_PARROT_FEAT.int_crypto_features ....... [RUN]
[0m01:30:06.219730 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_SNAP, now model.crypto_analytics_dbt.int_crypto_features)
[0m01:30:06.220242 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics_dbt.int_crypto_features
[0m01:30:06.224661 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics_dbt.int_crypto_features"
[0m01:30:06.226992 [debug] [Thread-2 (]: Began executing node model.crypto_analytics_dbt.int_crypto_features
[0m01:30:06.244705 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics_dbt.int_crypto_features"
[0m01:30:06.246522 [debug] [Thread-2 (]: Using snowflake connection "model.crypto_analytics_dbt.int_crypto_features"
[0m01:30:06.246872 [debug] [Thread-2 (]: On model.crypto_analytics_dbt.int_crypto_features: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.int_crypto_features"} */
create or replace transient table USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
         as
        (

with base as (
  select *
  from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
)
select
  symbol,
  price_date,
  close,
  avg(close) over (partition by symbol order by price_date rows between 4 preceding and current row)  as sma_5,
  avg(close) over (partition by symbol order by price_date rows between 19 preceding and current row) as sma_20,
  avg(close) over (partition by symbol order by price_date rows between 49 preceding and current row) as sma_50,
  (close / nullif(lag(close,5) over (partition by symbol order by price_date),0) - 1) * 100 as momentum_5d_pct
from base
        );
[0m01:30:06.247168 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:30:08.281098 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.033 seconds
[0m01:30:08.285531 [debug] [Thread-2 (]: On model.crypto_analytics_dbt.int_crypto_features: Close
[0m01:30:08.436354 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42ccb775-3e3b-4bf6-9ae1-b0d56df8e996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e6677a0>]}
[0m01:30:08.437193 [info ] [Thread-2 (]: 2 of 3 OK created sql table model PARROT_FEAT_PARROT_FEAT.int_crypto_features .. [[32mSUCCESS 1[0m in 2.22s]
[0m01:30:08.437864 [debug] [Thread-2 (]: Finished running node model.crypto_analytics_dbt.int_crypto_features
[0m01:30:08.438693 [debug] [Thread-1 (]: Began running node model.crypto_analytics_dbt.mart_crypto_summary
[0m01:30:08.439446 [info ] [Thread-1 (]: 3 of 3 START sql table model PARROT_FEAT_PARROT_FEAT.mart_crypto_summary ....... [RUN]
[0m01:30:08.440002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics_dbt.stg_crypto_prices, now model.crypto_analytics_dbt.mart_crypto_summary)
[0m01:30:08.440388 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics_dbt.mart_crypto_summary
[0m01:30:08.443372 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics_dbt.mart_crypto_summary"
[0m01:30:08.444940 [debug] [Thread-1 (]: Began executing node model.crypto_analytics_dbt.mart_crypto_summary
[0m01:30:08.447033 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics_dbt.mart_crypto_summary"
[0m01:30:08.448178 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_analytics_dbt.mart_crypto_summary"
[0m01:30:08.448522 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.mart_crypto_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.mart_crypto_summary"} */
create or replace transient table USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
         as
        (

select
  symbol,
  price_date,
  close,
  sma_5,
  sma_20,
  sma_50,
  momentum_5d_pct,
  case when sma_5 > sma_20 then 1 else 0 end as bull_signal_cross
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
order by price_date, symbol
        );
[0m01:30:08.448881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:11.189652 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.740 seconds
[0m01:30:11.193569 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.mart_crypto_summary: Close
[0m01:30:11.294739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42ccb775-3e3b-4bf6-9ae1-b0d56df8e996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e6370e0>]}
[0m01:30:11.296302 [info ] [Thread-1 (]: 3 of 3 OK created sql table model PARROT_FEAT_PARROT_FEAT.mart_crypto_summary .. [[32mSUCCESS 1[0m in 2.85s]
[0m01:30:11.297240 [debug] [Thread-1 (]: Finished running node model.crypto_analytics_dbt.mart_crypto_summary
[0m01:30:11.299480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:30:11.300075 [debug] [MainThread]: Connection 'model.crypto_analytics_dbt.mart_crypto_summary' was properly closed.
[0m01:30:11.300491 [debug] [MainThread]: Connection 'model.crypto_analytics_dbt.int_crypto_features' was properly closed.
[0m01:30:11.301097 [info ] [MainThread]: 
[0m01:30:11.304868 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 8.21 seconds (8.21s).
[0m01:30:11.306539 [debug] [MainThread]: Command end result
[0m01:30:11.343239 [info ] [MainThread]: 
[0m01:30:11.343824 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:30:11.344120 [info ] [MainThread]: 
[0m01:30:11.344424 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:30:11.345282 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.258273, "process_user_time": 3.533495, "process_kernel_time": 0.243065, "process_mem_max_rss": "213036", "process_out_blocks": "1921", "process_in_blocks": "0"}
[0m01:30:11.345742 [debug] [MainThread]: Command `dbt run` succeeded at 01:30:11.345674 after 9.26 seconds
[0m01:30:11.346077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5006030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4d89b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa54772c0>]}
[0m01:30:11.346411 [debug] [MainThread]: Flushing usage events
[0m01:30:14.167335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d84410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87199460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89b16720>]}


============================== 01:30:14.172898 | 1a0e219c-3488-4a4e-ae52-5a52de386db0 ==============================
[0m01:30:14.172898 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:30:14.173416 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:30:14.779419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a0e219c-3488-4a4e-ae52-5a52de386db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff883641a0>]}
[0m01:30:14.813995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a0e219c-3488-4a4e-ae52-5a52de386db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b2870b0>]}
[0m01:30:14.814735 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:30:14.881978 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:30:14.978385 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:30:14.978854 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:30:15.016413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a0e219c-3488-4a4e-ae52-5a52de386db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff656e3350>]}
[0m01:30:15.112091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a0e219c-3488-4a4e-ae52-5a52de386db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff650ee600>]}
[0m01:30:15.112688 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m01:30:15.113022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a0e219c-3488-4a4e-ae52-5a52de386db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff656e3320>]}
[0m01:30:15.114728 [info ] [MainThread]: 
[0m01:30:15.115301 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:30:15.118958 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_SNAP'
[0m01:30:15.127595 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT'
[0m01:30:15.133007 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m01:30:15.134731 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m01:30:15.135111 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m01:30:15.135467 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m01:30:15.135801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:15.136117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:15.591584 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.456 seconds
[0m01:30:15.593800 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m01:30:15.614031 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.478 seconds
[0m01:30:15.615718 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m01:30:15.727511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a0e219c-3488-4a4e-ae52-5a52de386db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6563b800>]}
[0m01:30:15.728248 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:30:15.728646 [info ] [MainThread]: 
[0m01:30:15.737106 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m01:30:15.737807 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m01:30:15.738159 [info ] [Thread-1 (]: 1 of 6 START test not_null_int_crypto_features_price_date ...................... [RUN]
[0m01:30:15.738616 [info ] [Thread-2 (]: 2 of 6 START test not_null_int_crypto_features_symbol .......................... [RUN]
[0m01:30:15.739098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6)
[0m01:30:15.739532 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_SNAP, now test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2)
[0m01:30:15.739903 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m01:30:15.740264 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m01:30:15.753526 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m01:30:15.756697 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m01:30:15.758944 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m01:30:15.759264 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m01:30:15.773914 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m01:30:15.776709 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m01:30:15.778624 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m01:30:15.779157 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m01:30:15.779492 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
where symbol is null



      
    ) dbt_internal_test
[0m01:30:15.779845 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
where price_date is null



      
    ) dbt_internal_test
[0m01:30:15.780169 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:30:15.780468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:16.414269 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.633 seconds
[0m01:30:16.415945 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.636 seconds
[0m01:30:16.426538 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6: Close
[0m01:30:16.428421 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2: Close
[0m01:30:16.555560 [info ] [Thread-2 (]: 2 of 6 PASS not_null_int_crypto_features_symbol ................................ [[32mPASS[0m in 0.82s]
[0m01:30:16.557146 [info ] [Thread-1 (]: 1 of 6 PASS not_null_int_crypto_features_price_date ............................ [[32mPASS[0m in 0.82s]
[0m01:30:16.558020 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m01:30:16.558811 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m01:30:16.559533 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m01:30:16.560203 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m01:30:16.560796 [info ] [Thread-2 (]: 3 of 6 START test not_null_mart_crypto_summary_price_date ...................... [RUN]
[0m01:30:16.561346 [info ] [Thread-1 (]: 4 of 6 START test not_null_mart_crypto_summary_symbol .......................... [RUN]
[0m01:30:16.561945 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2, now test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b)
[0m01:30:16.562447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6, now test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce)
[0m01:30:16.562913 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m01:30:16.563328 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m01:30:16.569555 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m01:30:16.573487 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m01:30:16.575961 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m01:30:16.576369 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m01:30:16.578354 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m01:30:16.580189 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m01:30:16.581585 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m01:30:16.582126 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m01:30:16.582490 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
where price_date is null



      
    ) dbt_internal_test
[0m01:30:16.582894 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
where symbol is null



      
    ) dbt_internal_test
[0m01:30:16.583299 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:30:16.583736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:17.142856 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.559 seconds
[0m01:30:17.146941 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b: Close
[0m01:30:17.185088 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.601 seconds
[0m01:30:17.188971 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce: Close
[0m01:30:17.246543 [info ] [Thread-2 (]: 3 of 6 PASS not_null_mart_crypto_summary_price_date ............................ [[32mPASS[0m in 0.68s]
[0m01:30:17.247950 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m01:30:17.248720 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m01:30:17.249304 [info ] [Thread-2 (]: 5 of 6 START test not_null_stg_crypto_prices_price_date ........................ [RUN]
[0m01:30:17.250028 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b, now test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314)
[0m01:30:17.250532 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m01:30:17.256985 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m01:30:17.258507 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m01:30:17.260993 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m01:30:17.262291 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m01:30:17.262752 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
where price_date is null



      
    ) dbt_internal_test
[0m01:30:17.263122 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:30:17.362938 [info ] [Thread-1 (]: 4 of 6 PASS not_null_mart_crypto_summary_symbol ................................ [[32mPASS[0m in 0.80s]
[0m01:30:17.364167 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m01:30:17.364780 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m01:30:17.365212 [info ] [Thread-1 (]: 6 of 6 START test not_null_stg_crypto_prices_symbol ............................ [RUN]
[0m01:30:17.365883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce, now test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a)
[0m01:30:17.366550 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m01:30:17.370970 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m01:30:17.378765 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m01:30:17.380978 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m01:30:17.382119 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m01:30:17.382486 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
where symbol is null



      
    ) dbt_internal_test
[0m01:30:17.382783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:17.601491 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.338 seconds
[0m01:30:17.605178 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314: Close
[0m01:30:17.732785 [info ] [Thread-2 (]: 5 of 6 PASS not_null_stg_crypto_prices_price_date .............................. [[32mPASS[0m in 0.48s]
[0m01:30:17.734168 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m01:30:17.953753 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.571 seconds
[0m01:30:17.957703 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a: Close
[0m01:30:18.059571 [info ] [Thread-1 (]: 6 of 6 PASS not_null_stg_crypto_prices_symbol .................................. [[32mPASS[0m in 0.69s]
[0m01:30:18.060954 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m01:30:18.063246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:30:18.063879 [debug] [MainThread]: Connection 'test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314' was properly closed.
[0m01:30:18.064351 [debug] [MainThread]: Connection 'test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a' was properly closed.
[0m01:30:18.064908 [info ] [MainThread]: 
[0m01:30:18.065430 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 2.95 seconds (2.95s).
[0m01:30:18.067029 [debug] [MainThread]: Command end result
[0m01:30:18.102594 [info ] [MainThread]: 
[0m01:30:18.103159 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:30:18.103485 [info ] [MainThread]: 
[0m01:30:18.103805 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m01:30:18.104725 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.9697907, "process_user_time": 3.530786, "process_kernel_time": 0.192933, "process_mem_max_rss": "214528", "process_out_blocks": "1936", "process_in_blocks": "0"}
[0m01:30:18.105188 [debug] [MainThread]: Command `dbt test` succeeded at 01:30:18.105113 after 3.97 seconds
[0m01:30:18.105543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87176bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff875d51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff889c1040>]}
[0m01:30:18.105860 [debug] [MainThread]: Flushing usage events
[0m01:30:20.559018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c49e6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c6c89e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a21dac0>]}


============================== 01:30:20.564909 | f107448b-ade4-4d25-a38b-5d3d817298b5 ==============================
[0m01:30:20.564909 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:30:20.565445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:30:21.166994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f107448b-ade4-4d25-a38b-5d3d817298b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78d475c0>]}
[0m01:30:21.201570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f107448b-ade4-4d25-a38b-5d3d817298b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78f362a0>]}
[0m01:30:21.202295 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:30:21.271365 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:30:21.366858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:30:21.367287 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:30:21.403942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f107448b-ade4-4d25-a38b-5d3d817298b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79e9b1a0>]}
[0m01:30:21.490235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f107448b-ade4-4d25-a38b-5d3d817298b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7838ef60>]}
[0m01:30:21.490784 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m01:30:21.491105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f107448b-ade4-4d25-a38b-5d3d817298b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7839b3e0>]}
[0m01:30:21.492547 [info ] [MainThread]: 
[0m01:30:21.493033 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:30:21.493870 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m01:30:21.505156 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m01:30:21.505544 [debug] [ThreadPool]: On list_USER_DB_PARROT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
show terse schemas in database USER_DB_PARROT
    limit 10000
[0m01:30:21.505845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:21.896261 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.390 seconds
[0m01:30:21.898136 [debug] [ThreadPool]: On list_USER_DB_PARROT: Close
[0m01:30:22.002605 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now list_USER_DB_PARROT_PARROT_SNAP)
[0m01:30:22.010175 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT'
[0m01:30:22.018981 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m01:30:22.016998 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m01:30:22.019693 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m01:30:22.020158 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m01:30:22.020533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:22.020868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:30:22.419158 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.398 seconds
[0m01:30:22.422830 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m01:30:22.458032 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.437 seconds
[0m01:30:22.461332 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m01:30:22.567049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f107448b-ade4-4d25-a38b-5d3d817298b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7838ef60>]}
[0m01:30:22.567967 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:30:22.568479 [info ] [MainThread]: 
[0m01:30:22.578321 [debug] [Thread-1 (]: Began running node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m01:30:22.578952 [info ] [Thread-1 (]: 1 of 1 START snapshot PARROT_SNAP.crypto_prices_snapshot ....................... [RUN]
[0m01:30:22.579435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now snapshot.crypto_analytics_dbt.crypto_prices_snapshot)
[0m01:30:22.579811 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m01:30:22.586792 [debug] [Thread-1 (]: Began executing node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m01:30:22.625050 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:22.625497 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m01:30:22.625838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:23.020159 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.394 seconds
[0m01:30:23.059439 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:23.060004 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
create or replace temporary table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
    SYMBOL,
    PRICE_DATE,
    OPEN,
    HIGH,
    LOW,
    CLOSE,
    ADJ_CLOSE,
    VOLUME,
    INGESTED_AT
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES


    ),

    snapshotted_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    

        from "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            
  
  coalesce(nullif(INGESTED_AT, INGESTED_AT), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol || to_char(price_date) as varchar ), '')
         || '|' || coalesce(cast(INGESTED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            INGESTED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.INGESTED_AT))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.INGESTED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m01:30:24.508604 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.448 seconds
[0m01:30:24.514301 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:24.515045 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m01:30:24.590637 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.075 seconds
[0m01:30:24.599391 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:24.600107 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m01:30:24.707060 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.106 seconds
[0m01:30:24.714187 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:24.715166 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m01:30:24.797883 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.082 seconds
[0m01:30:24.804278 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:24.805138 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m01:30:24.910159 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.104 seconds
[0m01:30:24.920825 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:24.921477 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m01:30:25.038288 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.116 seconds
[0m01:30:25.062625 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:25.063331 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
select * from (
        

    with snapshot_query as (

        



select
    SYMBOL,
    PRICE_DATE,
    OPEN,
    HIGH,
    LOW,
    CLOSE,
    ADJ_CLOSE,
    VOLUME,
    INGESTED_AT
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES


    ),

    snapshotted_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    

        from "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            
  
  coalesce(nullif(INGESTED_AT, INGESTED_AT), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol || to_char(price_date) as varchar ), '')
         || '|' || coalesce(cast(INGESTED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            INGESTED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.INGESTED_AT))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.INGESTED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m01:30:25.688591 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.624 seconds
[0m01:30:25.696367 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:25.697127 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:30:25.784453 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.086 seconds
[0m01:30:25.785983 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:25.790034 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:25.790541 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
BEGIN
[0m01:30:25.911258 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.120 seconds
[0m01:30:25.912423 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:25.913017 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
merge into "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "PRICE_DATE", "OPEN", "HIGH", "LOW", "CLOSE", "ADJ_CLOSE", "VOLUME", "INGESTED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "PRICE_DATE", "OPEN", "HIGH", "LOW", "CLOSE", "ADJ_CLOSE", "VOLUME", "INGESTED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:30:27.050642 [debug] [Thread-1 (]: SQL status: SUCCESS 1458 in 1.137 seconds
[0m01:30:27.052297 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:27.052802 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
COMMIT
[0m01:30:27.369920 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.316 seconds
[0m01:30:27.389498 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: Close
[0m01:30:27.502044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f107448b-ade4-4d25-a38b-5d3d817298b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff784a9f70>]}
[0m01:30:27.503825 [info ] [Thread-1 (]: 1 of 1 OK snapshotted PARROT_SNAP.crypto_prices_snapshot ....................... [[32mSUCCESS 1458[0m in 4.92s]
[0m01:30:27.504856 [debug] [Thread-1 (]: Finished running node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m01:30:27.507037 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:30:27.507596 [debug] [MainThread]: Connection 'list_USER_DB_PARROT_PARROT_SNAP' was properly closed.
[0m01:30:27.508053 [debug] [MainThread]: Connection 'snapshot.crypto_analytics_dbt.crypto_prices_snapshot' was properly closed.
[0m01:30:27.508571 [info ] [MainThread]: 
[0m01:30:27.509024 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.02 seconds (6.02s).
[0m01:30:27.509827 [debug] [MainThread]: Command end result
[0m01:30:27.543940 [info ] [MainThread]: 
[0m01:30:27.544443 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:30:27.544824 [info ] [MainThread]: 
[0m01:30:27.545149 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:30:27.545883 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.019535, "process_user_time": 3.536585, "process_kernel_time": 0.187242, "process_mem_max_rss": "213640", "process_out_blocks": "1920", "process_in_blocks": "0"}
[0m01:30:27.546373 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:30:27.546301 after 7.02 seconds
[0m01:30:27.546735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c49e6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e7ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7838ef60>]}
[0m01:30:27.547081 [debug] [MainThread]: Flushing usage events
[0m01:30:01.538792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaed890a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaef78ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1a09760>]}


============================== 01:30:01.542024 | ca6a4e6e-a5c3-412d-a9f1-f74caedf29bf ==============================
[0m01:30:01.542024 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:30:01.542273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /home/airflow/.dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:30:01.882644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca6a4e6e-a5c3-412d-a9f1-f74caedf29bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d8e6540>]}
[0m01:30:01.899424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca6a4e6e-a5c3-412d-a9f1-f74caedf29bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e77f0b0>]}
[0m01:30:01.899753 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:30:01.933515 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:30:01.985112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:30:01.985339 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:30:02.003718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca6a4e6e-a5c3-412d-a9f1-f74caedf29bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d756450>]}
[0m01:30:02.047731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca6a4e6e-a5c3-412d-a9f1-f74caedf29bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d4f2d20>]}
[0m01:30:02.047993 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m01:30:02.048182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca6a4e6e-a5c3-412d-a9f1-f74caedf29bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d6bd6d0>]}
[0m01:30:02.048941 [info ] [MainThread]: 
[0m01:30:02.049194 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:30:02.050945 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m01:30:02.056358 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m01:30:02.056534 [debug] [ThreadPool]: On list_USER_DB_PARROT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
show terse schemas in database USER_DB_PARROT
    limit 10000
[0m01:30:02.056696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:02.586629 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.530 seconds
[0m01:30:02.589659 [debug] [ThreadPool]: On list_USER_DB_PARROT: Close
[0m01:30:02.688336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT)
[0m01:30:02.696042 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_SNAP'
[0m01:30:02.696614 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m01:30:02.698259 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m01:30:02.698657 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m01:30:02.699004 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m01:30:02.699350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:30:02.699643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:03.105393 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.405 seconds
[0m01:30:03.108185 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m01:30:03.239048 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.540 seconds
[0m01:30:03.241635 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m01:30:03.344681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca6a4e6e-a5c3-412d-a9f1-f74caedf29bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d25f950>]}
[0m01:30:03.345849 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:30:03.346389 [info ] [MainThread]: 
[0m01:30:03.357715 [debug] [Thread-1 (]: Began running node model.crypto_analytics_dbt.stg_crypto_prices
[0m01:30:03.358538 [info ] [Thread-1 (]: 1 of 3 START sql view model PARROT_FEAT_PARROT_FEAT.stg_crypto_prices .......... [RUN]
[0m01:30:03.359070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_SNAP, now model.crypto_analytics_dbt.stg_crypto_prices)
[0m01:30:03.359456 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics_dbt.stg_crypto_prices
[0m01:30:03.366849 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics_dbt.stg_crypto_prices"
[0m01:30:03.369728 [debug] [Thread-1 (]: Began executing node model.crypto_analytics_dbt.stg_crypto_prices
[0m01:30:03.386842 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics_dbt.stg_crypto_prices"
[0m01:30:03.388372 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_analytics_dbt.stg_crypto_prices"
[0m01:30:03.388631 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.stg_crypto_prices"} */
create or replace   view USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
  
   as (
    

select
  upper(symbol)                                      as symbol,
  cast(price_date as date)                           as price_date,
  cast(open as number(38,8))                         as open,
  cast(high as number(38,8))                         as high,
  cast(low as number(38,8))                          as low,
  cast(close as number(38,8))                        as close,
  cast(adj_close as number(38,8))                    as adj_close,
  cast(volume as number(38,8))                       as volume
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES
  );
[0m01:30:03.388928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:03.863407 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.474 seconds
[0m01:30:03.886541 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.stg_crypto_prices: Close
[0m01:30:04.100733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca6a4e6e-a5c3-412d-a9f1-f74caedf29bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d86dd30>]}
[0m01:30:04.101139 [info ] [Thread-1 (]: 1 of 3 OK created sql view model PARROT_FEAT_PARROT_FEAT.stg_crypto_prices ..... [[32mSUCCESS 1[0m in 0.74s]
[0m01:30:04.101452 [debug] [Thread-1 (]: Finished running node model.crypto_analytics_dbt.stg_crypto_prices
[0m01:30:04.101897 [debug] [Thread-2 (]: Began running node model.crypto_analytics_dbt.int_crypto_features
[0m01:30:04.102151 [info ] [Thread-2 (]: 2 of 3 START sql table model PARROT_FEAT_PARROT_FEAT.int_crypto_features ....... [RUN]
[0m01:30:04.102395 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now model.crypto_analytics_dbt.int_crypto_features)
[0m01:30:04.102580 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics_dbt.int_crypto_features
[0m01:30:04.103874 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics_dbt.int_crypto_features"
[0m01:30:04.104780 [debug] [Thread-2 (]: Began executing node model.crypto_analytics_dbt.int_crypto_features
[0m01:30:04.112248 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics_dbt.int_crypto_features"
[0m01:30:04.112944 [debug] [Thread-2 (]: Using snowflake connection "model.crypto_analytics_dbt.int_crypto_features"
[0m01:30:04.113127 [debug] [Thread-2 (]: On model.crypto_analytics_dbt.int_crypto_features: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.int_crypto_features"} */
create or replace transient table USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
         as
        (

with base as (
  select *
  from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
)
select
  symbol,
  price_date,
  close,
  avg(close) over (partition by symbol order by price_date rows between 4 preceding and current row)  as sma_5,
  avg(close) over (partition by symbol order by price_date rows between 19 preceding and current row) as sma_20,
  avg(close) over (partition by symbol order by price_date rows between 49 preceding and current row) as sma_50,
  (close / nullif(lag(close,5) over (partition by symbol order by price_date),0) - 1) * 100 as momentum_5d_pct
from base
        );
[0m01:30:04.113311 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:30:06.043804 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.930 seconds
[0m01:30:06.047514 [debug] [Thread-2 (]: On model.crypto_analytics_dbt.int_crypto_features: Close
[0m01:30:06.148941 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca6a4e6e-a5c3-412d-a9f1-f74caedf29bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c896c60>]}
[0m01:30:06.150408 [info ] [Thread-2 (]: 2 of 3 OK created sql table model PARROT_FEAT_PARROT_FEAT.int_crypto_features .. [[32mSUCCESS 1[0m in 2.05s]
[0m01:30:06.151247 [debug] [Thread-2 (]: Finished running node model.crypto_analytics_dbt.int_crypto_features
[0m01:30:06.152521 [debug] [Thread-1 (]: Began running node model.crypto_analytics_dbt.mart_crypto_summary
[0m01:30:06.153250 [info ] [Thread-1 (]: 3 of 3 START sql table model PARROT_FEAT_PARROT_FEAT.mart_crypto_summary ....... [RUN]
[0m01:30:06.153866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics_dbt.stg_crypto_prices, now model.crypto_analytics_dbt.mart_crypto_summary)
[0m01:30:06.154326 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics_dbt.mart_crypto_summary
[0m01:30:06.158665 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics_dbt.mart_crypto_summary"
[0m01:30:06.161283 [debug] [Thread-1 (]: Began executing node model.crypto_analytics_dbt.mart_crypto_summary
[0m01:30:06.164363 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics_dbt.mart_crypto_summary"
[0m01:30:06.166257 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_analytics_dbt.mart_crypto_summary"
[0m01:30:06.166757 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.mart_crypto_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "model.crypto_analytics_dbt.mart_crypto_summary"} */
create or replace transient table USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
         as
        (

select
  symbol,
  price_date,
  close,
  sma_5,
  sma_20,
  sma_50,
  momentum_5d_pct,
  case when sma_5 > sma_20 then 1 else 0 end as bull_signal_cross
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
order by price_date, symbol
        );
[0m01:30:06.167233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:07.417193 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.250 seconds
[0m01:30:07.420651 [debug] [Thread-1 (]: On model.crypto_analytics_dbt.mart_crypto_summary: Close
[0m01:30:07.517101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca6a4e6e-a5c3-412d-a9f1-f74caedf29bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c8e1c10>]}
[0m01:30:07.518517 [info ] [Thread-1 (]: 3 of 3 OK created sql table model PARROT_FEAT_PARROT_FEAT.mart_crypto_summary .. [[32mSUCCESS 1[0m in 1.36s]
[0m01:30:07.519370 [debug] [Thread-1 (]: Finished running node model.crypto_analytics_dbt.mart_crypto_summary
[0m01:30:07.521503 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:30:07.522095 [debug] [MainThread]: Connection 'model.crypto_analytics_dbt.int_crypto_features' was properly closed.
[0m01:30:07.522630 [debug] [MainThread]: Connection 'model.crypto_analytics_dbt.mart_crypto_summary' was properly closed.
[0m01:30:07.523354 [info ] [MainThread]: 
[0m01:30:07.523939 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 5.47 seconds (5.47s).
[0m01:30:07.525139 [debug] [MainThread]: Command end result
[0m01:30:07.558653 [info ] [MainThread]: 
[0m01:30:07.559143 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:30:07.559410 [info ] [MainThread]: 
[0m01:30:07.559641 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:30:07.560517 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.038714, "process_user_time": 2.244347, "process_kernel_time": 0.145288, "process_mem_max_rss": "213020", "process_out_blocks": "1921", "process_in_blocks": "0"}
[0m01:30:07.560934 [debug] [MainThread]: Command `dbt run` succeeded at 01:30:07.560866 after 6.04 seconds
[0m01:30:07.561262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaefe4b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaed890a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8da9b290>]}
[0m01:30:07.561588 [debug] [MainThread]: Flushing usage events
[0m01:30:09.308881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb681370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9a18ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9d137a0>]}


============================== 01:30:09.311603 | 4a857a2a-3aec-4760-a853-b82307f960f1 ==============================
[0m01:30:09.311603 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:30:09.311869 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:30:09.639534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a857a2a-3aec-4760-a853-b82307f960f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99cb77a0>]}
[0m01:30:09.655629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a857a2a-3aec-4760-a853-b82307f960f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b6aec60>]}
[0m01:30:09.655944 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:30:09.688155 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:30:09.738826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:30:09.739066 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:30:09.757811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a857a2a-3aec-4760-a853-b82307f960f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb94e4740>]}
[0m01:30:09.806048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a857a2a-3aec-4760-a853-b82307f960f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93cd9f40>]}
[0m01:30:09.806314 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m01:30:09.806475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a857a2a-3aec-4760-a853-b82307f960f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff981b3320>]}
[0m01:30:09.807308 [info ] [MainThread]: 
[0m01:30:09.807573 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:30:09.809351 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT'
[0m01:30:09.815948 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m01:30:09.816197 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_SNAP'
[0m01:30:09.816397 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m01:30:09.817304 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m01:30:09.817502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:09.817737 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m01:30:09.818881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:10.280656 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.463 seconds
[0m01:30:10.283603 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m01:30:10.293598 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.475 seconds
[0m01:30:10.295469 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m01:30:10.403072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a857a2a-3aec-4760-a853-b82307f960f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff983a7a40>]}
[0m01:30:10.404208 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:30:10.404803 [info ] [MainThread]: 
[0m01:30:10.415644 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m01:30:10.416780 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m01:30:10.417335 [info ] [Thread-1 (]: 1 of 6 START test not_null_int_crypto_features_price_date ...................... [RUN]
[0m01:30:10.418040 [info ] [Thread-2 (]: 2 of 6 START test not_null_int_crypto_features_symbol .......................... [RUN]
[0m01:30:10.418666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT, now test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6)
[0m01:30:10.419178 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_SNAP, now test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2)
[0m01:30:10.419614 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m01:30:10.420083 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m01:30:10.433744 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m01:30:10.436380 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m01:30:10.437645 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m01:30:10.437902 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m01:30:10.448597 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m01:30:10.450415 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m01:30:10.451651 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"
[0m01:30:10.452025 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"
[0m01:30:10.452240 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
where symbol is null



      
    ) dbt_internal_test
[0m01:30:10.452497 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.int_crypto_features
where price_date is null



      
    ) dbt_internal_test
[0m01:30:10.452808 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:30:10.453072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:11.004666 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.551 seconds
[0m01:30:11.005845 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.553 seconds
[0m01:30:11.015603 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6: Close
[0m01:30:11.017703 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2: Close
[0m01:30:11.135413 [info ] [Thread-2 (]: 2 of 6 PASS not_null_int_crypto_features_symbol ................................ [[32mPASS[0m in 0.72s]
[0m01:30:11.136748 [info ] [Thread-1 (]: 1 of 6 PASS not_null_int_crypto_features_price_date ............................ [[32mPASS[0m in 0.72s]
[0m01:30:11.137480 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2
[0m01:30:11.138146 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6
[0m01:30:11.138770 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m01:30:11.139328 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m01:30:11.139829 [info ] [Thread-2 (]: 3 of 6 START test not_null_mart_crypto_summary_price_date ...................... [RUN]
[0m01:30:11.140302 [info ] [Thread-1 (]: 4 of 6 START test not_null_mart_crypto_summary_symbol .......................... [RUN]
[0m01:30:11.140836 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_int_crypto_features_symbol.5c429a03b2, now test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b)
[0m01:30:11.141295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_int_crypto_features_price_date.2906c6e0f6, now test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce)
[0m01:30:11.141755 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m01:30:11.142202 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m01:30:11.147859 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m01:30:11.152367 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m01:30:11.154241 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m01:30:11.154653 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m01:30:11.157005 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m01:30:11.159025 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m01:30:11.160609 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"
[0m01:30:11.161014 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
where price_date is null



      
    ) dbt_internal_test
[0m01:30:11.161551 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"
[0m01:30:11.161833 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:30:11.162214 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.mart_crypto_summary
where symbol is null



      
    ) dbt_internal_test
[0m01:30:11.163942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:11.616291 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.454 seconds
[0m01:30:11.619555 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b: Close
[0m01:30:11.623549 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.460 seconds
[0m01:30:11.625877 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce: Close
[0m01:30:11.711653 [info ] [Thread-2 (]: 3 of 6 PASS not_null_mart_crypto_summary_price_date ............................ [[32mPASS[0m in 0.57s]
[0m01:30:11.712848 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b
[0m01:30:11.713512 [debug] [Thread-2 (]: Began running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m01:30:11.714048 [info ] [Thread-2 (]: 5 of 6 START test not_null_stg_crypto_prices_price_date ........................ [RUN]
[0m01:30:11.714647 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_mart_crypto_summary_price_date.fa41487e8b, now test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314)
[0m01:30:11.715096 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m01:30:11.720925 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m01:30:11.723608 [debug] [Thread-2 (]: Began executing node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m01:30:11.726180 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m01:30:11.728046 [debug] [Thread-2 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"
[0m01:30:11.728607 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_date
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
where price_date is null



      
    ) dbt_internal_test
[0m01:30:11.729141 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:30:11.747181 [info ] [Thread-1 (]: 4 of 6 PASS not_null_mart_crypto_summary_symbol ................................ [[32mPASS[0m in 0.61s]
[0m01:30:11.747957 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce
[0m01:30:11.748516 [debug] [Thread-1 (]: Began running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m01:30:11.748920 [info ] [Thread-1 (]: 6 of 6 START test not_null_stg_crypto_prices_symbol ............................ [RUN]
[0m01:30:11.749348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics_dbt.not_null_mart_crypto_summary_symbol.64810037ce, now test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a)
[0m01:30:11.749701 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m01:30:11.753465 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m01:30:11.754491 [debug] [Thread-1 (]: Began executing node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m01:30:11.756280 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m01:30:11.757302 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"
[0m01:30:11.757692 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT.stg_crypto_prices
where symbol is null



      
    ) dbt_internal_test
[0m01:30:11.758219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:12.979608 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.221 seconds
[0m01:30:12.982978 [debug] [Thread-1 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a: Close
[0m01:30:12.998755 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.270 seconds
[0m01:30:13.001079 [debug] [Thread-2 (]: On test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314: Close
[0m01:30:13.099301 [info ] [Thread-1 (]: 6 of 6 PASS not_null_stg_crypto_prices_symbol .................................. [[32mPASS[0m in 1.35s]
[0m01:30:13.100682 [info ] [Thread-2 (]: 5 of 6 PASS not_null_stg_crypto_prices_price_date .............................. [[32mPASS[0m in 1.39s]
[0m01:30:13.101379 [debug] [Thread-1 (]: Finished running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a
[0m01:30:13.102021 [debug] [Thread-2 (]: Finished running node test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314
[0m01:30:13.104052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:30:13.104575 [debug] [MainThread]: Connection 'test.crypto_analytics_dbt.not_null_stg_crypto_prices_symbol.911b36645a' was properly closed.
[0m01:30:13.104931 [debug] [MainThread]: Connection 'test.crypto_analytics_dbt.not_null_stg_crypto_prices_price_date.e98d0e0314' was properly closed.
[0m01:30:13.105368 [info ] [MainThread]: 
[0m01:30:13.105776 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 3.30 seconds (3.30s).
[0m01:30:13.107053 [debug] [MainThread]: Command end result
[0m01:30:13.139728 [info ] [MainThread]: 
[0m01:30:13.140232 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:30:13.140465 [info ] [MainThread]: 
[0m01:30:13.140721 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m01:30:13.141434 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.8490174, "process_user_time": 2.300894, "process_kernel_time": 0.102306, "process_mem_max_rss": "214504", "process_out_blocks": "1936", "process_in_blocks": "0"}
[0m01:30:13.141737 [debug] [MainThread]: Command `dbt test` succeeded at 01:30:13.141687 after 3.85 seconds
[0m01:30:13.141992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb681370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb94b6f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb94b6a20>]}
[0m01:30:13.142233 [debug] [MainThread]: Flushing usage events
[0m01:30:14.961382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb672af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5ee6660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5eae840>]}


============================== 01:30:14.964145 | 19de5362-1618-4bd9-af2d-280e06546794 ==============================
[0m01:30:14.964145 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:30:14.964415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/crypto_analytics_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:30:15.293041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19de5362-1618-4bd9-af2d-280e06546794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94990d70>]}
[0m01:30:15.310190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19de5362-1618-4bd9-af2d-280e06546794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94a162a0>]}
[0m01:30:15.310532 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:30:15.343921 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:30:15.393884 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:30:15.394097 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:30:15.412452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19de5362-1618-4bd9-af2d-280e06546794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9488a540>]}
[0m01:30:15.455679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19de5362-1618-4bd9-af2d-280e06546794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9466bfe0>]}
[0m01:30:15.455926 [info ] [MainThread]: Found 3 models, 1 snapshot, 6 data tests, 1 source, 459 macros
[0m01:30:15.456085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19de5362-1618-4bd9-af2d-280e06546794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7b23260>]}
[0m01:30:15.456857 [info ] [MainThread]: 
[0m01:30:15.457127 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:30:15.457574 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT'
[0m01:30:15.463021 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT"
[0m01:30:15.463190 [debug] [ThreadPool]: On list_USER_DB_PARROT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT"} */
show terse schemas in database USER_DB_PARROT
    limit 10000
[0m01:30:15.463324 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:15.851067 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.388 seconds
[0m01:30:15.852448 [debug] [ThreadPool]: On list_USER_DB_PARROT: Close
[0m01:30:15.957389 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT, now list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT)
[0m01:30:15.958297 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_PARROT_PARROT_SNAP'
[0m01:30:15.973789 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_SNAP"
[0m01:30:15.976697 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"
[0m01:30:15.977033 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_SNAP"} */
show objects in USER_DB_PARROT.PARROT_SNAP limit 10000
[0m01:30:15.977436 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "connection_name": "list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT"} */
show objects in USER_DB_PARROT.PARROT_FEAT_PARROT_FEAT limit 10000
[0m01:30:15.977767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:15.978068 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:30:16.325387 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.347 seconds
[0m01:30:16.328300 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_SNAP: Close
[0m01:30:16.346591 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.368 seconds
[0m01:30:16.349018 [debug] [ThreadPool]: On list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT: Close
[0m01:30:16.478762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19de5362-1618-4bd9-af2d-280e06546794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7569580>]}
[0m01:30:16.479927 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m01:30:16.480548 [info ] [MainThread]: 
[0m01:30:16.491434 [debug] [Thread-1 (]: Began running node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m01:30:16.492245 [info ] [Thread-1 (]: 1 of 1 START snapshot PARROT_SNAP.crypto_prices_snapshot ....................... [RUN]
[0m01:30:16.492850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_PARROT_PARROT_SNAP, now snapshot.crypto_analytics_dbt.crypto_prices_snapshot)
[0m01:30:16.493310 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m01:30:16.501627 [debug] [Thread-1 (]: Began executing node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m01:30:16.531709 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:16.531957 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m01:30:16.532178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:16.867259 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.335 seconds
[0m01:30:16.895272 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:16.895617 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
create or replace temporary table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
    SYMBOL,
    PRICE_DATE,
    OPEN,
    HIGH,
    LOW,
    CLOSE,
    ADJ_CLOSE,
    VOLUME,
    INGESTED_AT
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES


    ),

    snapshotted_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    

        from "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            
  
  coalesce(nullif(INGESTED_AT, INGESTED_AT), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol || to_char(price_date) as varchar ), '')
         || '|' || coalesce(cast(INGESTED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            INGESTED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.INGESTED_AT))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.INGESTED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m01:30:18.270957 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.375 seconds
[0m01:30:18.275296 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:18.275927 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m01:30:18.412884 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.136 seconds
[0m01:30:18.420242 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:18.420916 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m01:30:18.513736 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.092 seconds
[0m01:30:18.519235 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:18.519863 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m01:30:18.600543 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.080 seconds
[0m01:30:18.605981 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:18.606625 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
[0m01:30:18.722155 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.115 seconds
[0m01:30:18.731299 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:18.731903 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
describe table "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp"
[0m01:30:18.822146 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.090 seconds
[0m01:30:18.845537 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:18.846153 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
select * from (
        

    with snapshot_query as (

        



select
    SYMBOL,
    PRICE_DATE,
    OPEN,
    HIGH,
    LOW,
    CLOSE,
    ADJ_CLOSE,
    VOLUME,
    INGESTED_AT
from USER_DB_PARROT.PARROT_RAW.CRYPTO_PRICES


    ),

    snapshotted_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    

        from "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            
  
  coalesce(nullif(INGESTED_AT, INGESTED_AT), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol || to_char(price_date) as varchar ), '')
         || '|' || coalesce(cast(INGESTED_AT as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol || to_char(price_date) as dbt_unique_key
    
,
            INGESTED_AT as dbt_updated_at,
            INGESTED_AT as dbt_valid_from,
            INGESTED_AT as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.INGESTED_AT))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.INGESTED_AT)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m01:30:19.397431 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.550 seconds
[0m01:30:19.403746 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:19.404370 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:30:19.516437 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.111 seconds
[0m01:30:19.517707 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:19.521077 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:19.521551 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
BEGIN
[0m01:30:19.619370 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.097 seconds
[0m01:30:19.620304 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:19.620883 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
merge into "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_PARROT"."PARROT_SNAP"."CRYPTO_PRICES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "PRICE_DATE", "OPEN", "HIGH", "LOW", "CLOSE", "ADJ_CLOSE", "VOLUME", "INGESTED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "PRICE_DATE", "OPEN", "HIGH", "LOW", "CLOSE", "ADJ_CLOSE", "VOLUME", "INGESTED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:30:20.423528 [debug] [Thread-1 (]: SQL status: SUCCESS 1458 in 0.802 seconds
[0m01:30:20.424512 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"
[0m01:30:20.425090 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_analytics_dbt", "target_name": "dev", "node_id": "snapshot.crypto_analytics_dbt.crypto_prices_snapshot"} */
COMMIT
[0m01:30:20.758583 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.333 seconds
[0m01:30:20.780716 [debug] [Thread-1 (]: On snapshot.crypto_analytics_dbt.crypto_prices_snapshot: Close
[0m01:30:20.882960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19de5362-1618-4bd9-af2d-280e06546794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6728920>]}
[0m01:30:20.884038 [info ] [Thread-1 (]: 1 of 1 OK snapshotted PARROT_SNAP.crypto_prices_snapshot ....................... [[32mSUCCESS 1458[0m in 4.39s]
[0m01:30:20.884669 [debug] [Thread-1 (]: Finished running node snapshot.crypto_analytics_dbt.crypto_prices_snapshot
[0m01:30:20.886141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:30:20.886516 [debug] [MainThread]: Connection 'list_USER_DB_PARROT_PARROT_FEAT_PARROT_FEAT' was properly closed.
[0m01:30:20.886839 [debug] [MainThread]: Connection 'snapshot.crypto_analytics_dbt.crypto_prices_snapshot' was properly closed.
[0m01:30:20.887195 [info ] [MainThread]: 
[0m01:30:20.887524 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.43 seconds (5.43s).
[0m01:30:20.888085 [debug] [MainThread]: Command end result
[0m01:30:20.909356 [info ] [MainThread]: 
[0m01:30:20.909676 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:30:20.909946 [info ] [MainThread]: 
[0m01:30:20.910156 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:30:20.910659 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 5.9661508, "process_user_time": 2.418398, "process_kernel_time": 0.093484, "process_mem_max_rss": "213536", "process_out_blocks": "1920", "process_in_blocks": "0"}
[0m01:30:20.910945 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:30:20.910898 after 5.97 seconds
[0m01:30:20.911148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5ee6660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9440aba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94627bc0>]}
[0m01:30:20.911358 [debug] [MainThread]: Flushing usage events
